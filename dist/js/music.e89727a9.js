(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["music"],{"02d5":function(t,e,n){e.parseMidi=n("5e59"),e.writeMidi=n("5d84")},"04d1d":function(t,e,n){(function(t,o){o(e,n("278c"),n("970b"),n("5bc3"))})(0,(function(t,e,n,o){"use strict";e=e&&e.hasOwnProperty("default")?e["default"]:e,n=n&&n.hasOwnProperty("default")?n["default"]:n,o=o&&o.hasOwnProperty("default")?o["default"]:o;var r=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},i=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},s=function(t,e){return{startTime:e,type:"setValue",value:t}},a=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},c=function(t,e,n){var o=n.startTime,r=n.target,i=n.timeConstant;return r+(e-r)*Math.exp((o-t)/i)},u=function(t){return"exponentialRampToValue"===t.type},l=function(t){return"linearRampToValue"===t.type},h=function(t){return u(t)||l(t)},p=function(t){return"setValue"===t.type},f=function(t){return"setValueCurve"===t.type},d=function t(e,n,o,r){var i=e[n];return void 0===i?r:h(i)||p(i)?i.value:f(i)?i.values[i.values.length-1]:c(o,t(e,n-1,i.startTime,r),i)},y=function(t,e,n,o,r){return void 0===n?[o.insertTime,r]:h(n)?[n.endTime,n.value]:p(n)?[n.startTime,n.value]:f(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,d(t,e-1,n.startTime,r)]},m=function(t){return"cancelAndHold"===t.type},v=function(t){return"cancelScheduledValues"===t.type},_=function(t){return m(t)||v(t)?t.cancelTime:u(t)||l(t)?t.endTime:t.startTime},g=function(t,e,n,o){var r=o.endTime,i=o.value;return n===i?i:0<n&&0<i||n<0&&i<0?n*Math.pow(i/n,(t-e)/(r-e)):0},b=function(t,e,n,o){var r=o.endTime,i=o.value;return n+(t-e)/(r-e)*(i-n)},w=function(t,e){var n=Math.floor(e),o=Math.ceil(e);return n===o?t[n]:(1-(e-n))*t[n]+(1-(o-e))*t[o]},x=function(t,e){var n=e.duration,o=e.startTime,r=e.values,i=(t-o)/n*(r.length-1);return w(r,i)},O=function(t){return"setTarget"===t.type},k=function(){function t(e){n(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return o(t,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=_(t);if(m(t)||v(t)){var n=this._automationEvents.findIndex((function(t){return _(t)>=e})),o=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),m(t)){var c=this._automationEvents[this._automationEvents.length-1];if(void 0!==o&&h(o)){if(O(c))throw new Error("The internal list is malformed.");var p=f(c)?c.startTime+c.duration:_(c),d=f(c)?c.values[c.values.length-1]:c.value,y=u(o)?g(e,p,d,o):b(e,p,d,o),w=u(o)?r(y,e,this._currenTime):i(y,e,this._currenTime);this._automationEvents.push(w)}void 0!==c&&O(c)&&this._automationEvents.push(s(this.getValue(e),e)),void 0!==c&&f(c)&&c.startTime+c.duration>e&&(this._automationEvents[this._automationEvents.length-1]=a(new Float32Array([6,7]),c.startTime,e-c.startTime))}}else{var x=this._automationEvents.findIndex((function(t){return _(t)>e})),k=-1===x?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[x-1];if(void 0!==k&&f(k)&&_(k)+k.duration>e)return!1;var C=u(t)?r(t.value,t.endTime,this._currenTime):l(t)?i(t.value,e,this._currenTime):t;if(-1===x)this._automationEvents.push(C);else{if(f(t)&&e+t.duration>_(this._automationEvents[x]))return!1;this._automationEvents.splice(x,0,C)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return _(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),o=n[0];O(o)&&n.unshift(s(d(this._automationEvents,e-2,o.startTime,this._defaultValue),o.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var n=this._automationEvents[this._automationEvents.length-1],o=this._automationEvents.findIndex((function(e){return _(e)>t})),r=this._automationEvents[o],i=_(n)<=t?n:this._automationEvents[o-1];if(void 0!==i&&O(i)&&(void 0===r||!h(r)||r.insertTime>t))return c(t,d(this._automationEvents,o-2,i.startTime,this._defaultValue),i);if(void 0!==i&&p(i)&&(void 0===r||!h(r)))return i.value;if(void 0!==i&&f(i)&&(void 0===r||!h(r)||i.startTime+i.duration>t))return t<i.startTime+i.duration?x(t,i):i.values[i.values.length-1];if(void 0!==i&&h(i)&&(void 0===r||!h(r)))return i.value;if(void 0!==r&&u(r)){var s=y(this._automationEvents,o-1,i,r,this._defaultValue),a=e(s,2),m=a[0],v=a[1];return g(t,m,v,r)}if(void 0!==r&&l(r)){var w=y(this._automationEvents,o-1,i,r,this._defaultValue),k=e(w,2),C=k[0],T=k[1];return b(t,C,T,r)}return this._defaultValue}}]),t}(),C=function(t){return{cancelTime:t,type:"cancelAndHold"}},T=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},S=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},A=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},M=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}};t.AutomationEventList=k,t.createCancelAndHoldAutomationEvent=C,t.createCancelScheduledValuesAutomationEvent=T,t.createExponentialRampToValueAutomationEvent=S,t.createLinearRampToValueAutomationEvent=A,t.createSetTargetAutomationEvent=M,t.createSetValueAutomationEvent=s,t.createSetValueCurveAutomationEvent=a,Object.defineProperty(t,"__esModule",{value:!0})}))},"05e2":function(t,e,n){"use strict";var o=n("9ac7");function r(t,e,n,o){var r=t.length,i=n+(o?1:-1);while(o?i--:++i<r)if(e(t[i],i,t))return i;return-1}var i=r;function s(t){return t!==t}var a=s;function c(t,e,n){var o=n-1,r=t.length;while(++o<r)if(t[o]===e)return o;return-1}var u=c;function l(t,e,n){return e===e?u(t,e,n):i(t,a,n)}var h=l;function p(t,e){var n=null==t?0:t.length;return!!n&&h(t,e,0)>-1}var f=p;function d(t,e,n){var o=-1,r=null==t?0:t.length;while(++o<r)if(n(e,t[o]))return!0;return!1}var y=d,m=n("6568"),v=n("a55c");function _(){}var g=_,b=n("1989"),w=1/0,x=v["a"]&&1/Object(b["a"])(new v["a"]([,-0]))[1]==w?function(t){return new v["a"](t)}:g,O=x,k=200;function C(t,e,n){var r=-1,i=f,s=t.length,a=!0,c=[],u=c;if(n)a=!1,i=y;else if(s>=k){var l=e?null:O(t);if(l)return Object(b["a"])(l);a=!1,i=m["a"],u=new o["a"]}else u=e?[]:c;t:while(++r<s){var h=t[r],p=e?e(h):h;if(h=n||0!==h?h:0,a&&p===p){var d=u.length;while(d--)if(u[d]===p)continue t;e&&u.push(p),c.push(h)}else i(u,p,n)||(u!==c&&u.push(p),c.push(h))}return c}var T=C;function S(t){return t&&t.length?T(t):[]}e["a"]=S},"06e9":function(t,e,n){"use strict";function o(t){if(!Array.isArray(t))throw new TypeError("Expected value to be an array");return r(t)}function r(t){return a(t,[])}function i(t,e){if(!Array.isArray(t))throw new TypeError("Expected value to be an array");return s(t,e)}function s(t,e){if("number"!==typeof e)throw new TypeError("Expected the depth to be a number");return c(t,[],e)}function a(t,e){for(var n=0;n<t.length;n++){var o=t[n];Array.isArray(o)?a(o,e):e.push(o)}return e}function c(t,e,n){n--;for(var o=0;o<t.length;o++){var r=t[o];n>-1&&Array.isArray(r)?c(r,e,n):e.push(r)}return e}t.exports=o,t.exports.from=r,t.exports.depth=i,t.exports.fromDepth=s},"072e":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=new WeakMap,r=function(){function t(t,e){o.set(this,e),this.ticks=t.absoluteTime,this.value=t.value}return Object.defineProperty(t.prototype,"time",{get:function(){var t=o.get(this);return t.ticksToSeconds(this.ticks)},set:function(t){var e=o.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},t}();e.PitchBend=r},"081e":function(t,e,n){var o,r,i;(function(n,s){r=[e],o=s,i="function"===typeof o?o.apply(e,r):o,void 0===i||(t.exports=i)})(0,(function(t){"use strict";t.__esModule=!0;var e={},n=Object.prototype.hasOwnProperty,o={memoize:function(t){var o=arguments.length<=1||void 0===arguments[1]?e:arguments[1],r=o.cache||{};return function(){for(var e=arguments.length,i=Array(e),s=0;s<e;s++)i[s]=arguments[s];var a=String(i[0]);return!1===o.caseSensitive&&(a=a.toLowerCase()),n.call(r,a)?r[a]:r[a]=t.apply(this,i)}},debounce:function(t,e){if("function"===typeof e){var n=t;t=e,e=n}var o=e&&e.delay||e||0,r=void 0,i=void 0,s=void 0;return function(){for(var e=arguments.length,n=Array(e),a=0;a<e;a++)n[a]=arguments[a];r=n,i=this,s||(s=setTimeout((function(){t.apply(i,r),r=i=s=null}),o))}},bind:function(t,e,n){var o=n.value;return{configurable:!0,get:function(){var t=o.bind(this);return Object.defineProperty(this,e,{value:t,configurable:!0,writable:!0}),t}}}},r=a(o.memoize),i=a(o.debounce),s=a((function(t,e){return t.bind(e)}),(function(){return o.bind}));function a(t,e){e=e||t.decorate||c(t);var n=e();return function(){for(var o=arguments.length,r=Array(o),i=0;i<o;i++)r[i]=arguments[i];var s=r.length;return(s<2?e:s>2?n:t).apply(void 0,r)}}function c(t){return function(e){return"function"===typeof e?t(e):function(n,o,r){r.value=t(r.value,e,n,o,r)}}}t.memoize=r,t.debounce=i,t.bind=s,t["default"]={memoize:r,debounce:i,bind:s}}))},"278c":function(t,e,n){var o=n("c135"),r=n("9b42"),i=n("6613"),s=n("c240");function a(t,e){return o(t)||r(t,e)||i(t,e)||s()}t.exports=a,t.exports["default"]=t.exports,t.exports.__esModule=!0},"27d3":function(t,e,n){"use strict";function o(t,e,n){void 0===n&&(n="ticks");var o=0,r=t.length,i=r;if(r>0&&t[r-1][n]<=e)return r-1;while(o<i){var s=Math.floor(o+(i-o)/2),a=t[s],c=t[s+1];if(a[n]===e){for(var u=s;u<t.length;u++){var l=t[u];l[n]===e&&(s=u)}return s}if(a[n]<e&&c[n]>e)return s;a[n]>e?i=s:a[n]<e&&(o=s+1)}return-1}function r(t,e,n){if(void 0===n&&(n="ticks"),t.length){var r=o(t,e[n],n);t.splice(r+1,0,e)}else t.push(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.search=o,e.insert=r},3721:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"music-edit",attrs:{tabindex:"0"},on:{keydown:t.keyDown,keyup:t.keyUp,mousemove:t.selectMove,mouseup:t.selectEnd}},[n("div",{staticClass:"edit-header setting"},[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.showHelp=!0}}},[t._v(t._s(t.$t("shawzin.help")))]),n("el-select",{staticStyle:{width:"90px"},attrs:{size:"small"},model:{value:t.music.mode,callback:function(e){t.$set(t.music,"mode",e)},expression:"music.mode"}},t._l(t.modes,(function(e){return n("el-option",{key:e.name,attrs:{label:t.$t("shawzin."+e.name),value:e.val,disabled:!t.modeMaps[e.val]}})})),1),n("el-select",{staticStyle:{width:"120px"},attrs:{size:"small"},model:{value:t.instrument,callback:function(e){t.instrument=e},expression:"instrument"}},[n("el-option",{attrs:{label:t.$t("shawzin.piano"),value:"piano"}}),n("el-option",{attrs:{label:t.$t("shawzin.shawzin"),value:"shawzin"}}),n("el-option",{attrs:{label:t.$t("shawzin.lotus"),value:"lotus"}})],1),t.isLoaded?t._e():n("i",{staticClass:"el-icon-loading"}),n("el-popover",{attrs:{placement:"top"},model:{value:t.settingVisible,callback:function(e){t.settingVisible=e},expression:"settingVisible"}},[n("div",{staticClass:"setting-line"},[n("label",[t._v("BPM: ")]),n("el-select",{staticStyle:{width:"80px"},attrs:{size:"small"},model:{value:t.music.bpm,callback:function(e){t.$set(t.music,"bpm",e)},expression:"music.bpm"}},t._l(t.bpms,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),n("div",{staticClass:"setting-line"},[n("el-switch",{staticClass:"mode-select",attrs:{"active-text":t.$t("shawzin.number"),"inactive-text":t.$t("shawzin.name")},model:{value:t.useNumber,callback:function(e){t.useNumber=e},expression:"useNumber"}})],1),n("div",{staticClass:"setting-line"},[n("el-switch",{staticClass:"mode-select",attrs:{"active-text":t.$t("shawzin.upshift"),"inactive-text":t.$t("shawzin.downshift")},model:{value:t.useSharp,callback:function(e){t.useSharp=e},expression:"useSharp"}})],1),n("div",{staticClass:"setting-line"},[n("el-switch",{staticClass:"mode-select",attrs:{"active-text":t.$t("shawzin.staff")},model:{value:t.showStaff,callback:function(e){t.showStaff=e},expression:"showStaff"}})],1),n("div",{staticClass:"setting-line"},[t._v(" "+t._s(t.$t("shawzin.transpose"))+" "),n("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini"},model:{value:t.music.numberShift,callback:function(e){t.$set(t.music,"numberShift",e)},expression:"music.numberShift"}},[n("el-option",{attrs:{label:"C",value:0}}),n("el-option",{attrs:{label:"bD",value:1}}),n("el-option",{attrs:{label:"D",value:2}}),n("el-option",{attrs:{label:"bE",value:3}}),n("el-option",{attrs:{label:"E",value:4}}),n("el-option",{attrs:{label:"F",value:5}}),n("el-option",{attrs:{label:"bG",value:6}}),n("el-option",{attrs:{label:"G",value:7}}),n("el-option",{attrs:{label:"bA",value:8}}),n("el-option",{attrs:{label:"A",value:9}}),n("el-option",{attrs:{label:"bB",value:10}}),n("el-option",{attrs:{label:"B",value:11}})],1)],1),n("div",{staticClass:"setting-line"},[n("el-button-group",[n("el-tooltip",{attrs:{effect:"dark",content:t.$t("shawzin.importNumberSeqs"),placement:"bottom"}},[n("el-button",{attrs:{size:"small",icon:"el-icon-download"},on:{click:t.importNumberSeqs}})],1),n("el-tooltip",{attrs:{effect:"dark",content:t.$t("shawzin.copyNumberSeqs"),placement:"bottom"}},[n("el-button",{attrs:{size:"small",icon:"el-icon-copy-document"},on:{click:t.copyNumberSeqs}})],1),n("el-tooltip",{attrs:{effect:"dark",content:t.$t("shawzin.importMidi"),placement:"bottom"}},[n("el-button",{attrs:{size:"small"},on:{click:t.importMidi}},[t._v("MIDI")])],1),n("input",{ref:"midiFile",staticClass:"el-upload__input",attrs:{type:"file"},on:{change:t.midiFileChange}})],1)],1),n("el-button",{attrs:{slot:"reference",size:"small",icon:"el-icon-setting"},slot:"reference"})],1),n("el-radio-group",{attrs:{size:"small"},model:{value:t.editMode,callback:function(e){t.editMode=e},expression:"editMode"}},[n("el-radio-button",{attrs:{label:"move"}},[n("i",{staticClass:"el-icon-rank"})]),n("el-radio-button",{attrs:{label:"add"}},[n("i",{staticClass:"el-icon-edit"})]),n("el-radio-button",{attrs:{label:"delete"}},[n("i",{staticClass:"el-icon-delete"})])],1),n("el-radio-group",{attrs:{size:"small"},model:{value:t.duration,callback:function(e){t.duration=e},expression:"duration"}},[n("el-radio-button",{attrs:{label:1}},[t._v(t._s(t.$t("shawzin.quarter"))+"(J)")]),n("el-radio-button",{attrs:{label:2}},[t._v(t._s(t.$t("shawzin.half"))+"(K)")]),n("el-radio-button",{attrs:{label:4}},[t._v(t._s(t.$t("shawzin.full"))+"(L)")])],1),n("el-button-group",[n("el-button",{attrs:{size:"small",type:"danger",disabled:t.isRecording,icon:"el-icon-video-camera"},on:{click:t.recordSeq}}),t.isPlaying?n("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-video-pause"},on:{click:function(e){return t.stopSeq(!0)}}}):n("el-button",{attrs:{size:"small",type:"primary",disabled:t.isRecording,icon:"el-icon-video-play"},on:{click:t.playSeq}}),n("el-button",{attrs:{size:"small",disabled:!t.isPlaying&&!t.isRecording&&!t.isShowStop},on:{click:function(e){return t.stopSeq()}}},[n("WfIcon",{attrs:{type:"stop"}})],1),n("el-button",{attrs:{size:"small",type:t.loop?"primary":"normal"},on:{click:function(e){t.loop=!t.loop}},model:{value:t.loop,callback:function(e){t.loop=e},expression:"loop"}},[n("WfIcon",{attrs:{type:"loop"}})],1),n("el-button",{attrs:{size:"small",icon:"el-icon-back"},on:{click:t.backspace}}),n("el-tooltip",{attrs:{effect:"dark",content:t.$t("shawzin.importCode"),placement:"bottom"}},[n("el-button",{attrs:{size:"small",icon:"el-icon-download"},on:{click:t.importCode}})],1),n("el-tooltip",{attrs:{effect:"dark",content:t.$t("shawzin.copyCode"),placement:"bottom"}},[n("el-button",{attrs:{size:"small",icon:"el-icon-copy-document"},on:{click:t.copyCode}})],1)],1),n("el-popover",{attrs:{placement:"top"},model:{value:t.clearConfirmVisible,callback:function(e){t.clearConfirmVisible=e},expression:"clearConfirmVisible"}},[n("p",[t._v(t._s(t.$t("shawzin.clearConfirm")))]),n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.clearConfirmVisible=!1}}},[t._v(t._s(t.$t("riven.cancel")))]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.clearConfirmVisible=!1,t.clearNotes()}}},[t._v(t._s(t.$t("riven.confirm")))])],1),n("el-button-group",{attrs:{slot:"reference"},slot:"reference"},[n("el-tooltip",{attrs:{effect:"dark",content:t.$t("shawzin.empty"),placement:"bottom"}},[n("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"}})],1)],1)],1)],1),n("div",{staticClass:"view-area"},[n("div",{staticClass:"input-box"},[n("div",{staticClass:"notation-header"},[t.showStaff?n("Notation",{attrs:{showTrebleClef:!0,showBassClef:!1}},[n("Staff",{attrs:{notes:[0],duration:4}})],1):t._e(),n("div",{staticClass:"note-count"},[t._v(t._s(t.blocks.length)+" "+t._s(t.$t("shawzin.note")))])],1),n("div",{staticClass:"piano"},[n("div",{staticClass:"piano-header"}),n("div",{staticClass:"input-area"},[n("div",{staticClass:"piano-key",on:{click:function(e){return t.music.addNote(null,t.duration)}}},[n("div",{staticClass:"note"},[t._v("0")]),n("div",{staticClass:"key"},[t._v("S")])]),t._l(t.notes,(function(e){return n("div",{key:e.name,staticClass:"piano-key",on:{click:function(n){return t.playAndAddNote(e.code,t.duration)}}},[n("div",{staticClass:"note",class:[t.useNumber&&e.tone&&"tone"+e.tone]},[t._v(" "+t._s(t.useNumber?t.useSharp?e.sharpNumber:e.number:t.useSharp?e.sharpName:e.name)+" ")]),n("div",{staticClass:"key"},[t._v(t._s(t.keyMaps[e.code]))])])}))],2)])]),n("div",{ref:"pianoWindow",staticClass:"piano-window",class:{drag:t.isDragCanvas,draging:t.draggingCanvas},on:{mousedown:t.onCanvasDragStart}},[n("div",{staticClass:"preview-area"},[t.showStaff?n("div",{staticClass:"staff"},[n("Notation",{attrs:{showTrebleClef:!0,showBassClef:!1}},t._l(t.music.notes,(function(e,o){return n("Staff",{key:o,attrs:{notes:[e.shiftMidi],type:t.calcNoteType(o),duration:e.duration}})})),1)],1):t._e(),n("div",{staticClass:"number"},t._l(t.music.notes,(function(e,o){return n("div",{key:o,staticClass:"number-note note",class:[e.tone&&"tone"+e.tone,"du"+e.duration]},[t._v(" "+t._s(t.useSharp?e.sharpNumber:e.number)+" ")])})),0)]),n("div",{staticClass:"timelines",on:{mousedown:t.moveCursor}},[n("div",{ref:"timeAnchor",staticClass:"time-anchor"}),t._l(t.maxLines/4,(function(e){return n("div",{key:e,staticClass:"timeline"},[n("span",[t._v("#"+t._s(e))]),n("span",[t._v(t._s(t.lineToTime(e)))])])}))],2),n("div",{ref:"pCanvas",staticClass:"piano-canvas",class:{addmode:"add"===t.editMode},on:{mousedown:t.selectStart}},[n("div",{staticClass:"lines"},t._l(t.maxLines,(function(t){return n("div",{key:t,staticClass:"line"})})),0),t._l(t.blocks,(function(e,o){return n("div",{key:o,staticClass:"block",class:{noevent:t.isSelect,selected:e.selected},style:{top:e.y+"px",left:e.x+"px",width:e.width+"px"},on:{mousedown:function(n){return n.stopPropagation(),t.singleSelectStart(n,{block:e,index:o})}}},[t._v(" "+t._s(t.toNote(e.y)))])})),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isSelect,expression:"isSelect"}],ref:"selectBorder",staticClass:"select-border"})],2)])]),n("el-dialog",{staticClass:"update-dialog",attrs:{title:t.$t("shawzin.help"),visible:t.showHelp},on:{"update:visible":function(e){t.showHelp=e}}},[n("div",{staticClass:"help-item"},[n("article",{staticClass:"md markdown-body",domProps:{innerHTML:t._s(t.userGuide)}})]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.showHelp=!1}}},[t._v(t._s(t.$t("update.confirm")))])],1)])],1)},r=[],i=n("d4ec"),s=n("bee2"),a=n("262e"),c=n("2caf"),u=n("ade3"),l=n("53ca"),h=(n("e439"),n("ac1f"),n("1276"),n("99af"),n("d81d"),n("b0c0"),n("4de4"),n("159b"),n("c740"),n("7db0"),n("a434"),n("d3b7"),n("ddb0"),n("4e82"),n("624e")),p=n("b84d"),f=n("9bbd"),d=Object(f["a"])((function(t,e,n){Object(p["a"])(t,n,e)})),y=d,m=n("5c8a"),v=n("60a3"),_=n("9d88"),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{class:{container:!0,active:t.active},style:[0==t.duration&&{position:"absolute"}],attrs:{width:t.width,height:t.height},on:{click:t.onClick}},[t._l(t.lines,(function(t){return n("line",{key:t.y1+t.width,style:"stroke:black;stroke-width:"+t.width,attrs:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}})})),t.showBrace&&t.showTrebleClef?n("TrebleClef",{attrs:{y:t.trebleClefStart,x:5}}):t._e(),t.showBrace&&t.showBassClef?n("BassClef",{attrs:{y:t.bassClefStart,x:10}}):t._e(),t._l(t.notePositions,(function(e){return n("Note",{key:"note_"+e.x+"_"+e.y,attrs:{x:e.x,y:e.y,type:t.type}})})),t._l(t.sharpPositions,(function(t){return n("Sharp",{key:"sharp_"+t.x+"_"+t.y,attrs:{x:t.x,y:t.y}})}))],2)},b=[],w=n("2909"),x=(n("b64b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{attrs:{transform:"translate("+t.x+","+(t.y+15)+") scale("+t.scale+","+t.scale+")"}},[n("path",{attrs:{d:"M 592.10873,1275.9669 C 461.75172,1268.3902 328.65904,1186.6265 249.0601,1092.783 C 156.77394,983.97782 118.72592,836.04683 128.47199,714.56357 C 157.10277,357.61288 545.27831,146.63848 688.97108,-9.280262 C 785.15294,-113.64625 805.31643,-164.52308 826.79977,-218.19949 C 868.39181,-322.09965 875.09166,-443.8341 792.63375,-452.92251 C 713.90712,-461.59988 649.13737,-337.79201 620.20973,-253.17845 C 594.19587,-177.07331 576.90507,-100.71696 592.5563,13.979673 C 599.58954,65.50958 793.18636,1503.9125 796.45179,1526.2088 C 829.05589,1749.0255 701.63092,1841.2249 571.55248,1857.6251 C 290.65671,1893.038 200.52617,1607.5843 326.4212,1499.1719 C 423.34291,1415.7001 564.35026,1487.3615 556.73245,1624.5919 C 549.98693,1746.1391 430.80546,1749.7197 400.35244,1746.9429 C 447.10065,1830.7846 799.52998,1874.5871 745.41513,1495.7923 C 737.811,1442.5634 558.91549,90.842953 554.53112,60.595454 C 521.71238,-165.84753 516.71147,-345.08557 634.69182,-554.25141 C 678.24767,-631.46637 747.0821,-681.3156 780.87362,-674.7893 C 788.29962,-673.35526 795.69824,-670.62872 801.57144,-664.56827 C 892.07191,-571.31845 919.83494,-364.53202 909.9199,-245.74332 C 899.76736,-124.11391 894.1088,1.7993735 773.16902,148.63428 C 726.36601,205.45738 583.54553,330.63538 501.65851,402.55255 C 386.60107,503.59831 303.14756,591.85179 257.99323,698.31862 C 207.24886,817.97506 198.65826,968.6006 313.27268,1102.2505 C 379.20247,1177.7619 488.59222,1231.3424 580.65459,1232.4842 C 836.63719,1235.6628 911.39048,1109.4801 913.77904,966.58197 C 917.71126,731.28351 633.64596,642.32214 516.85762,804.10953 C 449.14212,897.92109 478.90552,996.66049 524.38411,1043.6371 C 539.99424,1059.7587 557.43121,1072.0395 573.92734,1078.8855 C 579.9056,1081.3654 593.96751,1087.9054 589.97593,1097.4779 C 586.6557,1105.4428 580.20702,1105.8904 574.33381,1105.1871 C 500.68573,1096.3544 419.13667,1025.958 399.0828,904.87212 C 369.86288,728.38801 525.6035,519.0349 747.9133,553.274 C 893.45572,575.68903 1028.5853,700.92182 1016.7338,934.11946 C 1006.5722,1133.9822 840.87996,1290.4262 592.10873,1275.9669 z"}})])}),O=[],k={props:{x:{default:0},y:{default:0},scale:{default:.028}}},C=k,T=n("2877"),S=Object(T["a"])(C,x,O,!1,null,null,null),A=S.exports,M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{attrs:{transform:"translate("+t.x+","+t.y+") scale("+t.scale+","+t.scale+")",viewBox:"0 0 18 20"}},[n("g",{attrs:{transform:"translate(6.600000e-3,3.125356e-3)"}},[n("g",{staticStyle:{fill:"#000000","fill-opacity":"1.0000000"},attrs:{transform:"translate(-230.9546,-533.6597)"}},[n("path",{staticStyle:{fill:"#000000","fill-opacity":"1.0000000"},attrs:{d:"M 248.25999,536.80200 C 248.26766,537.17138 248.11044,537.54065 247.82878,537.78185 C 247.46853,538.11076 246.91933,538.17813 246.47048,538.01071 C 246.02563,537.83894 245.69678,537.39883 245.67145,536.92060 C 245.63767,536.54689 245.75685,536.15479 246.02747,535.88867 C 246.28257,535.61680 246.66244,535.48397 247.03147,535.50645 C 247.41131,535.51452 247.77805,535.70601 248.00489,536.01019 C 248.17962,536.23452 248.26238,536.51954 248.25999,536.80200 z "}})]),n("g",{staticStyle:{fill:"#000000","fill-opacity":"1.0000000"},attrs:{transform:"translate(-230.9546,-533.6597)"}},[n("path",{staticStyle:{fill:"#000000","fill-opacity":"1.0000000"},attrs:{d:"M 248.25999,542.64502 C 248.26772,543.01469 248.11076,543.38446 247.82878,543.62585 C 247.46853,543.95476 246.91933,544.02213 246.47048,543.85472 C 246.02537,543.68288 245.69655,543.24237 245.67145,542.76389 C 245.63651,542.38990 245.76354,542.00308 246.02700,541.73300 C 246.27663,541.45454 246.66060,541.32790 247.02845,541.34950 C 247.51230,541.36282 247.95159,541.69251 248.15162,542.12465 C 248.22565,542.28740 248.26043,542.46657 248.25999,542.64502 z "}})]),n("g",{staticStyle:{fill:"#000000","fill-opacity":"1.0000000"},attrs:{transform:"translate(-230.9546,-533.6597)"}},[n("path",{staticStyle:{fill:"#000000","fill-opacity":"1.0000000"},attrs:{d:"M 243.97900,540.86798 C 244.02398,543.69258 242.76360,546.43815 240.76469,548.40449 C 238.27527,550.89277 235.01791,552.47534 231.69762,553.53261 C 231.25590,553.77182 230.58970,553.45643 231.28550,553.13144 C 232.62346,552.52289 234.01319,552.00050 235.24564,551.18080 C 237.96799,549.49750 240.26523,546.84674 240.82279,543.61854 C 241.14771,541.65352 241.05724,539.60795 240.56484,537.67852 C 240.20352,536.25993 239.22033,534.79550 237.66352,534.58587 C 236.25068,534.36961 234.74885,534.85905 233.74057,535.88093 C 233.47541,536.14967 232.95916,536.89403 233.04435,537.74747 C 233.64637,537.27468 233.60528,537.32732 234.09900,537.10717 C 235.23573,536.60031 236.74349,537.32105 237.02700,538.57272 C 237.32909,539.72295 237.09551,541.18638 235.96036,541.79960 C 234.77512,542.44413 233.02612,542.17738 232.36450,540.90866 C 231.26916,538.95418 231.87147,536.28193 233.64202,534.92571 C 235.44514,533.42924 238.07609,533.37089 240.19963,534.13862 C 242.38419,534.95111 243.68629,537.21483 243.89691,539.45694 C 243.95419,539.92492 243.97896,540.39668 243.97900,540.86798 z "}})])])])},P=[],E={props:{x:{default:0},y:{default:0},scale:{default:1.7}}},I=E,j=Object(T["a"])(I,M,P,!1,null,null,null),D=j.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return"quard"===t.type?n("g",{attrs:{transform:"translate("+t.x+","+t.y+") scale("+t.scale+","+t.scale+")"}},[n("g",{attrs:{transform:"translate(-293,-70)"}},[n("g",{attrs:{transform:t.y<45?"translate(-10,35)":""}},[n("path",{attrs:{"stroke-width":"1.5",fill:"none",stroke:"black","stroke-dasharray":"none",d:"M306.21864 75L306.21864 40"}})]),n("g",[n("path",{attrs:{"stroke-width":"0.3",fill:"black",stroke:"none","stroke-dasharray":"none",d:"M294.9504 75M302.30736 69.77712C302.41968 69.77712,302.58816 69.77712,302.61624 69.77712C302.61624 69.77712,302.64432 69.77712,302.64432 69.77712C302.64432 69.77712,302.8128 69.77712,302.9532 69.77712C305.48040000000003 69.91752,306.96864 71.57424,306.96864 73.65216C306.96864 74.66304,306.63168 75.81432,305.78928 76.90944C304.18872 79.0716,301.57728 80.25096,299.3028 80.25096C297.53376000000003 80.25096,296.01744 79.54896,295.28736 78.11688C295.06272 77.55528,294.9504 77.02176,294.9504 76.43208C294.9504 73.37136,298.37616 69.97368,302.30736 69.77712"}})])])]):"half"===t.type?n("g",{attrs:{transform:"translate("+t.x+","+t.y+") scale("+t.scale+","+t.scale+")"}},[n("g",{attrs:{transform:"translate(-78,-95)"}},[n("g",{attrs:{transform:t.y<45?"translate(-10,35)":""}},[n("path",{attrs:{"stroke-width":"1.5",fill:"none",stroke:"black","stroke-dasharray":"none",d:"M91.16904 100L91.16904 65"}})]),n("g",[n("path",{attrs:{"stroke-width":"0.3",fill:"black",stroke:"none","stroke-dasharray":"none",d:"M79.90079999999999 100M87.25775999999999 94.77712C87.37007999999999 94.77712,87.53855999999999 94.77712,87.56663999999999 94.77712C87.56663999999999 94.77712,87.59472 94.77712,87.59472 94.77712C87.59472 94.77712,87.76319999999998 94.77712,87.90359999999998 94.77712C90.43079999999999 94.91752,91.91904 96.57424,91.91904 98.65216C91.91904 99.66304,91.58207999999999 100.81432,90.73967999999999 101.90944C89.13911999999999 104.0716,86.52767999999999 105.25096,84.25319999999999 105.25096C82.48415999999999 105.25096,80.96784 104.54896,80.23776 103.11688C80.01311999999999 102.55528,79.90079999999999 102.02176,79.90079999999999 101.43208C79.90079999999999 98.37136,83.32655999999999 94.97368,87.25775999999999 94.77712M90.17808 96.32152C90.06575999999998 96.26536,89.92535999999998 96.23728,89.78495999999998 96.23728C88.91448 96.23728,87.45432 96.7708,86.05031999999999 97.72552C83.43887999999998 99.35416,81.30479999999999 101.74096,81.22055999999999 103.11688C81.22055999999999 103.11688,81.22055999999999 103.14496,81.22055999999999 103.14496C81.22055999999999 103.62232,81.52944 103.81888000000001,82.06295999999999 103.81888000000001C83.21423999999999 103.81888000000001,85.34831999999999 102.83608,87.31392 101.2636C89.33568 99.66304,90.62736 97.86592,90.62736 96.93928C90.62736 96.6304,90.48695999999998 96.37768,90.17808 96.32152"}})])])]):n("g",{attrs:{transform:"translate("+t.x+","+t.y+") scale("+t.scale+","+t.scale+")"}},[n("g",{attrs:{transform:"translate(-78,-95)"}},[n("g",[n("path",{attrs:{"stroke-width":"0.3",fill:"black",stroke:"none","stroke-dasharray":"none",d:"M79.90079999999999 100M87.25775999999999 94.77712C87.37007999999999 94.77712,87.53855999999999 94.77712,87.56663999999999 94.77712C87.56663999999999 94.77712,87.59472 94.77712,87.59472 94.77712C87.59472 94.77712,87.76319999999998 94.77712,87.90359999999998 94.77712C90.43079999999999 94.91752,91.91904 96.57424,91.91904 98.65216C91.91904 99.66304,91.58207999999999 100.81432,90.73967999999999 101.90944C89.13911999999999 104.0716,86.52767999999999 105.25096,84.25319999999999 105.25096C82.48415999999999 105.25096,80.96784 104.54896,80.23776 103.11688C80.01311999999999 102.55528,79.90079999999999 102.02176,79.90079999999999 101.43208C79.90079999999999 98.37136,83.32655999999999 94.97368,87.25775999999999 94.77712M90.17808 96.32152C90.06575999999998 96.26536,89.92535999999998 96.23728,89.78495999999998 96.23728C88.91448 96.23728,87.45432 96.7708,86.05031999999999 97.72552C83.43887999999998 99.35416,81.30479999999999 101.74096,81.22055999999999 103.11688C81.22055999999999 103.11688,81.22055999999999 103.14496,81.22055999999999 103.14496C81.22055999999999 103.62232,81.52944 103.81888000000001,82.06295999999999 103.81888000000001C83.21423999999999 103.81888000000001,85.34831999999999 102.83608,87.31392 101.2636C89.33568 99.66304,90.62736 97.86592,90.62736 96.93928C90.62736 96.6304,90.48695999999998 96.37768,90.17808 96.32152"}})])])])},R=[],B={props:{type:{default:"full"},x:{default:0},y:{default:0},scale:{default:1}}},q=B,F=Object(T["a"])(q,N,R,!1,null,null,null),V=F.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{attrs:{transform:"translate("+t.x+","+t.y+") scale("+t.scale+","+t.scale+")",viewBox:"0 0 6 19"}},[n("g",{attrs:{transform:"translate(0.000000,0.765000)"}},[n("g",{staticStyle:{fill:"#000000"},attrs:{transform:"translate(-84.19600,-436.0680)"}},[n("path",{attrs:{d:"M 86.102000,447.45700 L 86.102000,442.75300 L 88.102000,442.20100 L 88.102000,446.88100 L 86.102000,447.45700 z M 90.040000,446.31900 L 88.665000,446.71300 L 88.665000,442.03300 L 90.040000,441.64900 L 90.040000,439.70500 L 88.665000,440.08900 L 88.665000,435.30723 L 88.102000,435.30723 L 88.102000,440.23400 L 86.102000,440.80900 L 86.102000,436.15923 L 85.571000,436.15923 L 85.571000,440.98600 L 84.196000,441.37100 L 84.196000,443.31900 L 85.571000,442.93500 L 85.571000,447.60600 L 84.196000,447.98900 L 84.196000,449.92900 L 85.571000,449.54500 L 85.571000,454.29977 L 86.102000,454.29977 L 86.102000,449.37500 L 88.102000,448.82500 L 88.102000,453.45077 L 88.665000,453.45077 L 88.665000,448.65100 L 90.040000,448.26600 L 90.040000,446.31900 z "}})])])])},L=[],z={props:{x:{default:0},y:{default:0},scale:{default:.9}}},W=z,G=Object(T["a"])(W,U,L,!1,null,null,null),$=G.exports,Y=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Q=10,H=3,X=[{position:0},{position:0,sharp:1},{position:1},{position:1,sharp:1},{position:2},{position:3},{position:3,sharp:1},{position:4},{position:4,sharp:1},{position:5},{position:5,sharp:1},{position:6}],J=function(t,e,n,o){var r=[];return t.forEach((function(t){r.push({x1:0,x2:o,y1:e-t*n,y2:e-t*n,width:1})})),r},Z=function(t){return X[t%12].position-7*(5-Math.floor(t/12))},K=function(t){var e=!1,n=!1,o=!1,r=!1;return t&&t.forEach((function(t){var i=t%12;X[i].sharp&&(e=!0),t<58&&(n=!0),Z(t)%2===0?o=!0:r=!0})),{hasSharp:e,hasBassNotes:n,hasEven:o,hasOdd:r,bothSides:o&&r}},tt=function(t){Object(a["a"])(n,t);var e=Object(c["a"])(n);function n(){var t;return Object(i["a"])(this,n),t=e.apply(this,arguments),t.lines=[],t.width=0,t.height=0,t.trebleClefStart=0,t.bassClefStart=0,t.notePositions=[],t.sharpPositions=[],t}return Object(s["a"])(n,[{key:"mounted",value:function(){this.reload()}},{key:"reload",value:function(){var t=(this.showTrebleClef?6*Q:0)+(this.showBassClef?6*Q:0)+(this.showBassClef||this.showTrebleClef?6*Q:0),e=K(this.notes),n=this.showBrace?45:e.bothSides?31:20*Math.max(1,this.duration);!this.showEnd||this.showBrace||this.notes||(n=2),e.hasSharp;var o={};if(this.showTrebleClef)for(var r=1;r<6;r++)o[r]=1;if(this.showBassClef)for(var i=-3;i>-8;i--)o[i]=1;var s=[],a=H,c=0,u=0,l=null;this.showTrebleClef&&(c=Q*a-11,this.showEnd&&s.push({x1:1,x2:1,y1:a*Q,y2:(a+4)*Q,width:3}),l=Q*a+4.5*Q,a+=8),this.showBassClef&&(l||(l=Q*a-3.5*Q),u=Q*a,this.showEnd&&s.push({x1:1,x2:1,y1:a*Q,y2:(a+4)*Q,width:3}));var h=[],p=[];if(this.notes){var f=0,d=13;e.bothSides||(f=2,d=2),e.hasSharp,this.notes.forEach((function(t){var n=Z(t);h.push({x:n%2===0?f:d,y:l-n*(Q/2)}),X[t%12].sharp&&p.push({x:16,y:l-n*(Q/2)-5});var r=Math.floor(n/2);if(r<=-8)for(var i=r;i<=-8;i+=1)o[i]=1;else if(r>-3&&r<0)if(e.hasBassNotes)for(var s=-3;s<=r;s+=1)o[s]=1;else for(var a=0;a>r;a-=1)o[a]=1;else if(r>5)for(var c=5;c<=r;c+=1)o[c]=1}))}s=[].concat(Object(w["a"])(s),Object(w["a"])(J(Object.keys(o).map((function(t){return parseInt(t)})),l+Q/2,Q,n))),this.lines=s,this.width=n,this.height=t,this.trebleClefStart=c,this.bassClefStart=u,this.notePositions=h,this.sharpPositions=p}},{key:"onClick",value:function(t){this.$emit("click",t)}}]),n}(v["e"]);Y([Object(v["b"])({default:!1})],tt.prototype,"showTrebleClef",void 0),Y([Object(v["b"])({default:!1})],tt.prototype,"showBassClef",void 0),Y([Object(v["d"])({default:!1})],tt.prototype,"showBrace",void 0),Y([Object(v["d"])({default:!1})],tt.prototype,"showEnd",void 0),Y([Object(v["d"])({default:null})],tt.prototype,"notes",void 0),Y([Object(v["d"])({default:!1})],tt.prototype,"active",void 0),Y([Object(v["d"])({default:"full"})],tt.prototype,"type",void 0),Y([Object(v["d"])({default:1})],tt.prototype,"duration",void 0),Y([Object(v["f"])("notes")],tt.prototype,"reload",null),tt=Y([Object(v["a"])({components:{TrebleClef:A,BassClef:D,Note:V,Sharp:$}})],tt);var et=tt,nt=et,ot=(n("474f"),Object(T["a"])(nt,g,b,!1,null,"61f7b7d4",null)),rt=ot.exports,it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("Staff",{attrs:{showTrebleClef:t.showTrebleClef,showBassClef:t.showBassClef,showBrace:!0,showEnd:!0}}),t._t("default"),n("Staff",{attrs:{showEnd:!0}})],2)},st=[],at={props:{showTrebleClef:{default:!0},showBassClef:{default:!0}},components:{Staff:rt},provide:function(){return{showTrebleClef:this.showTrebleClef,showBassClef:this.showBassClef}}},ct=at,ut=(n("665f"),Object(T["a"])(ct,it,st,!1,null,"3567e258",null)),lt=ut.exports,ht="14.3.14",pt=n("04d1d");const ft=()=>{try{return new DOMException("","AbortError")}catch(t){return t.code=20,t.name="AbortError",t}},dt=new WeakSet,yt=new WeakSet,mt=new WeakMap,vt=new WeakMap,_t=new WeakMap,gt=new WeakMap,bt=new WeakMap,wt=new WeakMap,xt=new WeakMap,Ot=new WeakSet,kt=new WeakMap,Ct=new WeakMap,Tt=new WeakMap,St=new WeakSet,At=new WeakMap,Mt=t=>new Promise((e,n)=>{const o=document.head;if(null===o)n(new SyntaxError);else{const r=document.createElement("script"),i=new Blob([t],{type:"application/javascript"}),s=URL.createObjectURL(i),a=window.onerror,c=()=>{window.onerror=a,URL.revokeObjectURL(s)};window.onerror=(t,e,o,r,i)=>e===s||e===location.href&&1===o&&1===r?(c(),n(i),!1):null!==a?a(t,e,o,r,i):void 0,r.onerror=()=>{c(),n(new SyntaxError)},r.onload=()=>{c(),e()},r.src=s,r.type="module",o.appendChild(r)}}),Pt=()=>{try{return new DOMException("","InvalidStateError")}catch(t){return t.code=11,t.name="InvalidStateError",t}},Et=t=>{const e=xt.get(t);if(void 0===e)throw Pt();return e},It={construct(){return It}},jt=t=>{try{const e=new Proxy(t,It);new e}catch(e){return!1}return!0},Dt=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Nt=(t,e)=>{const n=[];let o=t.replace(/^[\s]+/,""),r=o.match(Dt);while(null!==r){const t=r[1].slice(1,-1),i=r[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(i),o=o.slice(r[0].length).replace(/^[\s]+/,""),r=o.match(Dt)}return[n.join(";"),o]},Rt=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Bt=t=>{if(!jt(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!==typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.");if("function"!==typeof t.prototype.process)throw new TypeError("The given value for processorCtor should have a callable process() function.")},qt=(t,e,n,o,r,i,s)=>(a,c,u={credentials:"omit"})=>{const l=Et(a),h=new URL(c,location.href).toString();if(void 0!==l.audioWorklet)return o(c).then(t=>{const[e,n]=Nt(t,h),o=`${e};(registerProcessor=>{${n}\n})((n,p)=>registerProcessor(n,class extends p{constructor(o){const{hasNoOutput,...q}=o.parameterData;if(hasNoOutput===1){super({...o,numberOfOutputs:0,outputChannelCount:[],parameterData:q});this._h=true}else{super(o);this._h=false}}process(i,o,p){return super.process(i,(this._h)?[]:o,p)}}))`,i=new Blob([o],{type:"application/javascript; charset=utf-8"}),s=URL.createObjectURL(i),a=r(l),c=null!==a?a:l;return c.audioWorklet.addModule(s,u).then(()=>URL.revokeObjectURL(s)).catch(t=>{throw URL.revokeObjectURL(s),t})});const p=s.get(a);if(void 0!==p&&p.has(c))return Promise.resolve();const f=i.get(a);if(void 0!==f){const t=f.get(c);if(void 0!==t)return t}const d=o(c).then(t=>{const[e,n]=Nt(t,h),o=`${e};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${n}\n})})(window,'_AWGS')`;return Mt(o)}).then(()=>{const t=window._AWGS.pop();if(void 0===t)throw new SyntaxError;n(l,()=>t(class{},void 0,(t,n)=>{if(""===t.trim())throw e();const o=Ct.get(l);if(void 0!==o){if(o.has(t))throw e();Bt(n),Rt(n.parameterDescriptors),o.set(t,n)}else Bt(n),Rt(n.parameterDescriptors),Ct.set(l,new Map([[t,n]]))},l.sampleRate,void 0,void 0))}).catch(e=>{if("SyntaxError"===e.name)throw t();throw e});return void 0===f?i.set(a,new Map([[c,d]])):f.set(c,d),d.then(()=>{const t=s.get(a);void 0===t?s.set(a,new Set([c])):t.add(c)}).catch(()=>{}).then(()=>{const t=i.get(a);void 0!==t&&t.delete(c)}),d},Ft={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Vt=(t,e,n,o,r)=>class extends r{constructor(e,r=Ft){const i=Et(e),s={...Ft,...r},a=n(i,s),c=o(i)?t():null;super(e,"passive",a,c),this._nativeAnalyserNode=a}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const n=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=n,e()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const n=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=n,e()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}},Ut=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},Lt=t=>Ut(mt,t),zt=(t,e)=>t.context===e;function Wt(t){return Ut(vt,t)}const Gt=t=>{const e=Wt(t.context);return Ut(e.nodes,t)},$t=t=>{const e=Gt(t);if(null===e.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer},Yt=(t,e,n)=>{const o=Gt(t);return Promise.all(o.activeInputs.map((t,o)=>Array.from(t).map(([t,r])=>$t(t).render(t,e).then(t=>t.connect(n,r,o)))).reduce((t,e)=>[...t,...e],[]))},Qt=t=>()=>{const e=new WeakMap,n=async(n,o)=>{let r=Lt(n);const i=zt(r,o);if(!i){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,fftSize:r.fftSize,maxDecibels:r.maxDecibels,minDecibels:r.minDecibels,smoothingTimeConstant:r.smoothingTimeConstant};r=t(o,e)}return e.set(o,r),await Yt(n,o,r),r};return{render(t,o){const r=e.get(o);return void 0!==r?Promise.resolve(r):n(t,o)}}},Ht=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch(e){return!1}return!0},Xt=t=>{const e=new Float32Array(2);try{t.copyFromChannel(e,0,t.length-1)}catch(n){return!1}return!0},Jt=()=>{try{return new DOMException("","IndexSizeError")}catch(t){return t.code=1,t.name="IndexSizeError",t}},Zt=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(o){if(12===o.code)throw Jt();throw o}})(t.getChannelData)},Kt={numberOfChannels:1},te=(t,e,n,o,r,i,s,a,c)=>{let u=null;return class l{constructor(l){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:p,sampleRate:f}={...Kt,...l};null===u&&(u=new r(1,1,44100));const d=null!==o&&e(i,i)?new o({length:h,numberOfChannels:p,sampleRate:f}):u.createBuffer(p,h,f);if(0===d.numberOfChannels)throw n();return"function"!==typeof d.copyFromChannel?(s(d),Zt(d)):e(Xt,()=>Xt(d))?e(Ht,()=>Ht(d))||a(d):(c(d),a(d)),t.add(d),d}static[Symbol.hasInstance](e){return null!==e&&"object"===typeof e&&Object.getPrototypeOf(e)===l.prototype||t.has(e)}}},ee=-34028234663852886e22,ne=-ee,oe=t=>Ut(kt,t),re=(t,e)=>{if("active"===e){if(dt.has(t))throw new Error("The AudioNode is already stored.");dt.add(t)}else{if(!dt.has(t))throw new Error("The AudioNode is not stored.");dt.delete(t)}oe(t).forEach(t=>t(e))},ie=(t,e)=>"function"===typeof e?n=>{const o={value:t};return Object.defineProperties(n,{currentTarget:o,target:o}),e.call(t,n)}:e,se={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},ae=(t,e,n,o,r,i)=>class extends i{constructor(n,i=se){const s=Et(n),a={...se,...i},c=o(s,a),u=r(s),l=u?t():null;super(n,"passive",c,l),this._audioBufferSourceNodeRenderer=l,this._isBufferNullified=!1,this._isBufferSet=!1,this._nativeAudioBufferSourceNode=c,this._onended=null,this._playbackRate=e(this,u,c.playbackRate,ne,ee)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){try{this._nativeAudioBufferSourceNode.buffer=t}catch(e){if(null!==t||17!==e.code)throw e;if(null!==this._nativeAudioBufferSourceNode.buffer){const t=this._nativeAudioBufferSourceNode.buffer,e=t.numberOfChannels;for(let n=0;n<e;n+=1)t.getChannelData(n).fill(0);this._isBufferNullified=!0}}if(null!==t){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get onended(){return this._onended}set onended(t){const e=ie(this,t);this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=n===e?t:n}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer)this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n];else{re(this,"active");const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),setTimeout(()=>re(this,"passive"),1e3)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}},ce=t=>Ut(_t,t);function ue(t,e){const n=Wt(t);return Ut(n.params,e)}const le=(t,e,n,o)=>{const r=ue(t,e);return Promise.all(Array.from(r.activeInputs).map(([t,e])=>$t(t).render(t,n).then(t=>t.connect(o,e))))},he=(t,e,n,o=ce(n))=>le(t,n,e,o);function pe(t,e){const n=ue(t,e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer}const fe=(t,e,n,o)=>{const r=pe(t,n);return r.replay(o),le(t,n,e,o)},de=t=>()=>{const e=new WeakMap;let n=null,o=null;const r=async(r,i)=>{let s=Lt(r);const a=zt(s,i);if(!a){const e={buffer:s.buffer,channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,loop:s.loop,loopEnd:s.loopEnd,loopStart:s.loopStart,playbackRate:s.playbackRate.value};s=t(i,e),null!==n&&s.start(...n),null!==o&&s.stop(o)}return e.set(i,s),a?await he(r.context,i,r.playbackRate):await fe(r.context,i,r.playbackRate,s.playbackRate),await Yt(r,i,s),s};return{set start(t){n=t},set stop(t){o=t},render(t,n){const o=e.get(n);return void 0!==o?Promise.resolve(o):r(t,n)}}},ye=t=>void 0===t||"number"===typeof t||"string"===typeof t&&("balanced"===t||"interactive"===t||"playback"===t),me=(t,e,n,o,r,i,s,a)=>class extends t{constructor(t={}){if(null===a)throw new Error("Missing the native AudioContext constructor.");const e=new a(t);if(null===e)throw o();if(!ye(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,e.destination.channelCount);const{latencyHint:r}=t,{sampleRate:i}=e;if(this._baseLatency="number"===typeof e.baseLatency?e.baseLatency:"balanced"===r?512/i:"interactive"===r||void 0===r?256/i:"playback"===r?1024/i:128*Math.max(2,Math.min(128,Math.round(r*i/128)))/i,this._nativeAudioContext=e,this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw e()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close())}createMediaElementSource(t){return new r(this,{mediaElement:t})}createMediaStreamSource(t){return new i(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new s(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)}):this._nativeAudioContext.resume().catch(t=>{if(void 0===t||15===t.code)throw e();throw t})}suspend(){return this._nativeAudioContext.suspend().catch(t=>{if(void 0===t)throw e();throw t})}},ve=(t,e,n,o,r,i)=>class extends t{constructor(t,n){const o=Et(t),s=i(o),a=r(o,n,s),c=s?e():null,u={audioWorkletGlobalScope:null,nodes:new WeakMap,params:new WeakMap};vt.set(t,u),super(t,"passive",a,c),this._isNodeOfNativeOfflineAudioContext=s,this._nativeAudioDestinationNode=a}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw o();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw o();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},_e=()=>{let t=null;const e=async(t,e)=>{const n=e.destination;return await Yt(t,e,n),n};return{render(n,o){return null===t&&(t=e(n,o)),t}}},ge=(t,e,n,o,r)=>(i,s)=>{const a=s.listener,c=()=>{const c=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),u=r(s),l=o(s,256,9,0),h=(e,o)=>{const r=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:o});return r.connect(c,0,e),r.start(),Object.defineProperty(r.offset,"defaultValue",{get(){return o}}),t({context:i},u,r.offset,ne,ee)};let p=[0,0,-1,0,1,0],f=[0,0,0];return l.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0],t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];e.some((t,e)=>t!==p[e])&&(a.setOrientation(...e),p=e);const n=[t.getChannelData(6)[0],t.getChannelData(7)[0],t.getChannelData(8)[0]];n.some((t,e)=>t!==f[e])&&(a.setPosition(...n),f=n)},c.connect(l),{forwardX:h(0,0),forwardY:h(1,0),forwardZ:h(2,-1),positionX:h(6,0),positionY:h(7,0),positionZ:h(8,0),upX:h(3,0),upY:h(4,1),upZ:h(5,0)}},{forwardX:u,forwardY:l,forwardZ:h,positionX:p,positionY:f,positionZ:d,upX:y,upY:m,upZ:v}=void 0===a.forwardX?c():a;return{get forwardX(){return u},get forwardY(){return l},get forwardZ(){return h},get positionX(){return p},get positionY(){return f},get positionZ(){return d},get upX(){return y},get upY(){return m},get upZ(){return v}}};class be{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,e,n){let o=this._listeners.get(e);return void 0===o&&(o=ie(this,e),"function"===typeof e&&this._listeners.set(e,o)),this._nativeEventTarget.addEventListener(t,o,n)}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const o=this._listeners.get(e);return this._nativeEventTarget.removeEventListener(t,void 0===o?null:o,n)}}const we=t=>"context"in t,xe=t=>we(t[0]),Oe=t=>"port"in t,ke=(t,e,n,o)=>{const r=e.inputs;return void 0!==r?(t.connect(r[o],n,0),[r[o],n,0]):(t.connect(e,n,o),[e,n,o])},Ce=(t,e)=>{const n=oe(t);if(!n.delete(e))throw new Error("Missing the expected event listener")},Te=(t,e,n,o)=>{const r=e.inputs;void 0===o||void 0===n?t.disconnect(e):void 0!==r?t.disconnect(r[o],n,0):t.disconnect(e,n,o)},Se=(t,e,n,o)=>{for(const r of t)if(n(r)){if(o)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},Ae=t=>dt.has(t),Me=t=>!dt.has(t),Pe=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[o]=n;return t.delete(o),o},Ee=(t,e)=>{!Oe(t)&&e.every(t=>0===t.size)&&re(t,"passive")},Ie=t=>new Promise(e=>{const n=t.createScriptProcessor(256,1,1),o=t.createGain(),r=t.createBuffer(1,2,44100),i=r.getChannelData(0);i[0]=1,i[1]=1;const s=t.createBufferSource();s.buffer=r,s.loop=!0,s.connect(n),n.connect(t.destination),s.connect(o),s.disconnect(o),n.onaudioprocess=o=>{const r=o.inputBuffer.getChannelData(0);Array.prototype.some.call(r,t=>1===t)?e(!0):e(!1),s.stop(),n.onaudioprocess=null,s.disconnect(n),n.disconnect(t.destination)},s.start()}),je=t=>"context"in t,De=t=>{const e=new Map;t.connect=(t=>(n,o=0,r=0)=>{const i=je(n)?t(n,o,r):t(n,o),s=e.get(n);return void 0===s?e.set(n,[{input:r,output:o}]):s.every(t=>t.input!==r||t.output!==o)&&s.push({input:r,output:o}),i})(t.connect.bind(t)),t.disconnect=(n=>(o,r,i)=>{if(n.apply(t),void 0===o)e.clear();else if("number"===typeof o)for(const[t,n]of e){const r=n.filter(t=>t.output!==o);0===r.length?e.delete(t):e.set(t,r)}else if(e.has(o))if(void 0===r)e.delete(o);else{const t=e.get(o);if(void 0!==t){const n=t.filter(t=>t.output!==r&&(t.input!==i||void 0===i));0===n.length?e.delete(o):e.set(o,n)}}for(const[n,s]of e)s.forEach(e=>{je(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)})})(t.disconnect)},Ne=(t,e,n,o)=>{const r=[];for(let s=0;s<o.numberOfInputs;s+=1)r.push(new Set);const{nodes:i}=Wt(t);i.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},Re=(t,e,[n,o,r],i)=>{Se(t[o],[e,n,r],t=>t[0]===e&&t[1]===n,i)},Be=(t,e,[n,o],r)=>{Se(t,[e,n,o],t=>t[0]===e&&t[1]===n,r)},qe=(t,e,n,o)=>Pe(t[o],t=>t[0]===e&&t[1]===n),Fe=(t,e,n)=>Pe(t,t=>t[0]===e&&t[1]===n),Ve=(t,e,[n,o,r],i)=>{const s=t.get(n);void 0===s?t.set(n,new Set([[o,e,r]])):Se(s,[o,e,r],t=>t[0]===o&&t[1]===e,i)},Ue=(t,[e,n,o],r)=>{const i=t.get(e);void 0===i?t.set(e,new Set([[n,o]])):Se(i,[n,o],t=>t[0]===n,r)},Le=(t,e,n,o)=>{const r=Ut(t,e),i=Pe(r,t=>t[0]===n&&t[1]===o);return 0===r.size&&t.delete(e),i},ze=(t,e,n)=>{const o=Ut(t,e),r=Pe(o,t=>t[0]===n);return 0===o.size&&t.delete(e),r},We=(t,e,n,o)=>{const{activeInputs:r,passiveInputs:i}=Gt(e),{outputs:s}=Gt(t),a=oe(t),c=s=>{const a=Lt(e),c=Lt(t);if("active"===s){const s=Le(i,t,n,o);Re(r,t,s,!1),ke(c,a,n,o),Me(e)&&re(e,"active")}else if("passive"===s){const s=qe(r,t,n,o);Ve(i,o,s,!1),Te(c,a,n,o),Ae(e)&&Ee(e,r)}};Se(s,[e,n,o],t=>t[0]===e&&t[1]===n&&t[2]===o,!0)&&(a.add(c),Ae(t)?Re(r,t,[n,o,c],!0):Ve(i,o,[t,n,c],!0))},Ge=(t,e,n,o)=>{const{activeInputs:r}=Gt(e),{outputs:i}=Gt(t);Se(i,[e,n,o],t=>t[0]===e&&t[1]===n&&t[2]===o,!0)&&Re(r,t,[n,o,null],!0)},$e=(t,e,n)=>{const{activeInputs:o,passiveInputs:r}=ue(t.context,e),{outputs:i}=Gt(t),s=oe(t),a=i=>{const s=Lt(t),a=ce(e);if("active"===i){const e=ze(r,t,n);Be(o,t,e,!1),s.connect(a,n)}else if("passive"===i){const e=Fe(o,t,n);Ue(r,e,!1),s.disconnect(a,n)}};Se(i,[e,n],t=>t[0]===e&&t[1]===n,!0)&&(s.add(a),Ae(t)?Be(o,t,[n,a],!0):Ue(r,[t,n,a],!0))},Ye=(t,e,n)=>{const{activeInputs:o}=ue(t.context,e),{outputs:r}=Gt(t);Se(r,[e,n],t=>t[0]===e&&t[1]===n,!0)&&Be(o,t,[n,null],!0)},Qe=(t,e,n)=>{for(const o of t)if(o[0]===e&&o[1]===n)return t.delete(o),o;return null},He=(t,e,n,o)=>{const{activeInputs:r,passiveInputs:i}=Gt(e),s=Qe(r[o],t,n);if(null===s){const e=Le(i,t,n,o);return[e[2],"passive"]}return[s[2],"active"]},Xe=(t,e,n)=>{const{activeInputs:o,passiveInputs:r}=ue(t.context,e),i=Qe(o,t,n);if(null===i){const e=ze(r,t,n);return[e[1],"passive"]}return[i[2],"active"]},Je=(t,e,n,o)=>{const[r,i]=He(t,e,n,o);if(null!==r&&(Ce(t,r),"active"===i&&Te(Lt(t),Lt(e),n,o)),Ae(e)){const{activeInputs:t}=Gt(e);Ee(e,t)}},Ze=(t,e,n)=>{const[o,r]=Xe(t,e,n);null!==o&&(Ce(t,o),"active"===r&&Lt(t).disconnect(ce(e),n))},Ke=t=>{const e=Gt(t);for(const n of e.outputs)xe(n)?Je(t,...n):Ze(t,...n);e.outputs.clear()},tn=(t,e)=>{const n=Gt(t);for(const o of n.outputs)o[1]===e&&(xe(o)?Je(t,...o):Ze(t,...o),n.outputs.delete(o))},en=(t,e,n,o)=>{const r=Gt(t);return Array.from(r.outputs).filter(t=>t[0]===e&&(void 0===n||t[1]===n)&&(void 0===o||t[2]===o)).reduce((e,n)=>(xe(n)?Je(t,...n):Ze(t,...n),r.outputs.delete(n),e+1),0)},nn=(t,e,n,o,r,i,s,a)=>class extends be{constructor(e,n,o,r){super(o),this._context=e,this._nativeAudioNode=o;const i=Et(e);a(i)||!0===t(Ie,()=>Ie(i))||De(o),"active"===n&&dt.add(this),mt.set(this,o),kt.set(this,new Set),Ne(e,this,r,o)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,e=0,c=0){const u=Et(this._context),l=a(u);if(i(t)||s(t))throw n();if(we(t)){const o=Lt(t);try{const n=ke(this._nativeAudioNode,o,e,c);if(l||Me(this)?this._nativeAudioNode.disconnect(...n):Me(t)&&re(t,"active"),Oe(t)){const t=bt.get(o);if(void 0===t){const t=u.createGain();t.connect(n[0],0,n[2]),bt.set(o,new Map([[c,t]]))}else if(void 0===t.get(c)){const e=u.createGain();e.connect(n[0],0,n[2]),t.set(c,e)}}}catch(p){if(12===p.code)throw n();throw p}return r(this,t),l?Ge(this,t,e,c):We(this,t,e,c),t}const h=ce(t);if("playbackRate"===h.name)throw o();try{this._nativeAudioNode.connect(h,e),(l||Me(this))&&this._nativeAudioNode.disconnect(h,e)}catch(p){if(12===p.code)throw n();throw p}r(this,t),l?Ye(this,t,e):$e(this,t,e)}disconnect(t,o,r){if(void 0===t)Ke(this);else if("number"===typeof t){if(t<0||t>=this.numberOfOutputs)throw e();tn(this,t)}else{if(void 0!==o&&(o<0||o>=this.numberOfOutputs))throw e();if(we(t)&&void 0!==r&&(r<0||r>=t.numberOfInputs))throw e();if(0===en(this,t,o,r))throw n()}}},on=(t,e,n)=>{const o=Wt(t);o.params.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},rn=(t,e,n,o,r,i,s,a,c)=>(u,l,h,p=null,f=null)=>{const d=new pt["AutomationEventList"](h.defaultValue),y=l?t(d):null,m={get defaultValue(){return h.defaultValue},get maxValue(){return null===p?h.maxValue:p},get minValue(){return null===f?h.minValue:f},get value(){return h.value},set value(t){h.value=t,m.setValueAtTime(t,u.context.currentTime)},cancelAndHoldAtTime(t){if("function"===typeof h.cancelAndHoldAtTime)null===y&&d.flush(u.context.currentTime),d.add(e(t)),h.cancelAndHoldAtTime(t);else{const n=Array.from(d).pop();null===y&&d.flush(u.context.currentTime),d.add(e(t));const o=Array.from(d).pop();h.cancelScheduledValues(t),n!==o&&void 0!==o&&("exponentialRampToValue"===o.type?h.exponentialRampToValueAtTime(o.value,o.endTime):"linearRampToValue"===o.type?h.linearRampToValueAtTime(o.value,o.endTime):"setValue"===o.type?h.setValueAtTime(o.value,o.startTime):"setValueCurve"===o.type&&h.setValueCurveAtTime(o.values,o.startTime,o.duration))}return m},cancelScheduledValues(t){return null===y&&d.flush(u.context.currentTime),d.add(n(t)),h.cancelScheduledValues(t),m},exponentialRampToValueAtTime(t,e){return null===y&&d.flush(u.context.currentTime),d.add(o(t,e)),h.exponentialRampToValueAtTime(t,e),m},linearRampToValueAtTime(t,e){return null===y&&d.flush(u.context.currentTime),d.add(r(t,e)),h.linearRampToValueAtTime(t,e),m},setTargetAtTime(t,e,n){return null===y&&d.flush(u.context.currentTime),d.add(i(t,e,n)),h.setTargetAtTime(t,e,n),m},setValueAtTime(t,e){return null===y&&d.flush(u.context.currentTime),d.add(s(t,e)),h.setValueAtTime(t,e),m},setValueCurveAtTime(t,e,n){if(null!==c&&"webkitAudioContext"===c.name){const o=e+n,r=u.context.sampleRate,i=Math.ceil(e*r),s=Math.floor(o*r),c=s-i,l=new Float32Array(c);for(let a=0;a<c;a+=1){const o=(t.length-1)/n*((i+a)/r-e),s=Math.floor(o),c=Math.ceil(o);l[a]=s===c?t[s]:(1-(o-s))*t[s]+(1-(c-o))*t[c]}null===y&&d.flush(u.context.currentTime),d.add(a(l,e,n)),h.setValueCurveAtTime(l,e,n);const p=s/r;p<o&&m.setValueAtTime(l[l.length-1],p),m.setValueAtTime(t[t.length-1],o)}else null===y&&d.flush(u.context.currentTime),d.add(a(t,e,n)),h.setValueCurveAtTime(t,e,n);return m}};return _t.set(m,h),gt.set(m,u),on(u.context,m,y),m},sn=t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:o}=n;e.exponentialRampToValueAtTime(o,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:o}=n;e.linearRampToValueAtTime(o,t)}else if("setTarget"===n.type){const{startTime:t,target:o,timeConstant:r}=n;e.setTargetAtTime(o,t,r)}else if("setValue"===n.type){const{startTime:t,value:o}=n;e.setValueAtTime(o,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:o,values:r}=n;e.setValueCurveAtTime(r,o,t)}}}});class an{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((n,o)=>t.call(e,n,o,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const cn={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,outputChannelCount:void 0,parameterData:{},processorOptions:{}},un=t=>{const e=[];for(let n=0;n<t;n+=1)e.push(1);return e},ln=t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:un(t.numberOfOutputs)}),hn=(t,e,n,o,r,i,s)=>class extends s{constructor(s,a,c=cn){const u=Et(s),l=r(u),h=ln({...cn,...c}),p=Ct.get(u),f=void 0===p?void 0:p.get(a),d=n(u,l?null:s.baseLatency,i,a,f,h),y=l?e(a,h,f):null;super(s,"active",d,y);const m=[];if(d.parameters.forEach((e,n)=>{const o=t(this,l,e);m.push([n,o])}),this._nativeAudioWorkletNode=d,this._numberOfOutputs=0===c.numberOfOutputs?0:this._nativeAudioWorkletNode.numberOfOutputs,this._onprocessorerror=null,this._parameters=new an(m),"closed"!==s.state){const t=new o(s,{gain:0});try{this.connect(t).connect(s.destination)}catch(v){if("IndexSizeError"!==v.name)throw v}}}get numberOfOutputs(){return this._numberOfOutputs}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e=ie(this,t);this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function pn(t,e,n,o,r){if("function"===typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],o,r);else{const i=t.getChannelData(o);if(0===e[n].byteLength)e[n]=i.slice(r,r+128);else{const t=new Float32Array(i.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const fn=(t,e,n,o,r)=>{"function"===typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],o,r):0!==e[n].byteLength&&t.getChannelData(o).set(e[n],r)},dn=(t,e)=>{const n=[];for(let o=0;o<t;o+=1){const t=[],r="number"===typeof e?e:e[o];for(let e=0;e<r;e+=1)t.push(new Float32Array(128));n.push(t)}return n},yn=(t,e)=>{const n=Ut(Tt,t),o=Lt(e);return Ut(n,o)},mn=async(t,e,n,o,r)=>{const{length:i}=e,s=o.channelCount*o.numberOfInputs,a=o.outputChannelCount.reduce((t,e)=>t+e,0),c=0===a?null:n.createBuffer(a,i,e.sampleRate);if(void 0===r)throw new Error("Missing the processor constructor.");const u=Gt(t),l=await yn(n,t),h=dn(o.numberOfInputs,o.channelCount),p=dn(o.numberOfOutputs,o.outputChannelCount),f=Array.from(t.parameters.keys()).reduce((t,e)=>({...t,[e]:new Float32Array(128)}),{});for(let y=0;y<i;y+=128){for(let t=0;t<o.numberOfInputs;t+=1)for(let n=0;n<o.channelCount;n+=1)pn(e,h[t],n,n,y);void 0!==r.parameterDescriptors&&r.parameterDescriptors.forEach(({name:t},n)=>{pn(e,f,t,s+n,y)});for(let t=0;t<o.numberOfInputs;t+=1)for(let e=0;e<o.outputChannelCount[t];e+=1)0===p[t][e].byteLength&&(p[t][e]=new Float32Array(128));try{const t=h.map((t,e)=>0===u.activeInputs[e].size?[new Float32Array(0)]:t),e=l.process(t,p,f);if(null!==c)for(let n=0,r=0;n<o.numberOfOutputs;n+=1){for(let t=0;t<o.outputChannelCount[n];t+=1)fn(c,p[n],t,r+t,y);r+=o.outputChannelCount[n]}if(!e)break}catch(d){t.dispatchEvent(new ErrorEvent("processorerror",{error:d}));break}}return c},vn=(t,e,n,o,r,i,s,a,c,u)=>(l,h,p)=>{const f=new WeakMap,d=async(d,y)=>{let m=Lt(d),v=null;const _=zt(m,y);if(null===a){const e=h.outputChannelCount.reduce((t,e)=>t+e,0),r=o(y,{channelCount:Math.max(1,e),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,e)}),a=[];for(let t=0;t<d.numberOfOutputs;t+=1)a.push(n(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:h.outputChannelCount[t]}));const c=0===h.numberOfOutputs?[r]:a,u=i(y,{channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,gain:1});u.connect=t.bind(null,c),u.disconnect=s.bind(null,c),v=[r,a,u]}else _||(m=new a(y,l));if(f.set(y,null===v?m:v),null!==v){const[t,s,a]=v;if(void 0===p)throw new Error("Missing the processor constructor.");if(null===c)throw new Error("Missing the native OfflineAudioContext constructor.");const l=d.channelCount*d.numberOfInputs,f=void 0===p.parameterDescriptors?0:p.parameterDescriptors.length,m=new c(l+f,128*Math.ceil(d.context.length/128),y.sampleRate),_=[],g=[];for(let e=0;e<h.numberOfInputs;e+=1)_.push(i(m,{channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,gain:1})),g.push(o(m,{channelCount:h.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:h.channelCount}));const b=await Promise.all(Array.from(d.parameters.values()).map(async t=>{const e=r(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await fe(d.context,m,t,e.offset),e})),w=n(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,l+f)});for(let e=0;e<h.numberOfInputs;e+=1){_[e].connect(g[e]);for(let t=0;t<h.channelCount;t+=1)g[e].connect(w,t,e*h.channelCount+t)}for(const[e,n]of b.entries())n.connect(w,0,l+e),n.start(0);return w.connect(m.destination),Promise.all(_.map(t=>Yt(d,m,t))).then(()=>u(m)).then(async n=>{const o=e(y),r=await mn(d,n,y,h,p);null!==r&&(o.buffer=r,o.start(0)),o.connect(t);for(let e=0,i=0;e<d.numberOfOutputs;e+=1){const n=s[e];for(let o=0;o<h.outputChannelCount[e];o+=1)t.connect(n,i+o,o);i+=h.outputChannelCount[e]}return a})}if(_)for(const[t,e]of d.parameters.entries())await he(d.context,y,e,m.parameters.get(t));else for(const[t,e]of d.parameters.entries())await fe(d.context,y,e,m.parameters.get(t));return await Yt(d,y,m),m};return{render(t,e){const n=f.get(e);if(void 0!==n){const t=Array.isArray(n)?n[2]:n;return Promise.resolve(t)}return d(t,e)}}},_n=(t,e,n,o,r,i,s,a,c,u,l,h,p,f,d,y,m,v,_,g)=>class extends d{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(t,e,o){return new n({length:e,numberOfChannels:t,sampleRate:o})}createBufferSource(){return new o(this)}createChannelMerger(t=6){return new i(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new s(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(t=1){return new l(this,{maxDelayTime:t})}createDynamicsCompressor(){return new h(this)}createGain(){return new p(this)}createIIRFilter(t,e){return new f(this,{feedback:e,feedforward:t})}createOscillator(){return new y(this)}createPanner(){return new m(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new v(this,{...n,imag:e,real:t})}createStereoPanner(){return new _(this)}createWaveShaper(){return new g(this)}decodeAudioData(t,e,n){return u(this._nativeContext,t).then(t=>("function"===typeof e&&e(t),t)).catch(t=>{throw"function"===typeof n&&n(t),t})}},gn={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},bn=(t,e,n,o,r,i)=>class extends i{constructor(n,i=gn){const s=Et(n),a={...gn,...i},c=o(s,a),u=r(s),l=u?e():null;super(n,"passive",c,l),this._Q=t(this,u,c.Q,ne,ee),this._detune=t(this,u,c.detune,ne,ee),this._frequency=t(this,u,c.frequency,ne,ee),this._gain=t(this,u,c.gain,ne,ee),this._nativeBiquadFilterNode=c}get Q(){return this._Q}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,o){if(this._nativeBiquadFilterNode.getFrequencyResponse(t,e,o),t.length!==e.length||e.length!==o.length)throw n()}},wn=t=>()=>{const e=new WeakMap,n=async(n,o)=>{let r=Lt(n);const i=zt(r,o);if(!i){const e={Q:r.Q.value,channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,detune:r.detune.value,frequency:r.frequency.value,gain:r.gain.value,type:r.type};r=t(o,e)}return e.set(o,r),i?(await he(n.context,o,n.Q),await he(n.context,o,n.detune),await he(n.context,o,n.frequency),await he(n.context,o,n.gain)):(await fe(n.context,o,n.Q,r.Q),await fe(n.context,o,n.detune,r.detune),await fe(n.context,o,n.frequency,r.frequency),await fe(n.context,o,n.gain,r.gain)),await Yt(n,o,r),r};return{render(t,o){const r=e.get(o);return void 0!==r?Promise.resolve(r):n(t,o)}}},xn=t=>(e,n)=>{const o=At.get(e);if(void 0!==o)return o;const r=t.get(e);if(void 0!==r)return r;const i=n();return i instanceof Promise?(t.set(e,i),i.then(n=>(t.delete(e),At.set(e,n),n))):(At.set(e,i),i)},On={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},kn=(t,e,n,o)=>class extends o{constructor(o,r=On){const i=Et(o),s={...On,...r},a=e(i,s),c=n(i)?t():null;super(o,"passive",a,c)}},Cn=t=>()=>{const e=new WeakMap,n=async(n,o)=>{let r=Lt(n);const i=zt(r,o);if(!i){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,numberOfInputs:r.numberOfInputs};r=t(o,e)}return e.set(o,r),await Yt(n,o,r),r};return{render(t,o){const r=e.get(o);return void 0!==r?Promise.resolve(r):n(t,o)}}},Tn={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Sn=t=>({...t,channelCount:t.numberOfOutputs}),An=(t,e,n,o)=>class extends o{constructor(o,r=Tn){const i=Et(o),s=Sn({...Tn,...r}),a=e(i,s),c=n(i)?t():null;super(o,"passive",a,c)}},Mn=t=>()=>{const e=new WeakMap,n=async(n,o)=>{let r=Lt(n);const i=zt(r,o);if(!i){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,numberOfOutputs:r.numberOfOutputs};r=t(o,e)}return e.set(o,r),await Yt(n,o,r),r};return{render(t,o){const r=e.get(o);return void 0!==r?Promise.resolve(r):n(t,o)}}},Pn=t=>(e,n,o=0,r=0)=>{const i=e[o];if(void 0===i)throw t();return je(n)?i.connect(n,0,r):i.connect(n,0)},En={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},In=(t,e,n,o,r)=>class extends r{constructor(r,i=En){const s=Et(r),a={...En,...i},c=n(s,a),u=o(s),l=u?e():null;super(r,"passive",c,l),this._constantSourceNodeRenderer=l,this._nativeConstantSourceNode=c,this._offset=t(this,u,c.offset,ne,ee),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e=ie(this,t);this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer)this._constantSourceNodeRenderer.start=t;else{re(this,"active");const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),setTimeout(()=>re(this,"passive"),1e3)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}},jn=t=>()=>{const e=new WeakMap;let n=null,o=null;const r=async(r,i)=>{let s=Lt(r);const a=zt(s,i);if(!a){const e={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,offset:s.offset.value};s=t(i,e),null!==n&&s.start(n),null!==o&&s.stop(o)}return e.set(i,s),a?await he(r.context,i,r.offset):await fe(r.context,i,r.offset,s.offset),await Yt(r,i,s),s};return{set start(t){n=t},set stop(t){o=t},render(t,n){const o=e.get(n);return void 0!==o?Promise.resolve(o):r(t,n)}}},Dn=t=>e=>(t[0]=e,t[0]),Nn={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Rn=(t,e,n,o)=>class extends o{constructor(o,r=Nn){const i=Et(o),s={...Nn,...r},a=e(i,s),c=n(i),u=c?t():null;super(o,"passive",a,u),this._isBufferNullified=!1,this._nativeConvolverNode=a}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,t.sampleRate),this._isBufferNullified=!0}else this._isBufferNullified=!1}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}},Bn=t=>()=>{const e=new WeakMap,n=async(n,o)=>{let r=Lt(n);const i=zt(r,o);if(!i){const e={buffer:r.buffer,channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,disableNormalization:!r.normalize};r=t(o,e)}return e.set(o,r),await Yt(n,o,r),r};return{render(t,o){const r=e.get(o);return void 0!==r?Promise.resolve(r):n(t,o)}}},qn=(t,e)=>(n,o,r)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,o,r)}catch(i){if("IndexSizeError"===i.name||"SyntaxError"===i.name)throw t();throw i}},Fn=()=>{try{return new DOMException("","DataCloneError")}catch(t){return t.code=25,t.name="DataCloneError",t}},Vn=t=>{const{port1:e}=new MessageChannel;e.postMessage(t,[t])},Un=(t,e,n,o,r,i,s,a,c,u,l,h,p)=>(f,d)=>{const y=i(f)?f:Et(f);if(Ot.has(d)){const t=n();return Promise.reject(t)}try{Ot.add(d)}catch(m){}if(e(u,()=>u(y))){const n="closed"===y.state&&null!==r&&s(y)?new r(1,1,y.sampleRate):y,o=n.decodeAudioData(d).catch(t=>{if(t instanceof DOMException&&"NotSupportedError"===t.name)throw new TypeError;throw t});return o.then(n=>(e(c,()=>c(n))?e(a,()=>a(n))||h(n):(p(n),h(n)),t.add(n),n))}return new Promise((e,n)=>{const r=()=>{try{Vn(d)}catch(m){}},i=t=>{n(t),r()};try{y.decodeAudioData(d,n=>{"function"!==typeof n.copyFromChannel&&(l(n),Zt(n)),t.add(n),r(),e(n)},t=>{i(null===t?o():t)})}catch(s){i(s)}})},Ln={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},zn=(t,e,n,o,r)=>class extends r{constructor(r,i=Ln){const s=Et(r),a={...Ln,...i},c=n(s,a),u=o(s),l=u?e(a.maxDelayTime):null;super(r,"passive",c,l),this._delayTime=t(this,u,c.delayTime,a.maxDelayTime,0)}get delayTime(){return this._delayTime}},Wn=t=>e=>{const n=new WeakMap,o=async(o,r)=>{let i=Lt(o);const s=zt(i,r);if(!s){const n={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,delayTime:i.delayTime.value,maxDelayTime:e};i=t(r,n)}return n.set(r,i),s?await he(o.context,r,o.delayTime):await fe(o.context,r,o.delayTime,i.delayTime),await Yt(o,r,i),i};return{render(t,e){const r=n.get(e);return void 0!==r?Promise.resolve(r):o(t,e)}}},Gn=t=>"delayTime"in t,$n=(t,e,n,o)=>function r(i,s){const a=we(s)?s:o(t,s);if(Gn(a))return!0;if(i===a)throw e();const{outputs:c}=n(a);for(const t of c)if(r(i,t[0]))return!0;return!1},Yn=(t,e,n)=>{const o=e[n];if(void 0===o)throw t();return o},Qn=t=>(e,n,o,r=0)=>void 0===n?e.forEach(t=>t.disconnect()):"number"===typeof n?Yn(t,e,n).disconnect():je(n)?void 0===o?e.forEach(t=>t.disconnect(n)):void 0===r?Yn(t,e,o).disconnect(n,0):Yn(t,e,o).disconnect(n,0,r):void 0===o?e.forEach(t=>t.disconnect(n)):Yn(t,e,o).disconnect(n,0),Hn={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Xn=(t,e,n,o,r,i)=>class extends i{constructor(o,i=Hn){const s=Et(o),a={...Hn,...i},c=n(s,a),u=r(s),l=u?e():null;super(o,"passive",c,l),this._attack=t(this,u,c.attack,1,0),this._knee=t(this,u,c.knee,40,0),this._nativeDynamicsCompressorNode=c,this._ratio=t(this,u,c.ratio,20,1),this._release=t(this,u,c.release,1,0),this._threshold=t(this,u,c.threshold,0,-100)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,o()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,o()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"===typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Jn=t=>()=>{const e=new WeakMap,n=async(n,o)=>{let r=Lt(n);const i=zt(r,o);if(!i){const e={attack:r.attack.value,channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,knee:r.knee.value,ratio:r.ratio.value,release:r.release.value,threshold:r.threshold.value};r=t(o,e)}return e.set(o,r),i?(await he(n.context,o,n.attack),await he(n.context,o,n.knee),await he(n.context,o,n.ratio),await he(n.context,o,n.release),await he(n.context,o,n.threshold)):(await fe(n.context,o,n.attack,r.attack),await fe(n.context,o,n.knee,r.knee),await fe(n.context,o,n.ratio,r.ratio),await fe(n.context,o,n.release,r.release),await fe(n.context,o,n.threshold,r.threshold)),await Yt(n,o,r),r};return{render(t,o){const r=e.get(o);return void 0!==r?Promise.resolve(r):n(t,o)}}},Zn=()=>{try{return new DOMException("","EncodingError")}catch(t){return t.code=0,t.name="EncodingError",t}},Kn=t=>(e,n)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e.currentTime*e.sampleRate)}},currentTime:{configurable:!0,get(){return e.currentTime}}});try{return n()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}},to=t=>async e=>{try{const t=await fetch(e);if(t.ok)return t.text()}catch(n){}throw t()},eo={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},no=(t,e,n,o,r)=>class extends r{constructor(r,i=eo){const s=Et(r),a={...eo,...i},c=n(s,a),u=o(s),l=u?e():null;super(r,"passive",c,l),this._gain=t(this,u,c.gain,ne,ee)}get gain(){return this._gain}},oo=t=>()=>{const e=new WeakMap,n=async(n,o)=>{let r=Lt(n);const i=zt(r,o);if(!i){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:r.gain.value};r=t(o,e)}return e.set(o,r),i?await he(n.context,o,n.gain):await fe(n.context,o,n.gain,r.gain),await Yt(n,o,r),r};return{render(t,o){const r=e.get(o);return void 0!==r?Promise.resolve(r):n(t,o)}}},ro=(t,e,n)=>o=>{if("closed"===o.state&&null!==e&&"webkitAudioContext"!==e.name){if(!t(o)){const t=wt.get(o);if(void 0!==t)return t;const n=new e;return wt.set(o,n),n}{const t=wt.get(o);if(void 0!==t)return t;if(null!==n){const t=new n(1,1,44100);return wt.set(o,t),t}}}return null},io=()=>{try{return new DOMException("","InvalidAccessError")}catch(t){return t.code=15,t.name="InvalidAccessError",t}},so=t=>{t.getFrequencyResponse=(e=>(n,o,r)=>{if(n.length!==o.length||o.length!==r.length)throw io();return e.call(t,n,o,r)})(t.getFrequencyResponse)},ao={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},co=(t,e,n,o)=>class extends o{constructor(o,r){const i=Et(o),s=n(i),a={...ao,...r},c=t(i,s?null:o.baseLatency,a),u=s?e(a.feedback,a.feedforward):null;super(o,"passive",c,u),so(c),this._nativeIIRFilterNode=c}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}},uo=(t,e,n,o,r,i,s,a,c,u,l)=>{const h=u.length;let p=a;for(let f=0;f<h;f+=1){let a=n[0]*u[f];for(let e=1;e<r;e+=1){const o=p-e&c-1;a+=n[e]*i[o],a-=t[e]*s[o]}for(let t=r;t<o;t+=1)a+=n[t]*i[p-t&c-1];for(let n=r;n<e;n+=1)a-=t[n]*s[p-n&c-1];i[p]=u[f],s[p]=a,p=p+1&c-1,l[f]=a}return p},lo=(t,e,n,o)=>{const r=n.length,i=o.length,s=Math.min(r,i);if(1!==n[0]){for(let t=0;t<r;t+=1)o[t]/=n[0];for(let t=1;t<i;t+=1)n[t]/=n[0]}const a=32,c=new Float32Array(a),u=new Float32Array(a),l=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),h=t.numberOfChannels;for(let p=0;p<h;p+=1){const e=t.getChannelData(p),h=l.getChannelData(p);c.fill(0),u.fill(0),uo(n,r,o,i,s,c,u,0,a,e,h)}return l},ho=(t,e,n,o)=>(r,i)=>{const s=new WeakMap,a=async(a,c)=>{let u=Lt(a),l=null;const h=zt(u,c);if(void 0===c.createIIRFilter?l=t(c):h||(u=e(c,t=>t.createIIRFilter(i,r))),s.set(c,null===l?u:l),null!==l){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(a.context.destination.channelCount,a.context.length,c.sampleRate);await Yt(a,t,t.destination);const e=await o(t);return l.buffer=lo(e,c,r,i),l.start(0),l}return await Yt(a,c,u),u};return{render(t,e){const n=s.get(e);return void 0!==n?Promise.resolve(n):a(t,e)}}},po=(t,e)=>n=>{const o=t.get(n);return e(o)||e(n)},fo=(t,e)=>n=>t.has(n)||e(n),yo=(t,e)=>n=>t.has(n)||e(n),mo=(t,e)=>n=>{const o=t.get(n);return e(o)||e(n)},vo=t=>e=>null!==t&&e instanceof t,_o=t=>e=>null!==t&&"function"===typeof t.AudioNode&&e instanceof t.AudioNode,go=t=>e=>null!==t&&"function"===typeof t.AudioParam&&e instanceof t.AudioParam,bo=(t,e)=>n=>t(n)||e(n),wo=t=>e=>null!==t&&e instanceof t,xo=t=>null!==t&&t.isSecureContext,Oo=(t,e,n,o)=>class extends o{constructor(o,r){const i=Et(o);if(n(i))throw e();const s=t(i,r);super(o,"active",s,null),this._mediaElement=r.mediaElement,this._nativeMediaElementAudioSourceNode=s}get mediaElement(){return void 0===this._nativeMediaElementAudioSourceNode.mediaElement?this._mediaElement:this._nativeMediaElementAudioSourceNode.mediaElement}},ko=(t,e,n,o)=>class extends o{constructor(o,r){const i=Et(o);if(n(i))throw e();const s=t(i,r);super(o,"active",s,null),this._nativeMediaStreamAudioSourceNode=s}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},Co=(t,e,n,o)=>class extends o{constructor(o,r){const i=Et(o);if(n(i))throw e();const s=t(i,r);super(o,"active",s,null)}},To=(t,e,n,o,r)=>class extends o{constructor(t={}){if(null===r)throw new Error("Missing the native AudioContext constructor.");const o=new r(t);if(null===o)throw n();if(!ye(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&o.sampleRate!==t.sampleRate)throw e();super(o,o.destination.channelCount);const{latencyHint:i}=t,{sampleRate:s}=o;if(this._baseLatency="number"===typeof o.baseLatency?o.baseLatency:"balanced"===i?512/s:"interactive"===i||void 0===i?256/s:"playback"===i?1024/s:128*Math.max(2,Math.min(128,Math.round(i*s/128)))/s,this._nativeAudioContext=o,this._state=null,"running"===o.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),o.removeEventListener("statechange",t)};o.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw t()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close())}resume(){return"suspended"===this._state?new Promise((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)}):this._nativeAudioContext.resume().catch(e=>{if(void 0===e||15===e.code)throw t();throw e})}suspend(){return this._nativeAudioContext.suspend().catch(e=>{if(void 0===e)throw t();throw e})}},So=(t,e)=>class extends be{constructor(n,o){super(n),this._nativeContext=n,xt.set(this,n);const r=n.sampleRate;Object.defineProperty(n,"sampleRate",{get:()=>r}),this._destination=new t(this,o),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e=ie(this,t);this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Ao=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return void 0!==n&&(n.catch(()=>{}),!0)}catch(n){}return!1},Mo={numberOfChannels:1},Po=(t,e,n,o,r)=>class extends o{constructor(e){const{length:o,numberOfChannels:r,sampleRate:i}={...Mo,...e},s=n(r,o,i);t(Ao,()=>Ao(s))||s.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(s.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(s,r),this._length=o,this._nativeOfflineAudioContext=s,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(e()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).then(t=>(this._state=null,t)).catch(t=>{throw this._state=null,t}))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout(()=>this._waitForThePromiseToSettle(t))}},Eo=(t,e,n)=>{const o=e[n];void 0!==o&&o!==t[n]&&(t[n]=o)},Io=(t,e)=>{Eo(t,e,"channelCount"),Eo(t,e,"channelCountMode"),Eo(t,e,"channelInterpretation")},jo=t=>"function"===typeof t.getFloatTimeDomainData,Do=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const o=Math.max(n.length,t.fftSize);for(let t=0;t<o;t+=1)e[t]=.0078125*(n[t]-128);return e}},No=(t,e,n)=>(o,r)=>{const i=n(o,t=>t.createAnalyser());if(Io(i,r),!(r.maxDecibels>r.minDecibels))throw e();return Eo(i,r,"fftSize"),Eo(i,r,"maxDecibels"),Eo(i,r,"minDecibels"),Eo(i,r,"smoothingTimeConstant"),t(jo,()=>jo(i))||Do(i),i},Ro=t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Bo=(t,e,n)=>{const o=e[n];void 0!==o&&o!==t[n].value&&(t[n].value=o)},qo=t=>{t.start=(e=>{let n=!1;return(o=0,r=0,i)=>{if(n)throw Pt();e.call(t,o,r,i),n=!0}})(t.start)},Fo=(t,e)=>{let n=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;t.start=((r,i)=>(s=0,a=0,c=Number.POSITIVE_INFINITY)=>{if(r.call(t,s,a),c>=0&&c<Number.POSITIVE_INFINITY){const r=Math.max(s,e.currentTime),a=c/t.playbackRate.value;n=r+a,i.call(t,Math.min(n,o))}})(t.start,t.stop),t.stop=(r=>(i=0)=>{o=Math.max(i,e.currentTime),r.call(t,Math.min(n,o))})(t.stop)},Vo=t=>{t.start=(e=>(n=0,o=0,r)=>{if("number"===typeof r&&r<0||o<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,o,r)})(t.start)},Uo=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},Lo=(t,e,n,o,r,i,s,a,c,u)=>(l,h={})=>{const p=e(l,t=>t.createBufferSource());return Io(p,h),Bo(p,h,"playbackRate"),Eo(p,h,"buffer"),Eo(p,h,"loop"),Eo(p,h,"loopEnd"),Eo(p,h,"loopStart"),t(n,()=>n(l))||qo(p),t(o,o)||Fo(p,l),t(r,()=>r(l))||c(p),t(i,()=>i(l))||Vo(p),t(s,()=>s(l))||u(p,l),t(a,()=>a(l))||Uo(p),p},zo=t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,Wo=(t,e,n)=>{const o=t.destination;return o.channelCount!==e&&(o.channelCount=e),n&&"explicit"!==o.channelCountMode&&(o.channelCountMode="explicit"),0===o.maxChannelCount&&Object.defineProperty(o,"maxChannelCount",{get:()=>o.channelCount}),o},Go=t=>(e,n)=>{const o=t(e);return n(null!==o?o:e)},$o=t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,Yo=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},Qo=(t,e,n,o,r)=>(i,s,a,c,u,l)=>{if(null!==a)try{const n=e(i,t=>r(t)&&0!==l.numberOfInputs&&0===l.numberOfOutputs?new a(t,c,{...l,numberOfOutputs:1,outputChannelCount:[1],parameterData:{...l.parameterData,hasNoOutput:1}}):new a(t,c,l)),o=new Map;let s=null;return Object.defineProperties(n,{channelCount:{get:()=>l.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>s,set:t=>{"function"===typeof s&&n.removeEventListener("processorerror",s),s="function"===typeof t?t:null,"function"===typeof s&&n.addEventListener("processorerror",s)}}}),n.addEventListener=(t=>(...e)=>{if("processorerror"===e[0]){const t="function"===typeof e[1]?e[1]:"object"===typeof e[1]&&null!==e[1]&&"function"===typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==t){const n=o.get(e[1]);void 0!==n?e[1]=n:(e[1]=n=>{t(new ErrorEvent(e[0],{...n,error:new Error}))},o.set(t,e[1]))}}return t.call(n,e[0],e[1],e[2])})(n.addEventListener),n.removeEventListener=(t=>(...e)=>{if("processorerror"===e[0]){const t=o.get(e[1]);void 0!==t&&(o.delete(e[1]),e[1]=t)}return t.call(n,e[0],e[1],e[2])})(n.removeEventListener),n}catch(h){if(11===h.code)throw o();throw h}if(void 0===u)throw o();return Yo(l),n(i,s,u,l)},Ho=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Xo=t=>new Promise((e,n)=>{const{port1:o,port2:r}=new MessageChannel;o.onmessage=({data:t})=>{o.close(),r.close(),e(t)},o.onmessageerror=({data:t})=>{o.close(),r.close(),n(t)},r.postMessage(t)}),Jo=async(t,e)=>{const n=await Xo(e);return new t(n)},Zo=(t,e,n,o)=>{let r=Tt.get(t);void 0===r&&(r=new WeakMap,Tt.set(t,r));const i=Jo(n,o);return r.set(e,i),i},Ko=(t,e,n,o,r,i,s,a,c,u,l)=>(h,p,f,d)=>{if(0===d.numberOfInputs&&0===d.numberOfOutputs)throw c();if(void 0!==d.outputChannelCount){if(d.outputChannelCount.length!==d.numberOfOutputs)throw e();if(d.outputChannelCount.some(t=>t<1))throw c()}if("explicit"!==d.channelCountMode)throw c();const y=d.channelCount*d.numberOfInputs,m=d.outputChannelCount.reduce((t,e)=>t+e,0),v=void 0===f.parameterDescriptors?0:f.parameterDescriptors.length;if(y+v>6||m>6)throw c();const _=new MessageChannel,g=[],b=[];for(let t=0;t<d.numberOfInputs;t+=1)g.push(s(h,{channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,gain:1})),b.push(r(h,{channelCount:d.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:d.channelCount}));const w=[];if(void 0!==f.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:o}of f.parameterDescriptors){const r=i(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==d.parameterData[o]?d.parameterData[o]:void 0===t?0:t});Object.defineProperties(r.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?ne:e},minValue:{get:()=>void 0===n?ee:n}}),w.push(r)}const x=o(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+v)}),O=Ho(p,h.sampleRate),k=a(h,O,y+v,Math.max(1,m)),C=r(h,{channelCount:Math.max(1,m),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,m)}),T=[];for(let t=0;t<d.numberOfOutputs;t+=1)T.push(o(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:d.outputChannelCount[t]}));for(let t=0;t<d.numberOfInputs;t+=1){g[t].connect(b[t]);for(let e=0;e<d.channelCount;e+=1)b[t].connect(x,e,t*d.channelCount+e)}const S=new an(void 0===f.parameterDescriptors?[]:f.parameterDescriptors.map(({name:t},e)=>{const n=w[e];return n.connect(x,0,y+e),n.start(0),[t,n.offset]}));x.connect(k),d.numberOfOutputs>0&&k.connect(C);for(let t=0,e=0;t<d.numberOfOutputs;t+=1){const n=T[t];for(let o=0;o<d.outputChannelCount[t];o+=1)C.connect(n,e+o,o);e+=d.outputChannelCount[t]}let A=d.channelInterpretation,M=null;const P=0===d.numberOfOutputs?[k]:T,E={get bufferSize(){return O},get channelCount(){return d.channelCount},set channelCount(t){throw n()},get channelCountMode(){return d.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return A},set channelInterpretation(t){for(const e of g)e.channelInterpretation=t;A=t},get context(){return k.context},get inputs(){return g},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get onprocessorerror(){return M},set onprocessorerror(t){"function"===typeof M&&E.removeEventListener("processorerror",M),M="function"===typeof t?t:null,"function"===typeof M&&E.addEventListener("processorerror",M)},get parameters(){return S},get port(){return _.port2},addEventListener(...t){return k.addEventListener(t[0],t[1],t[2])},connect:t.bind(null,P),disconnect:u.bind(null,P),dispatchEvent(...t){return k.dispatchEvent(t[0])},removeEventListener(...t){return k.removeEventListener(t[0],t[1],t[2])}},I=new Map;_.port1.addEventListener=(t=>(...e)=>{if("message"===e[0]){const t="function"===typeof e[1]?e[1]:"object"===typeof e[1]&&null!==e[1]&&"function"===typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==t){const n=I.get(e[1]);void 0!==n?e[1]=n:(e[1]=e=>{l(h,()=>t(e))},I.set(t,e[1]))}}return t.call(_.port1,e[0],e[1],e[2])})(_.port1.addEventListener),_.port1.removeEventListener=(t=>(...e)=>{if("message"===e[0]){const t=I.get(e[1]);void 0!==t&&(I.delete(e[1]),e[1]=t)}return t.call(_.port1,e[0],e[1],e[2])})(_.port1.removeEventListener);let j=null;Object.defineProperty(_.port1,"onmessage",{get:()=>j,set:t=>{"function"===typeof j&&_.port1.removeEventListener("message",j),j="function"===typeof t?t:null,"function"===typeof j&&(_.port1.addEventListener("message",j),_.port1.start())}}),f.prototype.port=_.port1;let D=null;const N=Zo(h,E,f,d);N.then(t=>D=t);const R=dn(d.numberOfInputs,d.channelCount),B=dn(d.numberOfOutputs,d.outputChannelCount),q=void 0===f.parameterDescriptors?[]:f.parameterDescriptors.reduce((t,{name:e})=>({...t,[e]:new Float32Array(128)}),{});let F=!0;return k.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==D)for(let o=0;o<O;o+=128){for(let e=0;e<d.numberOfInputs;e+=1)for(let n=0;n<d.channelCount;n+=1)pn(t,R[e],n,n,o);void 0!==f.parameterDescriptors&&f.parameterDescriptors.forEach(({name:e},n)=>{pn(t,q,e,y+n,o)});for(let t=0;t<d.numberOfInputs;t+=1)for(let e=0;e<d.outputChannelCount[t];e+=1)0===B[t][e].byteLength&&(B[t][e]=new Float32Array(128));try{const t=R.map((t,e)=>{const n=bt.get(E);return void 0===n||void 0===n.get(e)?[new Float32Array(0)]:t}),n=l(h,()=>D.process(t,B,q));F=n;for(let r=0,i=0;r<d.numberOfOutputs;r+=1){for(let t=0;t<d.outputChannelCount[r];t+=1)fn(e,B[r],t,i+t,o);i+=d.outputChannelCount[r]}}catch(n){F=!1,E.dispatchEvent(new ErrorEvent("processorerror",{error:n}))}if(!F){k.onaudioprocess=null;break}}},E},tr=t=>(e,n)=>{const o=t(e,t=>t.createBiquadFilter());return Io(o,n),Bo(o,n,"Q"),Bo(o,n,"detune"),Bo(o,n,"frequency"),Bo(o,n,"gain"),Eo(o,n,"type"),o},er=(t,e)=>(n,o)=>{const r=t(n,t=>t.createChannelMerger(o.numberOfInputs));Io(r,o),1!==r.channelCount&&"explicit"!==r.channelCountMode&&e(n,r);try{r.channelCount=void 0===o.numberOfInputs?6:o.numberOfInputs,e(n,r)}catch(i){}return r},nr=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Pt()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw Pt()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw Pt()}})},or=t=>(e,n)=>{const o=t(e,t=>t.createChannelSplitter(n.numberOfOutputs));return Io(o,n),nr(o),o},rr=(t,e,n,o,r)=>(i,s)=>{if(void 0===i.createConstantSource)return n(i,s);const a=e(i,t=>t.createConstantSource());return Io(a,s),Bo(a,s,"offset"),t(o,()=>o(i))||Vo(a),t(r,()=>r(i))||Uo(a),a},ir=(t,e)=>(t.connect=(t,n=0,o=0)=>je(t)?(e.connect.call(e,t,n,o),t):e.connect.call(e,t,n),t.disconnect=function(){e.disconnect.apply(e,arguments)},t),sr=(t,e)=>(n,{offset:o,...r})=>{const i=t(n),s=n.createBuffer(1,2,n.sampleRate),a=e(n,{...r,gain:o}),c=s.getChannelData(0);c[0]=1,c[1]=1,i.buffer=s,i.loop=!0,i.connect(a);const u={get bufferSize(){},get channelCount(){return a.channelCount},set channelCount(t){a.channelCount=t},get channelCountMode(){return a.channelCountMode},set channelCountMode(t){a.channelCountMode=t},get channelInterpretation(){return a.channelInterpretation},set channelInterpretation(t){a.channelInterpretation=t},get context(){return a.context},get inputs(){},get numberOfInputs(){return i.numberOfInputs},get numberOfOutputs(){return a.numberOfOutputs},get offset(){return a.gain},get onended(){return i.onended},set onended(t){i.onended=t},addEventListener(...t){return i.addEventListener(t[0],t[1],t[2])},dispatchEvent(...t){return i.dispatchEvent(t[0])},removeEventListener(...t){return i.removeEventListener(t[0],t[1],t[2])},start(t=0){i.start.call(i,t)},stop(t=0){i.stop.call(i,t)}};return ir(u,a)},ar=(t,e)=>(n,o)=>{const r=t(n,t=>t.createConvolver());if(Io(r,o),o.disableNormalization===r.normalize&&(r.normalize=!o.disableNormalization),Eo(r,o,"buffer"),2!==o.channelCount)throw e();if(Object.defineProperty(r,"channelCount",{get:()=>o.channelCount,set:t=>{if(t!==o.channelCount)throw e()}}),"clamped-max"!==o.channelCountMode)throw e();return Object.defineProperty(r,"channelCountMode",{get:()=>o.channelCountMode,set:t=>{if(t!==o.channelCountMode)throw e()}}),r},cr=t=>(e,n)=>{const o=t(e,t=>t.createDelay(n.maxDelayTime));return Io(o,n),Bo(o,n,"delayTime"),o},ur=(t,e)=>(n,o)=>{const r=t(n,t=>t.createDynamicsCompressor());if(Io(r,o),o.channelCount>2)throw e();if("max"===o.channelCountMode)throw e();return Bo(r,o,"attack"),Bo(r,o,"knee"),Bo(r,o,"ratio"),Bo(r,o,"release"),Bo(r,o,"threshold"),r},lr=t=>(e,n)=>{const o=t(e,t=>t.createGain());return Io(o,n),Bo(o,n,"gain"),o},hr=(t,e)=>(n,o,r)=>{if(void 0===n.createIIRFilter)return e(n,o,r);const i=t(n,t=>t.createIIRFilter(r.feedforward,r.feedback));return Io(i,r),i};function pr(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function fr(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function dr(t,e){let n=[0,0];for(let o=t.length-1;o>=0;o-=1)n=fr(n,e),n[0]+=t[o];return n}const yr=(t,e,n,o)=>(r,i,{channelCount:s,channelCountMode:a,channelInterpretation:c,feedback:u,feedforward:l})=>{const h=Ho(i,r.sampleRate),p=u.length,f=l.length,d=Math.min(p,f);if(0===u.length||u.length>20)throw o();if(0===u[0])throw e();if(0===l.length||l.length>20)throw o();if(0===l[0])throw e();if(1!==u[0]){for(let t=0;t<f;t+=1)l[t]/=u[0];for(let t=1;t<p;t+=1)u[t]/=u[0]}const y=n(r,h,s,s);y.channelCount=s,y.channelCountMode=a,y.channelInterpretation=c;const m=32,v=[],_=[],g=[];for(let t=0;t<s;t+=1){v.push(0);const t=new Float32Array(m),e=new Float32Array(m);t.fill(0),e.fill(0),_.push(t),g.push(e)}y.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,o=e.numberOfChannels;for(let r=0;r<o;r+=1){const t=e.getChannelData(r),o=n.getChannelData(r);v[r]=uo(u,p,l,f,d,_[r],g[r],v[r],m,t,o)}};const b=r.sampleRate/2,w={get bufferSize(){return h},get channelCount(){return y.channelCount},set channelCount(t){y.channelCount=t},get channelCountMode(){return y.channelCountMode},set channelCountMode(t){y.channelCountMode=t},get channelInterpretation(){return y.channelInterpretation},set channelInterpretation(t){y.channelInterpretation=t},get context(){return y.context},get inputs(){return[y]},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},addEventListener(...t){return y.addEventListener(t[0],t[1],t[2])},dispatchEvent(...t){return y.dispatchEvent(t[0])},getFrequencyResponse(e,n,o){if(e.length!==n.length||n.length!==o.length)throw t();const r=e.length;for(let t=0;t<r;t+=1){const r=-Math.PI*(e[t]/b),i=[Math.cos(r),Math.sin(r)],s=dr(l,i),a=dr(u,i),c=pr(s,a);n[t]=Math.sqrt(c[0]*c[0]+c[1]*c[1]),o[t]=Math.atan2(c[1],c[0])}},removeEventListener(...t){return y.removeEventListener(t[0],t[1],t[2])}};return ir(w,y)},mr=t=>(e,n)=>t(e,t=>t.createMediaElementSource(n.mediaElement)),vr=(t,e)=>(n,{mediaStream:o})=>{const r=o.getAudioTracks(),i=e(n,t=>{const e=r.sort((t,e)=>t.id<e.id?-1:t.id>e.id?1:0).slice(0,1);return t.createMediaStreamSource(new MediaStream(e))});if(0===r.length)throw t();return Object.defineProperty(i,"mediaStream",{value:o}),i},_r=(t,e)=>(n,{mediaStreamTrack:o})=>"function"===typeof n.createMediaStreamTrackSource?e(n,t=>t.createMediaStreamTrackSource(o)):e(n,e=>{const n=new MediaStream([o]),r=e.createMediaStreamSource(n);if("audio"!==o.kind)throw t();return r}),gr=t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,br=(t,e,n,o,r,i)=>(s,a)=>{const c=e(s,t=>t.createOscillator());return Io(c,a),Bo(c,a,"detune"),Bo(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):Eo(c,a,"type"),t(n,()=>n(s))||Vo(c),t(o,()=>o(s))||i(c,s),t(r,()=>r(s))||Uo(c),c},wr=(t,e)=>(n,o)=>{const r=t(n,t=>t.createPanner());return void 0===r.orientationX?e(n,o):(Io(r,o),Bo(r,o,"orientationX"),Bo(r,o,"orientationY"),Bo(r,o,"orientationZ"),Bo(r,o,"positionX"),Bo(r,o,"positionY"),Bo(r,o,"positionZ"),Eo(r,o,"coneInnerAngle"),Eo(r,o,"coneOuterAngle"),Eo(r,o,"coneOuterGain"),Eo(r,o,"distanceModel"),Eo(r,o,"maxDistance"),Eo(r,o,"panningModel"),Eo(r,o,"refDistance"),Eo(r,o,"rolloffFactor"),r)},xr=(t,e,n,o,r,i,s)=>(a,{coneInnerAngle:c,coneOuterAngle:u,coneOuterGain:l,distanceModel:h,maxDistance:p,orientationX:f,orientationY:d,orientationZ:y,panningModel:m,positionX:v,positionY:_,positionZ:g,refDistance:b,rolloffFactor:w,...x})=>{const O=e(a,t=>t.createPanner());if(x.channelCount>2)throw s();if("max"===x.channelCountMode)throw s();Io(O,x);const k={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},C=n(a,{...k,channelInterpretation:"speakers",numberOfInputs:6}),T=o(a,{...x,gain:1}),S=o(a,{...k,gain:1}),A=o(a,{...k,gain:0}),M=o(a,{...k,gain:0}),P=o(a,{...k,gain:0}),E=o(a,{...k,gain:0}),I=o(a,{...k,gain:0}),j=r(a,256,6,0),D=i(a,{...k,curve:new Float32Array([1,1]),oversample:"none"});let N=[1,0,0],R=[0,0,0];j.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0]];e.some((t,e)=>t!==N[e])&&(O.setOrientation(...e),N=e);const n=[t.getChannelData(6)[0],t.getChannelData(7)[0],t.getChannelData(8)[0]];n.some((t,e)=>t!==R[e])&&(O.setPosition(...n),R=n)},T.connect(O),ke(T,D,0,0),D.connect(S),D.connect(A),D.connect(M),D.connect(P),D.connect(E),D.connect(I),S.connect(C),A.connect(C),M.connect(C),P.connect(C),E.connect(C),I.connect(C),C.connect(j),Object.defineProperty(A.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(E.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0});const B={get bufferSize(){},get channelCount(){return O.channelCount},set channelCount(t){if(t>2)throw s();T.channelCount=t,O.channelCount=t},get channelCountMode(){return O.channelCountMode},set channelCountMode(t){if("max"===t)throw s();T.channelCountMode=t,O.channelCountMode=t},get channelInterpretation(){return O.channelInterpretation},set channelInterpretation(t){T.channelInterpretation=t,O.channelInterpretation=t},get coneInnerAngle(){return O.coneInnerAngle},set coneInnerAngle(t){O.coneInnerAngle=t},get coneOuterAngle(){return O.coneOuterAngle},set coneOuterAngle(t){O.coneOuterAngle=t},get coneOuterGain(){return O.coneOuterGain},set coneOuterGain(e){if(e<0||e>1)throw t();O.coneOuterGain=e},get context(){return O.context},get distanceModel(){return O.distanceModel},set distanceModel(t){O.distanceModel=t},get inputs(){return[T]},get maxDistance(){return O.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;O.maxDistance=t},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},get orientationX(){return S.gain},get orientationY(){return A.gain},get orientationZ(){return M.gain},get panningModel(){return O.panningModel},set panningModel(t){if(O.panningModel=t,O.panningModel!==t&&"HRTF"===t)throw s()},get positionX(){return P.gain},get positionY(){return E.gain},get positionZ(){return I.gain},get refDistance(){return O.refDistance},set refDistance(t){if(t<0)throw new RangeError;O.refDistance=t},get rolloffFactor(){return O.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;O.rolloffFactor=t},addEventListener(...t){return T.addEventListener(t[0],t[1],t[2])},dispatchEvent(...t){return T.dispatchEvent(t[0])},removeEventListener(...t){return T.removeEventListener(t[0],t[1],t[2])}};return c!==B.coneInnerAngle&&(B.coneInnerAngle=c),u!==B.coneOuterAngle&&(B.coneOuterAngle=u),l!==B.coneOuterGain&&(B.coneOuterGain=l),h!==B.distanceModel&&(B.distanceModel=h),p!==B.maxDistance&&(B.maxDistance=p),f!==B.orientationX.value&&(B.orientationX.value=f),d!==B.orientationY.value&&(B.orientationY.value=d),y!==B.orientationZ.value&&(B.orientationZ.value=y),m!==B.panningModel&&(B.panningModel=m),v!==B.positionX.value&&(B.positionX.value=v),_!==B.positionY.value&&(B.positionY.value=_),g!==B.positionZ.value&&(B.positionZ.value=g),b!==B.refDistance&&(B.refDistance=b),w!==B.rolloffFactor&&(B.rolloffFactor=w),ir(B,O)},Or=t=>(e,{disableNormalization:n,imag:o,real:r})=>{const i=t(e),s=new Float32Array(o),a=new Float32Array(r);return null!==i?i.createPeriodicWave(a,s,{disableNormalization:n}):e.createPeriodicWave(a,s,{disableNormalization:n})},kr=t=>(e,n,o,r)=>t(e,t=>t.createScriptProcessor(n,o,r)),Cr=(t,e,n)=>(o,r)=>t(o,t=>{const i=r.channelCountMode;if("clamped-max"===i)throw n();if(void 0===o.createStereoPanner)return e(o,r);const s=t.createStereoPanner();return Io(s,r),Bo(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:t=>{if(t!==i)throw n()}}),s}),Tr=(t,e,n,o,r)=>{const i=16385,s=new Float32Array([1,1]),a=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},l=(t,e,r,l)=>{const h=new Float32Array(i),p=new Float32Array(i);for(let n=0;n<i;n+=1){const t=n/(i-1)*a;h[n]=Math.cos(t),p[n]=Math.sin(t)}const f=n(t,{...c,gain:0}),d=o(t,{...u,curve:h}),y=o(t,{...u,curve:s}),m=n(t,{...c,gain:0}),v=o(t,{...u,curve:p});return e.connect(f),e.connect(y.inputs[0]),e.connect(m),y.connect(r),r.connect(d.inputs[0]),r.connect(v.inputs[0]),d.connect(f.gain),v.connect(m.gain),f.connect(l,0,0),m.connect(l,0,1),[f,m]},h=(t,r,l,h)=>{const p=new Float32Array(i),f=new Float32Array(i),d=new Float32Array(i),y=new Float32Array(i),m=Math.floor(i/2);for(let e=0;e<i;e+=1)if(e>m){const t=(e-m)/(i-1-m)*a;p[e]=Math.cos(t),f[e]=Math.sin(t),d[e]=0,y[e]=1}else{const t=e/(i-1-m)*a;p[e]=1,f[e]=0,d[e]=Math.cos(t),y[e]=Math.sin(t)}const v=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),_=n(t,{...c,gain:0}),g=o(t,{...u,curve:p}),b=n(t,{...c,gain:0}),w=o(t,{...u,curve:f}),x=o(t,{...u,curve:s}),O=n(t,{...c,gain:0}),k=o(t,{...u,curve:d}),C=n(t,{...c,gain:0}),T=o(t,{...u,curve:y});return r.connect(v),r.connect(x.inputs[0]),v.connect(_,1),v.connect(b,1),v.connect(O,1),v.connect(C,1),x.connect(l),l.connect(g.inputs[0]),l.connect(w.inputs[0]),l.connect(k.inputs[0]),l.connect(T.inputs[0]),g.connect(_.gain),w.connect(b.gain),k.connect(O.gain),T.connect(C.gain),_.connect(h,0,0),O.connect(h,0,0),b.connect(h,0,1),C.connect(h,0,1),[_,O,b,C]},p=(t,e,n,o,i)=>{if(1===e)return l(t,n,o,i);if(2===e)return h(t,n,o,i);throw r()};return(e,{channelCount:o,channelCountMode:i,pan:s,...a})=>{if("max"===i)throw r();const c=t(e,{...a,channelCount:1,channelCountMode:i,numberOfInputs:2}),u=n(e,{...a,channelCount:o,channelCountMode:i,gain:1}),l=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:s});let h=p(e,o,u,l,c);Object.defineProperty(l.gain,"defaultValue",{get:()=>0});const f={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){u.channelCount!==t&&(u.disconnect(),h.forEach(t=>t.disconnect()),h=p(e,t,u,l,c)),u.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw r();u.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t},get context(){return u.context},get inputs(){return[u]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get pan(){return l.gain},addEventListener(...t){return u.addEventListener(t[0],t[1],t[2])},dispatchEvent(...t){return u.dispatchEvent(t[0])},removeEventListener(...t){return u.removeEventListener(t[0],t[1],t[2])}};return ir(f,c)}},Sr=(t,e,n)=>(o,r)=>{const i=e(o,t=>t.createWaveShaper());try{return i.curve=new Float32Array([1]),n(o,r)}catch(a){}Io(i,r);const s=r.curve;if(null!==s&&s.length<2)throw t();return Eo(i,r,"curve"),Eo(i,r,"oversample"),i},Ar=(t,e,n)=>(o,{curve:r,oversample:i,...s})=>{const a=e(o,t=>t.createWaveShaper()),c=e(o,t=>t.createWaveShaper());Io(a,s),Io(c,s);const u=n(o,{...s,gain:1}),l=n(o,{...s,gain:-1}),h=n(o,{...s,gain:1}),p=n(o,{...s,gain:-1});u.connect(a),a.connect(h),u.connect(l),l.connect(c),c.connect(p),p.connect(h);let f=null;const d={get bufferSize(){},get channelCount(){return a.channelCount},set channelCount(t){u.channelCount=t,l.channelCount=t,a.channelCount=t,h.channelCount=t,c.channelCount=t,p.channelCount=t},get channelCountMode(){return a.channelCountMode},set channelCountMode(t){u.channelCountMode=t,l.channelCountMode=t,a.channelCountMode=t,h.channelCountMode=t,c.channelCountMode=t,p.channelCountMode=t},get channelInterpretation(){return a.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t,l.channelInterpretation=t,a.channelInterpretation=t,h.channelInterpretation=t,c.channelInterpretation=t,p.channelInterpretation=t},get context(){return a.context},get curve(){return f},set curve(e){if(null!==r&&r.length<2)throw t();if(null===e)a.curve=e,c.curve=e;else{const t=e.length,n=new Float32Array(t+2-t%2),o=new Float32Array(t+2-t%2);n[0]=e[0],o[0]=-e[t-1];const r=Math.ceil((t+1)/2),i=(t+1)/2-1;for(let s=1;s<r;s+=1){const a=s/r*i,c=Math.floor(a),u=Math.ceil(a);n[s]=c===u?e[c]:(1-(a-c))*e[c]+(1-(u-a))*e[u],o[s]=c===u?-e[t-1-c]:-(1-(a-c))*e[t-1-c]-(1-(u-a))*e[t-1-u]}n[r]=t%2===1?e[r-1]:(e[r-2]+e[r-1])/2,a.curve=n,c.curve=o}f=e},get inputs(){return[u]},get numberOfInputs(){return a.numberOfInputs},get numberOfOutputs(){return a.numberOfOutputs},get oversample(){return a.oversample},set oversample(t){a.oversample=t,c.oversample=t},addEventListener(...t){return u.addEventListener(t[0],t[1],t[2])},dispatchEvent(...t){return u.dispatchEvent(t[0])},removeEventListener(...t){return u.removeEventListener(t[0],t[1],t[2])}};return r!==d.curve&&(d.curve=r),i!==d.oversample&&(d.oversample=i),ir(d,h)},Mr=t=>class extends t{constructor(t,e,n,o){super(t,e,n,o)}},Pr=()=>{try{return new DOMException("","NotSupportedError")}catch(t){return t.code=9,t.name="NotSupportedError",t}},Er={numberOfChannels:1},Ir=(t,e,n,o,r)=>class extends t{constructor(t,n,r){let i;if("number"===typeof t&&void 0!==n&&void 0!==r)i={length:n,numberOfChannels:t,sampleRate:r};else{if("object"!==typeof t)throw new Error("The given parameters are not valid.");i=t}const{length:s,numberOfChannels:a,sampleRate:c}={...Er,...i},u=o(a,s,c);e(Ao,()=>Ao(u))||u.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(u.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(u,a),this._length=s,this._nativeOfflineAudioContext=u,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).then(t=>(this._state=null,t)).catch(t=>{throw this._state=null,t}))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout(()=>this._waitForThePromiseToSettle(t))}},jr={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,type:"sine"},Dr=(t,e,n,o,r,i)=>class extends i{constructor(e,i=jr){const s=Et(e),a={...jr,...i},c=n(s,a),u=r(s),l=u?o():null,h=e.sampleRate/2;super(e,"passive",c,l),this._detune=t(this,u,c.detune,153600,-153600),this._frequency=t(this,u,c.frequency,h,-h),this._nativeOscillatorNode=c,this._onended=null,this._oscillatorNodeRenderer=l,null!==this._oscillatorNodeRenderer&&void 0!==a.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=a.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e=ie(this,t);this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){if(this._nativeOscillatorNode.type=t,"custom"===t)throw e();null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer)this._oscillatorNodeRenderer.start=t;else{re(this,"active");const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),setTimeout(()=>re(this,"passive"),1e3)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}},Nr=t=>()=>{const e=new WeakMap;let n=null,o=null,r=null;const i=async(i,s)=>{let a=Lt(i);const c=zt(a,s);if(!c){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,detune:a.detune.value,frequency:a.frequency.value,periodicWave:null===n?void 0:n,type:a.type};a=t(s,e),null!==o&&a.start(o),null!==r&&a.stop(r)}return e.set(s,a),c?(await he(i.context,s,i.detune),await he(i.context,s,i.frequency)):(await fe(i.context,s,i.detune,a.detune),await fe(i.context,s,i.frequency,a.frequency)),await Yt(i,s,a),a};return{set periodicWave(t){n=t},set start(t){o=t},set stop(t){r=t},render(t,n){const o=e.get(n);return void 0!==o?Promise.resolve(o):i(t,n)}}},Rr={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Br=(t,e,n,o,r)=>class extends r{constructor(r,i=Rr){const s=Et(r),a={...Rr,...i},c=e(s,a),u=o(s),l=u?n():null;super(r,"passive",c,l),this._nativePannerNode=c,this._orientationX=t(this,u,c.orientationX,ne,ee),this._orientationY=t(this,u,c.orientationY,ne,ee),this._orientationZ=t(this,u,c.orientationZ,ne,ee),this._positionX=t(this,u,c.positionX,ne,ee),this._positionY=t(this,u,c.positionY,ne,ee),this._positionZ=t(this,u,c.positionZ,ne,ee)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}},qr=t=>()=>{const e=new WeakMap,n=async(n,o)=>{let r=Lt(n);const i=zt(r,o);if(!i){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,orientationX:r.orientationX.value,orientationY:r.orientationY.value,orientationZ:r.orientationZ.value,panningModel:r.panningModel,positionX:r.positionX.value,positionY:r.positionY.value,positionZ:r.positionZ.value,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor};r=t(o,e)}return e.set(o,r),i?(await he(n.context,o,n.orientationX),await he(n.context,o,n.orientationY),await he(n.context,o,n.orientationZ),await he(n.context,o,n.positionX),await he(n.context,o,n.positionY),await he(n.context,o,n.positionZ)):(await fe(n.context,o,n.orientationX,r.orientationX),await fe(n.context,o,n.orientationY,r.orientationY),await fe(n.context,o,n.orientationZ,r.orientationZ),await fe(n.context,o,n.positionX,r.positionX),await fe(n.context,o,n.positionY,r.positionY),await fe(n.context,o,n.positionZ,r.positionZ)),void 0!==r.inputs?await Yt(n,o,r.inputs[0]):await Yt(n,o,r),r};return{render(t,o){const r=e.get(o);return void 0!==r?Promise.resolve(r):n(t,o)}}},Fr={disableNormalization:!1},Vr=(t,e)=>class n{constructor(n,o){const r=Et(n),i={...Fr,...o},s=t(r,i);return e.add(s),s}static[Symbol.hasInstance](t){return null!==t&&"object"===typeof t&&Object.getPrototypeOf(t)===n.prototype||e.has(t)}},Ur=(t,e,n,o)=>r=>t(Ao,()=>Ao(r))?Promise.resolve(t(o,o)).then(t=>{if(!t){const t=n(r,512,0,1);r.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>r.currentTime,t.connect(r.destination)}return r.startRendering()}):new Promise(t=>{const n=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(r.destination),r.startRendering()}),Lr=(t,e,n,o,r,i,s,a)=>(c,u)=>$t(c).render(c,u).then(()=>n(u)).then(n=>("function"!==typeof n.copyFromChannel?(i(n),Zt(n)):e(r,()=>r(n))?e(o,()=>o(n))||s(n):(a(n),s(n)),t.add(n),n)),zr={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Wr=(t,e,n,o,r)=>class extends r{constructor(r,i=zr){const s=Et(r),a={...zr,...i},c=e(s,a),u=o(s),l=u?n():null;super(r,"passive",c,l),this._pan=t(this,u,c.pan,1,-1)}get pan(){return this._pan}},Gr=t=>()=>{const e=new WeakMap,n=async(n,o)=>{let r=Lt(n);const i=zt(r,o);if(!i){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,pan:r.pan.value};r=t(o,e)}return e.set(o,r),i?await he(n.context,o,n.pan):await fe(n.context,o,n.pan,r.pan),void 0!==r.inputs?await Yt(n,o,r.inputs[0]):await Yt(n,o,r),r};return{render(t,o){const r=e.get(o);return void 0!==r?Promise.resolve(r):n(t,o)}}},$r=t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch(e){return!1}return!0},Yr=t=>e=>{const n=t(e,t=>t.createBufferSource());n.start();try{n.start()}catch(o){return!0}return!1},Qr=t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100),n=e.createBuffer(1,1,e.sampleRate),o=e.createBufferSource();return n.getChannelData(0)[0]=1,o.buffer=n,o.start(0,0,0),o.connect(e.destination),new Promise(t=>{e.oncomplete=({renderedBuffer:e})=>{t(0===e.getChannelData(0)[0])},e.startRendering()})},Hr=t=>e=>{const n=t(e,t=>t.createBufferSource()),o=e.createBuffer(1,1,44100);n.buffer=o;try{n.start(0,1)}catch(r){return!1}return!0},Xr=t=>e=>{const n=t(e,t=>t.createOscillator());try{n.start(-1)}catch(o){return o instanceof RangeError}return!1},Jr=t=>e=>{const n=e.createBuffer(1,1,44100),o=t(e,t=>t.createBufferSource());o.buffer=n,o.start(),o.stop();try{return o.stop(),!0}catch(r){return!1}},Zr=t=>e=>{const n=t(e,t=>t.createOscillator());try{n.stop(-1)}catch(o){return o instanceof RangeError}return!1},Kr=(t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),o=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(t=>{n.oncomplete=()=>{o.disconnect(),t(0!==n.currentTime)},n.startRendering()})},ti=()=>{try{return new DOMException("","UnknownError")}catch(t){return t.name="UnknownError",t}},ei={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ni=(t,e,n,o,r)=>class extends r{constructor(t,r=ei){const i=Et(t),s={...ei,...r},a=e(i,s),c=o(i),u=c?n():null;super(t,"passive",a,u),this._isCurveNullified=!1,this._nativeWaveShaperNode=a}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}},oi=t=>()=>{const e=new WeakMap,n=async(n,o)=>{let r=Lt(n);const i=zt(r,o);if(!i){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,curve:r.curve,oversample:r.oversample};r=t(o,e)}return e.set(o,r),void 0!==r.inputs?await Yt(n,o,r.inputs[0]):await Yt(n,o,r),r};return{render(t,o){const r=e.get(o);return void 0!==r?Promise.resolve(r):n(t,o)}}},ri=()=>"undefined"===typeof window?null:window,ii=(t,e)=>n=>{n.copyFromChannel=(o,r,i=0)=>{const s=t(i),a=t(r);if(a>=n.numberOfChannels)throw e();const c=n.length,u=n.getChannelData(a),l=o.length;for(let t=s<0?-s:0;t+s<c&&t<l;t+=1)o[t]=u[t+s]},n.copyToChannel=(o,r,i=0)=>{const s=t(i),a=t(r);if(a>=n.numberOfChannels)throw e();const c=n.length,u=n.getChannelData(a),l=o.length;for(let t=s<0?-s:0;t+s<c&&t<l;t+=1)u[t+s]=o[t]}},si=t=>e=>{e.copyFromChannel=(n=>(o,r,i=0)=>{const s=t(i),a=t(r);if(s<e.length)return n.call(e,o,a,s)})(e.copyFromChannel),e.copyToChannel=(n=>(o,r,i=0)=>{const s=t(i),a=t(r);if(s<e.length)return n.call(e,o,a,s)})(e.copyToChannel)},ai=(t,e)=>n=>{n.copyFromChannel=(o=>(r,i,s=0)=>{const a=t(s),c=t(i);if(c>=n.numberOfChannels)throw e();return a<n.length&&n.length-a<r.length?o.call(n,r.subarray(0,n.length-a),c,a):o.call(n,r,c,a)})(n.copyFromChannel),n.copyToChannel=(o=>(r,i,s=0)=>{const a=t(s),c=t(i);if(c>=n.numberOfChannels)throw e();return a<n.length&&n.length-a<r.length?o.call(n,r.subarray(0,n.length-a),c,a):o.call(n,r,c,a)})(n.copyToChannel)},ci=t=>(e,n)=>{const o=t(n,t=>t.createGain());e.connect(o);const r=(t=>()=>{t.call(e,o),e.removeEventListener("ended",r)})(e.disconnect);e.addEventListener("ended",r),ir(e,o),e.stop=(t=>{let n=!1;return(r=0)=>{if(n)try{t.call(e,r)}catch(i){o.gain.setValueAtTime(0,r)}else t.call(e,r),n=!0}})(e.stop)},ui=(t,e)=>(n,o)=>{const r=e(n,t=>t.createBufferSource());o.channelCount=1,o.channelCountMode="explicit";const i=o.numberOfInputs;for(let t=0;t<i;t+=1)r.connect(o,0,t);Object.defineProperty(o,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(o,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}})},li=t=>{t.start=(e=>(n=0,o=0,r)=>{const i=t.buffer,s=null===i?o:Math.min(i.duration,o);null!==i&&s>i.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,s,r)})(t.start)},hi=xn(new Map),pi=ri(),fi=gr(pi),di=wo(fi),yi=zo(pi),mi=ro(di,yi,fi),vi=Go(mi),_i=No(hi,Jt,vi),gi=Qt(_i),bi=_o(pi),wi=go(pi),xi=nn(hi,Jt,io,Pr,$n(gt,Pr,Gt,Ut),bi,wi,di),Oi=Mr(xi),ki=Vt(gi,Jt,_i,di,Oi),Ci=Ro(pi),Ti=Dn(new Uint32Array(1)),Si=ii(Ti,Jt),Ai=si(Ti),Mi=ai(Ti,Jt),Pi=te(yt,hi,Pr,Ci,fi,$r(Ci),Si,Ai,Mi),Ei=Xr(vi),Ii=Jr(vi),ji=Zr(vi),Di=ci(vi),Ni=Lo(hi,vi,Yr(vi),Qr(fi),Hr(vi),Ei,Ii,ji,li,Di),Ri=de(Ni),Bi=rn(sn,pt["createCancelAndHoldAutomationEvent"],pt["createCancelScheduledValuesAutomationEvent"],pt["createExponentialRampToValueAutomationEvent"],pt["createLinearRampToValueAutomationEvent"],pt["createSetTargetAutomationEvent"],pt["createSetValueAutomationEvent"],pt["createSetValueCurveAutomationEvent"],yi),qi=ae(Ri,Bi,Pt,Ni,di,Oi),Fi=ve(xi,_e,Jt,Pt,Wo,di),Vi=tr(vi),Ui=wn(Vi),Li=bn(Bi,Ui,io,Vi,di,Oi),zi=ui(Pt,vi),Wi=er(vi,zi),Gi=Cn(Wi),$i=kn(Gi,Wi,di,Oi),Yi=or(vi),Qi=Mn(Yi),Hi=An(Qi,Yi,di,Oi),Xi=lr(vi),Ji=sr(Ni,Xi),Zi=rr(hi,vi,Ji,Ei,ji),Ki=jn(Zi),ts=In(Bi,Ki,Zi,di,Oi),es=ar(vi,Pr),ns=Bn(es),os=Rn(ns,es,di,Oi),rs=cr(vi),is=Wn(rs),ss=zn(Bi,is,rs,di,Oi),as=ur(vi,Pr),cs=Jn(as),us=Xn(Bi,cs,as,Pr,di,Oi),ls=oo(Xi),hs=no(Bi,ls,Xi,di,Oi),ps=kr(vi),fs=yr(io,Pt,ps,Pr),ds=Ur(hi,Xi,ps,Kr(Xi,fi)),ys=ho(Ni,vi,fi,ds),ms=hr(vi,fs),vs=co(ms,ys,di,Oi),_s=ge(Bi,Wi,Zi,ps,di),gs=So(Fi,_s),bs=br(hi,vi,Ei,Ii,ji,Di),ws=Nr(bs),xs=Dr(Bi,Pt,bs,ws,di,Oi),Os=Ar(Pt,vi,Xi),ks=Sr(Pt,vi,Os),Cs=xr(Pt,vi,Wi,Xi,ps,ks,Pr),Ts=wr(vi,Cs),Ss=qr(Ts),As=Br(Bi,Ts,Ss,di,Oi),Ms=Or(mi),Ps=Vr(Ms,St),Es=Tr(Wi,Yi,Xi,ks,Pr),Is=Cr(vi,Es,Pr),js=Gr(Is),Ds=Wr(Bi,Is,js,di,Oi),Ns=oi(ks),Rs=ni(Pt,ks,Ns,di,Oi),Bs=xo(pi),qs=Kn(pi),Fs=Bs?qt(ft,Pr,qs,to(ft),mi,new WeakMap,new WeakMap):void 0,Vs=vo(yi),Us=bo(Vs,di),Ls=Un(yt,hi,Fn,Zn,fi,Us,di,Ht,Xt,Ao,Si,Ai,Mi),zs=_n(Fs,ki,Pi,qi,Li,$i,Hi,ts,os,Ls,ss,us,hs,vs,gs,xs,As,Ps,Ds,Rs),Ws=mr(vi),Gs=Oo(Ws,Pr,di,Oi),$s=vr(Pt,vi),Ys=ko($s,Pr,di,Oi),Qs=_r(Pt,vi),Hs=Co(Qs,Pr,di,Oi),Xs=me(zs,Pt,Pr,ti,Gs,Ys,Hs,yi),Js=Pn(Jt),Zs=Qn(Jt),Ks=Ko(Js,Jt,Pt,Wi,Yi,Zi,Xi,ps,Pr,Zs,qs),ta=Qo(Pt,vi,Ks,Pr,di),ea=$o(pi),na=vn(Js,Ni,Wi,Yi,Zi,Xi,Zs,ea,fi,ds),oa=(Bs&&hn(Bi,na,ta,hs,di,ea,Oi),To(Pt,Pr,ti,gs,yi),qn(Pr,fi)),ra=Lr(yt,hi,ds,Ht,Xt,Si,Ai,Mi),ia=(Po(hi,Pt,oa,gs,ra),Ir(zs,hi,Pt,oa,ra)),sa=po(xt,Vs),aa=fo(mt,bi),ca=yo(_t,wi),ua=mo(xt,di);function la(){return new Xs}function ha(t,e,n){return new ia(t,e,n)}var pa,fa="object"===typeof self?self:null,da=fa&&(fa.hasOwnProperty("AudioContext")||fa.hasOwnProperty("webkitAudioContext"));function ya(){return!pa&&da&&ma(la()),pa}function ma(t){pa=t,fa&&(fa.TONE_AUDIO_CONTEXT=pa)}fa&&fa.TONE_AUDIO_CONTEXT&&(pa=fa.TONE_AUDIO_CONTEXT);var va=function(){function t(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}return t.prototype._createWorker=function(){var t=new Blob(["var timeoutTime =  "+(1e3*this._updateInterval).toFixed(1)+";\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();"]),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n},t.prototype._createTimeout=function(){var t=this;this._timeout=setTimeout((function(){t._createTimeout(),t._callback()}),1e3*this._updateInterval)},t.prototype._createClock=function(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()},t.prototype._disposeClock=function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)},Object.defineProperty(t.prototype,"updateInterval",{get:function(){return this._updateInterval},set:function(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(t){this._disposeClock(),this._type=t,this._createClock()},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._disposeClock()},t}();function _a(t){return ca(t)}function ga(t){return aa(t)}function ba(t){return ua(t)}function wa(t){return sa(t)}function xa(t){return t instanceof AudioBuffer}function Oa(t){return"undefined"===typeof t}function ka(t){return!Oa(t)}function Ca(t){return"function"===typeof t}function Ta(t){return"number"===typeof t}function Sa(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function Aa(t){return"boolean"===typeof t}function Ma(t){return Array.isArray(t)}function Pa(t){return"string"===typeof t}function Ea(t){return Pa(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function Ia(t,e){return"value"===t||_a(e)||ga(e)||xa(e)}function ja(t){for(var e,n,o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];if(!o.length)return t;var i=o.shift();if(Sa(t)&&Sa(i))for(var s in i)Ia(s,i[s])?t[s]=i[s]:Sa(i[s])?(t[s]||Object.assign(t,(e={},e[s]={},e)),ja(t[s],i[s])):Object.assign(t,(n={},n[s]=i[s],n));return ja.apply(void 0,[t].concat(o))}function Da(t,e){return t.length===e.length&&t.every((function(t,n){return e[n]===t}))}function Na(t,e,n,o){var r;void 0===n&&(n=[]);var i={},s=Array.from(e);if(Sa(s[0])&&o&&!Reflect.has(s[0],o)){var a=Object.keys(s[0]).some((function(e){return Reflect.has(t,e)}));a||(ja(i,(r={},r[o]=s[0],r)),n.splice(n.indexOf(o),1),s.shift())}if(1===s.length&&Sa(s[0]))ja(i,s[0]);else for(var c=0;c<n.length;c++)ka(s[c])&&(i[n[c]]=s[c]);return ja(t,i)}function Ra(t){return t.constructor.getDefaults()}function Ba(t,e){return Oa(t)?e:t}function qa(t,e){return e.forEach((function(e){Reflect.has(t,e)&&delete t[e]})),t}function Fa(t,e){if(!t)throw new Error(e)}function Va(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.log.apply(console,t)}
/**
 *  Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */var Ua=function(){function t(){this.debug=!1,this._wasDisposed=!1}return t.getDefaults=function(){return{}},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];(this.debug||fa&&this.toString()===fa.TONE_DEBUG_CLASS)&&(t.unshift(this.toString()+":"),Va.apply(void 0,t))},t.prototype.assert=function(t,e){Fa(t,e)},t.prototype.dispose=function(){return this._wasDisposed=!0,this},Object.defineProperty(t.prototype,"disposed",{get:function(){return this._wasDisposed},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return this.name},t.version=ht,t}(),La=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),za=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Emitter",e}return La(e,t),e.prototype.on=function(t,e){var n=this,o=t.split(/\W+/);return o.forEach((function(t){Oa(n._events)&&(n._events={}),n._events.hasOwnProperty(t)||(n._events[t]=[]),n._events[t].push(e)})),this},e.prototype.once=function(t,e){var n=this,o=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];e.apply(void 0,r),n.off(t,o)};return this.on(t,o),this},e.prototype.off=function(t,e){var n=this,o=t.split(/\W+/);return o.forEach((function(o){if(Oa(n._events)&&(n._events={}),n._events.hasOwnProperty(t))if(Oa(e))n._events[t]=[];else for(var r=n._events[t],i=0;i<r.length;i++)r[i]===e&&r.splice(i,1)})),this},e.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(this._events&&this._events.hasOwnProperty(t))for(var o=this._events[t].slice(0),r=0,i=o.length;r<i;r++)o[r].apply(this,e);return this},e.mixin=function(t){["on","once","off","emit"].forEach((function(n){var o=Object.getOwnPropertyDescriptor(e.prototype,n);Object.defineProperty(t.prototype,n,o)}))},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._events=void 0,this},e}(Ua),Wa=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ga=function(t){function e(){var n=t.call(this)||this;n.name="Timeline",n._timeline=[];var o=Na(e.getDefaults(),arguments,["memory"]);return n.memory=o.memory,n}return Wa(e,t),e.getDefaults=function(){return{memory:1/0}},Object.defineProperty(e.prototype,"length",{get:function(){return this._timeline.length},enumerable:!0,configurable:!0}),e.prototype.add=function(t){this.assert(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf();var e=this._search(t.time);if(this._timeline.splice(e+1,0,t),this.length>this.memory){var n=this.length-this.memory;this._timeline.splice(0,n)}return this},e.prototype.remove=function(t){var e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this},e.prototype.get=function(t,e){void 0===e&&(e="time");var n=this._search(t,e);return-1!==n?this._timeline[n]:null},e.prototype.peek=function(){return this._timeline[0]},e.prototype.shift=function(){return this._timeline.shift()},e.prototype.getAfter=function(t,e){void 0===e&&(e="time");var n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null},e.prototype.getBefore=function(t){var e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];var n=this._search(t);return n-1>=0?this._timeline[n-1]:null},e.prototype.cancel=function(t){if(this._timeline.length>1){var e=this._search(t);if(e>=0)if(this._timeline[e].time===t){for(var n=e;n>=0;n--){if(this._timeline[n].time!==t)break;e=n}this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&this._timeline[0].time>=t&&(this._timeline=[]);return this},e.prototype.cancelBefore=function(t){var e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this},e.prototype.previousEvent=function(t){var e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null},e.prototype._search=function(t,e){if(void 0===e&&(e="time"),0===this._timeline.length)return-1;var n=0,o=this._timeline.length,r=o;if(o>0&&this._timeline[o-1][e]<=t)return o-1;while(n<r){var i=Math.floor(n+(r-n)/2),s=this._timeline[i],a=this._timeline[i+1];if(s[e]===t){for(var c=i;c<this._timeline.length;c++){var u=this._timeline[c];u[e]===t&&(i=c)}return i}if(s[e]<t&&a[e]>t)return i;s[e]>t?r=i:n=i+1}return-1},e.prototype._iterate=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this._timeline.length-1),this._timeline.slice(e,n+1).forEach(t)},e.prototype.forEach=function(t){return this._iterate(t),this},e.prototype.forEachBefore=function(t,e){var n=this._search(t);return-1!==n&&this._iterate(e,0,n),this},e.prototype.forEachAfter=function(t,e){var n=this._search(t);return this._iterate(e,n+1),this},e.prototype.forEachBetween=function(t,e,n){var o=this._search(t),r=this._search(e);return-1!==o&&-1!==r?(this._timeline[o].time!==t&&(o+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,o,r)):-1===o&&this._iterate(n,0,r),this},e.prototype.forEachFrom=function(t,e){var n=this._search(t);while(n>=0&&this._timeline[n].time>=t)n--;return this._iterate(e,n+1),this},e.prototype.forEachAtTime=function(t,e){var n=this._search(t);return-1!==n&&this._iterate((function(n){n.time===t&&e(n)}),0,n),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._timeline=[],this},e}(Ua),$a=[];function Ya(t){$a.push(t)}function Qa(t){$a.forEach((function(e){return e(t)}))}var Ha=[];function Xa(t){Ha.push(t)}function Ja(t){Ha.forEach((function(e){return e(t)}))}var Za=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ka=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(s,a)}c((o=o.apply(t,e||[])).next())}))},tc=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,o&&(r=2&i[0]?o["return"]:i[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},ec=function(t){function e(){var n=t.call(this)||this;n.name="Context",n._constants=new Map,n._timeouts=new Ga,n._timeoutIds=0,n._initialized=!1;var o=Na(e.getDefaults(),arguments,["context"]);return n._context=o.context,n._latencyHint=o.latencyHint,n.lookAhead=o.lookAhead,n._ticker=new va(n.emit.bind(n,"tick"),o.clockSource,o.updateInterval),n.on("tick",n._timeoutLoop.bind(n)),n._context.onstatechange=function(){n.emit("statechange",n.state)},n}return Za(e,t),e.getDefaults=function(){return{clockSource:"worker",context:ya(),latencyHint:"interactive",lookAhead:.1,updateInterval:.03}},e.prototype.initialize=function(){return this._initialized||(Qa(this),this._initialized=!0),this},e.prototype.createAnalyser=function(){return this._context.createAnalyser()},e.prototype.createOscillator=function(){return this._context.createOscillator()},e.prototype.createBufferSource=function(){return this._context.createBufferSource()},e.prototype.createBiquadFilter=function(){return this._context.createBiquadFilter()},e.prototype.createBuffer=function(t,e,n){return this._context.createBuffer(t,e,n)},e.prototype.createChannelMerger=function(t){return this._context.createChannelMerger(t)},e.prototype.createChannelSplitter=function(t){return this._context.createChannelSplitter(t)},e.prototype.createConstantSource=function(){return this._context.createConstantSource()},e.prototype.createConvolver=function(){return this._context.createConvolver()},e.prototype.createDelay=function(t){return this._context.createDelay(t)},e.prototype.createDynamicsCompressor=function(){return this._context.createDynamicsCompressor()},e.prototype.createGain=function(){return this._context.createGain()},e.prototype.createIIRFilter=function(t,e){return this._context.createIIRFilter(t,e)},e.prototype.createPanner=function(){return this._context.createPanner()},e.prototype.createPeriodicWave=function(t,e,n){return this._context.createPeriodicWave(t,e,n)},e.prototype.createStereoPanner=function(){return this._context.createStereoPanner()},e.prototype.createWaveShaper=function(){return this._context.createWaveShaper()},e.prototype.decodeAudioData=function(t){return this._context.decodeAudioData(t)},Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._context.currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._context.state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sampleRate",{get:function(){return this._context.sampleRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listener",{get:function(){return this._context.listener},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transport",{get:function(){return this.assert(this._initialized,"The context must be initialized before being used by invoking context.initialize()"),this._transport},set:function(t){this.assert(!this._initialized,"The transport cannot be set after initialization."),this._transport=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destination",{get:function(){return this.assert(this._initialized,"The context must be initialized before being used by invoking context.initialize()"),this._destination},set:function(t){this.assert(!this._initialized,"The transport cannot be set after initialization."),this._destination=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updateInterval",{get:function(){return this._ticker.updateInterval},set:function(t){this._ticker.updateInterval=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clockSource",{get:function(){return this._ticker.type},set:function(t){this._ticker.type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latencyHint",{get:function(){return this._latencyHint},set:function(t){var e=0;if(this._latencyHint=t,Pa(t))switch(t){case"interactive":e=.1;break;case"playback":e=.8;break;case"balanced":e=.25;break;case"fastest":e=.01;break}this.lookAhead=e,this.updateInterval=e/3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rawContext",{get:function(){return this._context},enumerable:!0,configurable:!0}),e.prototype.now=function(){return this._context.currentTime+this.lookAhead},e.prototype.resume=function(){return"suspended"===this._context.state&&wa(this._context)?this._context.resume():Promise.resolve()},e.prototype.close=function(){return Ka(this,void 0,void 0,(function(){return tc(this,(function(t){switch(t.label){case 0:return wa(this._context)?[4,this._context.close()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this._initialized&&Ja(this),[2]}}))}))},e.prototype.getConstant=function(t){if(this._constants.has(t))return this._constants.get(t);for(var e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0),o=0;o<n.length;o++)n[o]=t;var r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=e,r.loop=!0,r.start(0),this._constants.set(t,r),r},e.prototype.dispose=function(){var e=this;return t.prototype.dispose.call(this),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((function(t){return e._constants[t].disconnect()})),this},e.prototype._timeoutLoop=function(){var t=this.now(),e=this._timeouts.peek();while(this._timeouts.length&&e&&e.time<=t)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()},e.prototype.setTimeout=function(t,e){this._timeoutIds++;var n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds},e.prototype.clearTimeout=function(t){var e=this;return this._timeouts.forEach((function(n){n.id===t&&e._timeouts.remove(n)})),this},e}(za),nc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),oc=function(t){function e(){var e=t.call(this,{clockSource:"offline",context:ba(arguments[0])?arguments[0]:ha(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:ba(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]})||this;return e.name="OfflineContext",e._currentTime=0,e._duration=ba(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1],e}return nc(e,t),e.prototype.now=function(){return this._currentTime},Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._currentTime},enumerable:!0,configurable:!0}),e.prototype.render=function(){while(this._duration-this._currentTime>=0)this.emit("tick"),this._currentTime+=128/this.sampleRate;return this._context.startRendering()},e.prototype.close=function(){return Promise.resolve()},e}(ec),rc={destination:{},transport:{}},ic=rc;function sc(){return ic===rc&&da&&ac(new ec),ic}function ac(t){ic=wa(t)?new ec(t):ba(t)?new oc(t):t,ic.initialize()}if(fa&&!fa.TONE_SILENCE_LOGGING){var cc="v";"dev"===ht&&(cc="");var uc=" * Tone.js "+cc+ht+" * ";console.log("%c"+uc,"background: #000; color: #fff")}function lc(t){return Math.pow(10,t/20)}function hc(t){return Math.log(t)/Math.LN10*20}function pc(t){return Math.pow(2,t/12)}var fc=440;function dc(){return fc}function yc(t){fc=t}function mc(t){return Math.round(vc(t))}function vc(t){return 69+12*Math.log2(t/fc)}function _c(t){return fc*Math.pow(2,(t-69)/12)}var gc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),bc=function(t){function e(e,n,o){var r=t.call(this)||this;return r.defaultUnits="s",r._val=n,r._units=o,r.context=e,r._expressions=r._getExpressions(),r}return gc(e,t),e.prototype._getExpressions=function(){var t=this;return{hz:{method:function(e){return t._frequencyToUnits(parseFloat(e))},regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:function(e){return t._ticksToUnits(parseInt(e,10))},regexp:/^(\d+)i$/i},m:{method:function(e){return t._beatsToUnits(parseInt(e,10)*t._getTimeSignature())},regexp:/^(\d+)m$/i},n:{method:function(e,n){var o=parseInt(e,10),r="."===n?1.5:1;return 1===o?t._beatsToUnits(t._getTimeSignature())*r:t._beatsToUnits(4/o)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:function(e){return t._expressions[t.defaultUnits].method.call(t,e)},regexp:/^(\d+(?:\.\d+)?)$/},s:{method:function(e){return t._secondsToUnits(parseFloat(e))},regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:function(e){return parseInt(e,10)/t.context.sampleRate},regexp:/^(\d+)samples$/},t:{method:function(e){var n=parseInt(e,10);return t._beatsToUnits(8/(3*Math.floor(n)))},regexp:/^(\d+)t$/i},tr:{method:function(e,n,o){var r=0;return e&&"0"!==e&&(r+=t._beatsToUnits(t._getTimeSignature()*parseFloat(e))),n&&"0"!==n&&(r+=t._beatsToUnits(parseFloat(n))),o&&"0"!==o&&(r+=t._beatsToUnits(parseFloat(o)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}},e.prototype.valueOf=function(){if(this._val instanceof e&&this.fromType(this._val),Oa(this._val))return this._noArg();if(Pa(this._val)&&Oa(this._units)){for(var t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Sa(this._val)){var n=0;for(var o in this._val)if(ka(this._val[o])){var r=this._val[o],i=new this.constructor(this.context,o).valueOf()*r;n+=i}return n}if(ka(this._units)){var s=this._expressions[this._units],a=this._val.toString().trim().match(s.regexp);return a?s.method.apply(this,a.slice(1)):s.method.call(this,this._val)}return Pa(this._val)?parseFloat(this._val):this._val},e.prototype._frequencyToUnits=function(t){return 1/t},e.prototype._beatsToUnits=function(t){return 60/this._getBpm()*t},e.prototype._secondsToUnits=function(t){return t},e.prototype._ticksToUnits=function(t){return t*this._beatsToUnits(1)/this._getPPQ()},e.prototype._noArg=function(){return this._now()},e.prototype._getBpm=function(){return this.context.transport.bpm.value},e.prototype._getTimeSignature=function(){return this.context.transport.timeSignature},e.prototype._getPPQ=function(){return this.context.transport.PPQ},e.prototype.fromType=function(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi();break}return this},e.prototype.toFrequency=function(){return 1/this.toSeconds()},e.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate},e.prototype.toMilliseconds=function(){return 1e3*this.toSeconds()},e}(Ua),wc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),xc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Time",e}return wc(e,t),e.prototype._getExpressions=function(){var n=this;return Object.assign(t.prototype._getExpressions.call(this),{now:{method:function(t){return n._now()+new n.constructor(n.context,t).valueOf()},regexp:/^\+(.+)/},quantize:{method:function(t){var o=new e(n.context,t).valueOf();return n._secondsToUnits(n.context.transport.nextSubdivision(o))},regexp:/^@(.+)/}})},e.prototype.quantize=function(t,e){void 0===e&&(e=1);var n=new this.constructor(this.context,t).valueOf(),o=this.valueOf(),r=Math.round(o/n),i=r*n,s=i-o;return o+s*e},e.prototype.toNotation=function(){for(var t=this,n=this.toSeconds(),o=["1m"],r=1;r<9;r++){var i=Math.pow(2,r);o.push(i+"n."),o.push(i+"n"),o.push(i+"t")}o.push("0");var s=o[0],a=new e(this.context,o[0]).toSeconds();return o.forEach((function(o){var r=new e(t.context,o).toSeconds();Math.abs(r-n)<Math.abs(a-n)&&(s=o,a=r)})),s},e.prototype.toBarsBeatsSixteenths=function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;e=parseFloat(e.toFixed(4));var n=Math.floor(e/this._getTimeSignature()),o=e%1*4;e=Math.floor(e)%this._getTimeSignature();var r=o.toString();r.length>3&&(o=parseFloat(parseFloat(r).toFixed(3)));var i=[n,e,o];return i.join(":")},e.prototype.toTicks=function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())},e.prototype.toSeconds=function(){return this.valueOf()},e.prototype.toMidi=function(){return mc(this.toFrequency())},e.prototype._now=function(){return this.context.now()},e}(bc);var Oc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),kc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Frequency",e.defaultUnits="hz",e}return Oc(e,t),Object.defineProperty(e,"A4",{get:function(){return dc()},set:function(t){yc(t)},enumerable:!0,configurable:!0}),e.prototype._getExpressions=function(){return Object.assign({},t.prototype._getExpressions.call(this),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method:function(t){return"midi"===this.defaultUnits?t:e.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(t,n){var o=Cc[t.toLowerCase()],r=o+12*(parseInt(n,10)+1);return"midi"===this.defaultUnits?r:e.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(t,e,n){var o=1;return t&&"0"!==t&&(o*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(o*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(o*=this._beatsToUnits(parseFloat(n)/4)),o}}})},e.prototype.transpose=function(t){return new e(this.context,this.valueOf()*pc(t))},e.prototype.harmonize=function(t){var e=this;return t.map((function(t){return e.transpose(t)}))},e.prototype.toMidi=function(){return mc(this.valueOf())},e.prototype.toNote=function(){var t=this.toFrequency(),n=Math.log2(t/e.A4),o=Math.round(12*n)+57,r=Math.floor(o/12);r<0&&(o+=-12*r);var i=Tc[o%12];return i+r.toString()},e.prototype.toSeconds=function(){return 1/t.prototype.toSeconds.call(this)},e.prototype.toTicks=function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())},e.prototype._noArg=function(){return 0},e.prototype._frequencyToUnits=function(t){return t},e.prototype._ticksToUnits=function(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))},e.prototype._beatsToUnits=function(e){return 1/t.prototype._beatsToUnits.call(this,e)},e.prototype._secondsToUnits=function(t){return 1/t},e.mtof=function(t){return _c(t)},e.ftom=function(t){return mc(t)},e}(xc),Cc={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Tc=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];var Sc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ac=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="TransportTime",e}return Sc(e,t),e.prototype._now=function(){return this.context.transport.seconds},e}(xc);var Mc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pc=function(t){function e(n){var o=t.call(this)||this,r=Na(e.getDefaults(),arguments,["context"]);return o.defaultContext?o.context=o.defaultContext:o.context=r.context,o}return Mc(e,t),e.getDefaults=function(){return{context:sc()}},e.prototype.now=function(){return this.context.currentTime+this.context.lookAhead},e.prototype.immediate=function(){return this.context.currentTime},Object.defineProperty(e.prototype,"sampleTime",{get:function(){return 1/this.context.sampleRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blockTime",{get:function(){return 128/this.context.sampleRate},enumerable:!0,configurable:!0}),e.prototype.toSeconds=function(t){return new xc(this.context,t).toSeconds()},e.prototype.toFrequency=function(t){return new kc(this.context,t).toFrequency()},e.prototype.toTicks=function(t){return new Ac(this.context,t).toTicks()},e.prototype.get=function(){var t=this,n=Ra(this);return Object.keys(n).forEach((function(o){if(Reflect.has(t,o)){var r=t[o];ka(r)&&ka(r.value)&&ka(r.setValueAtTime)?n[o]=r.value:r instanceof e?n[o]=r.get():Ma(r)||Ta(r)||Pa(r)||Aa(r)?n[o]=r:delete n[o]}})),n},e.prototype.set=function(t){var n=this;return Object.keys(t).forEach((function(o){Reflect.has(n,o)&&ka(n[o])&&(n[o]&&ka(n[o].value)&&ka(n[o].setValueAtTime)?n[o].value!==t[o]&&(n[o].value=t[o]):n[o]instanceof e?n[o].set(t[o]):n[o]=t[o])})),this},e}(Ua),Ec=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ic=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["param","units","convert"]))||this;n.name="Param",n.overridden=!1,n._minOutput=1e-7;var o=Na(e.getDefaults(),arguments,["param","units","convert"]);return n.assert(ka(o.param)&&_a(o.param),"param must be an AudioParam"),n._param=n.input=o.param,n._events=new Ga(1e3),n._initialValue=n._param.defaultValue,n.units=o.units,n.convert=o.convert,ka(o.value)&&o.value!==n._toType(n._initialValue)&&n.setValueAtTime(o.value,0),n}return Ec(e,t),e.getDefaults=function(){return Object.assign(Pc.getDefaults(),{convert:!0,units:"number"})},Object.defineProperty(e.prototype,"value",{get:function(){var t=this.now();return this.getValueAtTime(t)},set:function(t){this._initialValue=this._fromType(t),this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minValue",{get:function(){return"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxValue",{get:function(){return"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue},enumerable:!0,configurable:!0}),e.prototype._is=function(t,e){return this.units===e},e.prototype._fromType=function(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?lc(t):this._is(t,"frequency")?this.toFrequency(t):this._is(t,"normalRange")?Math.min(Math.max(t,0),1):this._is(t,"audioRange")?Math.min(Math.max(t,-1),1):this._is(t,"positive")?Math.max(t,0):(this._is(t,"number"),t):t},e.prototype._toType=function(t){return this.convert&&"decibels"===this.units?hc(t):t},e.prototype.setValueAtTime=function(t,e){var n=this.toSeconds(e),o=this._fromType(t);return this.assert(isFinite(o)&&isFinite(n),"Invalid argument(s) to setValueAtTime: "+JSON.stringify(t)+", "+JSON.stringify(e)),this.log(this.units,"setValue",t,n),this._events.add({time:n,type:"setValue",value:o}),this._param.setValueAtTime(o,n),this},e.prototype.getValueAtTime=function(t){var e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),o=this._events.get(e),r=this._initialValue;if(null===o)r=this._initialValue;else if("setTarget"!==o.type||null!==n&&"setValue"!==n.type)if(null===n)r=o.value;else if("linear"===n.type||"exponential"===n.type){var i=o.value;if("setTarget"===o.type){s=this._events.getBefore(o.time);i=null===s?this._initialValue:s.value}r="linear"===n.type?this._linearInterpolate(o.time,i,n.time,n.value,e):this._exponentialInterpolate(o.time,i,n.time,n.value,e)}else r=o.value;else{var s=this._events.getBefore(o.time),a=void 0;a=null===s?this._initialValue:s.value,ka(o.constant)&&(r=this._exponentialApproach(o.time,a,o.value,o.constant,e))}return this._toType(r)},e.prototype.setRampPoint=function(t){t=this.toSeconds(t);var e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this},e.prototype.linearRampToValueAtTime=function(t,e){var n=this._fromType(t),o=this.toSeconds(e);return this.assert(isFinite(n)&&isFinite(o),"Invalid argument(s) to linearRampToValueAtTime: "+JSON.stringify(t)+", "+JSON.stringify(e)),this._events.add({time:o,type:"linear",value:n}),this.log(this.units,"linear",t,o),this._param.linearRampToValueAtTime(n,o),this},e.prototype.exponentialRampToValueAtTime=function(t,e){var n=this._fromType(t);n=Math.max(this._minOutput,n);var o=this.toSeconds(e);return this.assert(isFinite(n)&&isFinite(o),"Invalid argument(s) to exponentialRampToValueAtTime: "+JSON.stringify(t)+", "+JSON.stringify(e)),this._events.add({time:o,type:"exponential",value:n}),this.log(this.units,"exponential",t,o),this._param.exponentialRampToValueAtTime(n,o),this},e.prototype.exponentialRampTo=function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this},e.prototype.linearRampTo=function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this},e.prototype.targetRampTo=function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this},e.prototype.exponentialApproachValueAtTime=function(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);var o=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,o),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this},e.prototype.setTargetAtTime=function(t,e,n){var o=this._fromType(t);this.assert(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");var r=this.toSeconds(e);return this.assert(isFinite(o)&&isFinite(r),"Invalid argument(s) to setTargetAtTime: "+JSON.stringify(t)+", "+JSON.stringify(e)),this._events.add({constant:n,time:r,type:"setTarget",value:o}),this.log(this.units,"setTarget",t,r,n),this._param.setTargetAtTime(o,r,n),this},e.prototype.setValueCurveAtTime=function(t,e,n,o){void 0===o&&(o=1),n=this.toSeconds(n),e=this.toSeconds(e);var r=this._fromType(t[0])*o;this.setValueAtTime(this._toType(r),e);for(var i=n/(t.length-1),s=1;s<t.length;s++){var a=this._fromType(t[s])*o;this.linearRampToValueAtTime(this._toType(a),e+s*i)}return this},e.prototype.cancelScheduledValues=function(t){var e=this.toSeconds(t);return this.assert(isFinite(e),"Invalid argument to cancelScheduledValues: "+JSON.stringify(t)),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancel",e),this},e.prototype.cancelAndHoldAtTime=function(t){var e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));this.assert(isFinite(e),"Invalid argument to cancelAndHoldAtTime: "+JSON.stringify(t)),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n),this._param.cancelScheduledValues(e);var o=this._events.get(e),r=this._events.getAfter(e);return o&&o.time===e?r?this._events.cancel(r.time):this._events.cancel(e+this.sampleTime):r&&(this._events.cancel(r.time),"linear"===r.type?this.linearRampToValueAtTime(this._toType(n),e):"exponential"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValue",value:n}),this._param.setValueAtTime(n,e),this},e.prototype.rampTo=function(t,e,n){return void 0===e&&(e=.1),"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._events.dispose(),this},e.prototype._exponentialApproach=function(t,e,n,o,r){return n+(e-n)*Math.exp(-(r-t)/o)},e.prototype._linearInterpolate=function(t,e,n,o,r){return e+(r-t)/(n-t)*(o-e)},e.prototype._exponentialInterpolate=function(t,e,n,o,r){return e*Math.pow(o/e,(r-t)/(n-t))},e}(Pc),jc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Dc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="AudioNode",e._internalChannels=[],e}return jc(e,t),Object.defineProperty(e.prototype,"numberOfInputs",{get:function(){return ka(this.input)?_a(this.input)||this.input instanceof Ic?1:this.input.numberOfInputs:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfOutputs",{get:function(){return ka(this.output)?this.output.numberOfOutputs:0},enumerable:!0,configurable:!0}),e.prototype._isAudioNode=function(t){return ka(t)&&(t instanceof e||ga(t))},e.prototype._getInternalNodes=function(){var t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t},e.prototype._setChannelProperties=function(t){var e=this._getInternalNodes();e.forEach((function(e){e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))},e.prototype._getChannelProperties=function(){var t=this._getInternalNodes();this.assert(t.length>0,"ToneAudioNode does not have any internal nodes");var e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}},Object.defineProperty(e.prototype,"channelCount",{get:function(){return this._getChannelProperties().channelCount},set:function(t){var e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"channelCountMode",{get:function(){return this._getChannelProperties().channelCountMode},set:function(t){var e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"channelInterpretation",{get:function(){return this._getChannelProperties().channelInterpretation},set:function(t){var e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))},enumerable:!0,configurable:!0}),e.prototype.connect=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),Rc(this,t,e,n),this},e.prototype.toDestination=function(){return this.connect(this.context.destination),this},e.prototype.toMaster=function(){return console.warn("toMaster() has been renamed toDestination()"),this.toDestination()},e.prototype.disconnect=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),Bc(this,t,e,n),this},e.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Nc.apply(void 0,[this].concat(t)),this},e.prototype.fan=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e.forEach((function(e){return t.connect(e)})),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),ka(this.input)&&(this.input instanceof e?this.input.dispose():ga(this.input)&&this.input.disconnect()),ka(this.output)&&(this.output instanceof e?this.output.dispose():ga(this.output)&&this.output.disconnect()),this._internalChannels=[],this},e}(Pc);function Nc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.shift();t.reduce((function(t,e){return t instanceof Dc?t.connect(e):ga(t)&&Rc(t,e),e}),n)}function Rc(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0),Fa(ka(t),"Cannot connect from undefined node"),Fa(ka(e),"Cannot connect to undefined node"),(e instanceof Dc||ga(e))&&Fa(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Fa(t.numberOfOutputs>0,"Cannot connect from node with no outputs");while(e instanceof Dc||e instanceof Ic)ka(e.input)&&(e=e.input);while(t instanceof Dc)ka(t.output)&&(t=t.output);_a(e)?t.connect(e,n):t.connect(e,n,o)}function Bc(t,e,n,o){if(void 0===n&&(n=0),void 0===o&&(o=0),ka(e))while(e instanceof Dc)e.input&&(e=e.input);while(!ga(t))ka(t.output)&&(t=t.output);_a(e)?t.disconnect(e,n):ga(e)?t.disconnect(e,n,o):t.disconnect()}function qc(t,e){Ma(e)?e.forEach((function(e){return qc(t,e)})):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Fc(t,e){Ma(e)?e.forEach((function(e){return Fc(t,e)})):Object.defineProperty(t,e,{writable:!0})}var Vc=function(){},Uc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Lc=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["gain","units"]))||this;n.name="Gain",n._gainNode=n.context.createGain(),n.input=n._gainNode,n.output=n._gainNode;var o=Na(e.getDefaults(),arguments,["gain","units"]);return n.gain=new Ic({context:n.context,convert:o.convert,param:n._gainNode.gain,units:o.units,value:o.gain}),qc(n,"gain"),n}return Uc(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{convert:!0,gain:1,units:"gain"})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._gainNode.disconnect(),this.gain.dispose(),this},e}(Dc),zc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Wc=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(s,a)}c((o=o.apply(t,e||[])).next())}))},Gc=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,o&&(r=2&i[0]?o["return"]:i[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},$c=function(t){function e(){var n=t.call(this)||this;n.name="ToneAudioBuffer",n.onload=Vc;var o=Na(e.getDefaults(),arguments,["url","onload","onerror"]);return n.reverse=o.reverse,n.onload=o.onload,o.url&&xa(o.url)||o.url instanceof e?n.set(o.url):Pa(o.url)&&n.load(o.url).catch(o.onerror),n}return zc(e,t),e.getDefaults=function(){return{onerror:Vc,onload:Vc,reverse:!1}},Object.defineProperty(e.prototype,"sampleRate",{get:function(){return this._buffer?this._buffer.sampleRate:sc().sampleRate},enumerable:!0,configurable:!0}),e.prototype.set=function(t){var n=this;return t instanceof e?t.loaded?this._buffer=t.get():t.onload=function(){n.set(t),n.onload(n)}:this._buffer=t,this._reversed&&this._reverse(),this},e.prototype.get=function(){return this._buffer},e.prototype.load=function(t){return Wc(this,void 0,void 0,(function(){var n,o,r,i;return Gc(this,(function(s){switch(s.label){case 0:n=e.load(t),e.downloads.push(n),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,n];case 2:return o=s.sent(),this.set(o),this.onload(this),[3,4];case 3:throw r=s.sent(),i=e.downloads.indexOf(n),e.downloads.splice(i,1),r;case 4:return[2,this]}}))}))},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._buffer=void 0,this},e.prototype.fromArray=function(t){for(var e=Ma(t)&&t[0].length>0,n=e?t.length:1,o=e?t[0].length:t.length,r=sc(),i=r.createBuffer(n,o,r.sampleRate),s=e||1!==n?t:[t],a=0;a<n;a++)i.copyToChannel(s[a],a);return this._buffer=i,this},e.prototype.toMono=function(t){if(Ta(t))this.fromArray(this.toArray(t));else{for(var e=new Float32Array(this.length),n=this.numberOfChannels,o=0;o<n;o++)for(var r=this.toArray(o),i=0;i<r.length;i++)e[i]+=r[i];e=e.map((function(t){return t/n})),this.fromArray(e)}return this},e.prototype.toArray=function(t){if(Ta(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);for(var e=[],n=0;n<this.numberOfChannels;n++)e[n]=this.getChannelData(n);return e},e.prototype.getChannelData=function(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)},e.prototype.slice=function(t,n){void 0===n&&(n=this.duration);var o=Math.floor(t*this.sampleRate),r=Math.floor(n*this.sampleRate);this.assert(o<r,"The start time must be less than the end time");for(var i=r-o,s=sc().createBuffer(this.numberOfChannels,i,this.sampleRate),a=0;a<this.numberOfChannels;a++)s.copyToChannel(this.getChannelData(a).subarray(o,r),a);return new e(s)},e.prototype._reverse=function(){if(this.loaded)for(var t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this},Object.defineProperty(e.prototype,"loaded",{get:function(){return this.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._buffer?this._buffer.duration:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._buffer?this._buffer.length:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfChannels",{get:function(){return this._buffer?this._buffer.numberOfChannels:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverse",{get:function(){return this._reversed},set:function(t){this._reversed!==t&&(this._reversed=t,this._reverse())},enumerable:!0,configurable:!0}),e.fromArray=function(t){return(new e).fromArray(t)},e.fromUrl=function(t){return Wc(this,void 0,void 0,(function(){var n;return Gc(this,(function(o){switch(o.label){case 0:return n=new e,[4,n.load(t)];case 1:return[2,o.sent()]}}))}))},e.load=function(t){return Wc(this,void 0,void 0,(function(){var n,o,r,i,s,a,c,u,l;return Gc(this,(function(h){switch(h.label){case 0:if(n=t.match(/\[(.+\|?)+\]$/),n){for(o=n[1].split("|"),r=o[0],i=0,s=o;i<s.length;i++)if(a=s[i],e.supportsType(a)){r=a;break}t=t.replace(n[0],r)}return[4,fetch(e.baseUrl+t)];case 1:if(c=h.sent(),!c.ok)throw new Error("could not load url: "+t);return[4,c.arrayBuffer()];case 2:return u=h.sent(),[4,sc().decodeAudioData(u)];case 3:return l=h.sent(),[2,l]}}))}))},e.supportsType=function(t){var e=t.split("."),n=e[e.length-1],o=document.createElement("audio").canPlayType("audio/"+n);return""!==o},e.loaded=function(){return Wc(this,void 0,void 0,(function(){var t,n,o;return Gc(this,(function(r){switch(r.label){case 0:t=0,n=e.downloads,r.label=1;case 1:return t<n.length?(o=n[t],[4,o]):[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.baseUrl="",e.downloads=[],e}(Ua),Yc=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(s,a)}c((o=o.apply(t,e||[])).next())}))},Qc=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,o&&(r=2&i[0]?o["return"]:i[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};function Hc(t,e,n,o){return void 0===n&&(n=2),void 0===o&&(o=sc().sampleRate),Yc(this,void 0,void 0,(function(){var r,i,s,a;return Qc(this,(function(c){switch(c.label){case 0:return r=sc(),i=new oc(n,e,o),ac(i),[4,t(i)];case 1:return c.sent(),s=i.render(),ac(r),[4,s];case 2:return a=c.sent(),[2,new $c(a)]}}))}))}var Xc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Jc=function(t){function e(){var n=t.call(this)||this;n.name="ToneAudioBuffers",n._buffers=new Map,n._loadingCount=0;var o=Na(e.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");n.baseUrl=o.baseUrl;return Object.keys(o.urls).forEach((function(t){n._loadingCount++;var e=o.urls[t];n.add(t,e,n._bufferLoaded.bind(n,o.onload))})),n}return Xc(e,t),e.getDefaults=function(){return{baseUrl:"",onerror:Vc,onload:Vc,urls:{}}},e.prototype.has=function(t){return this._buffers.has(t.toString())},e.prototype.get=function(t){return this.assert(this.has(t),"ToneAudioBuffers has no buffer named: "+t),this._buffers.get(t.toString())},e.prototype._bufferLoaded=function(t){this._loadingCount--,0===this._loadingCount&&t&&t()},Object.defineProperty(e.prototype,"loaded",{get:function(){return Array.from(this._buffers).every((function(t){t[0];var e=t[1];return e.loaded}))},enumerable:!0,configurable:!0}),e.prototype.add=function(t,e,n){return void 0===n&&(n=Vc),e instanceof $c?(this._buffers.set(t.toString(),e),n()):xa(e)?(this._buffers.set(t.toString(),new $c(e)),n()):Pa(e)&&this._buffers.set(t.toString(),new $c(this.baseUrl+e,n)),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._buffers.forEach((function(t){return t.dispose()})),this._buffers.clear(),this},e}(Ua),Zc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Kc=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["delayTime","maxDelay"]))||this;n.name="Delay";var o=Na(e.getDefaults(),arguments,["delayTime","maxDelay"]),r=n.toSeconds(o.maxDelay);return n.maxDelay=Math.max(r,n.toSeconds(o.delayTime)),n._delayNode=n.input=n.output=n.context.createDelay(r),n.delayTime=new Ic({context:n.context,param:n._delayNode.delayTime,units:"time",value:o.delayTime}),qc(n,"delayTime"),n}return Zc(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{delayTime:0,maxDelay:1})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._delayNode.disconnect(),this.delayTime.dispose(),this},e}(Dc),tu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),eu=function(t){function e(e){void 0===e&&(e="stopped");var n=t.call(this)||this;return n.name="StateTimeline",n._initial=e,n}return tu(e,t),e.prototype.getValueAtTime=function(t){var e=this.get(t);return null!==e?e.state:this._initial},e.prototype.setStateAtTime=function(t,e,n){return this.add(Object.assign({},n,{state:t,time:e})),this},e.prototype.getLastState=function(t,e){for(var n=this._search(e),o=n;o>=0;o--){var r=this._timeline[o];if(r.state===t)return r}},e.prototype.getNextState=function(t,e){var n=this._search(e);if(-1!==n)for(var o=n;o<this._timeline.length;o++){var r=this._timeline[o];if(r.state===t)return r}},e}(Ga),nu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ou=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["value"]))||this;n.name="TickSignal",n._events=new Ga(1/0),n._sig=n.context.createConstantSource(),n._param=n._sig.offset,n._multiplier=1;var o=Na(e.getDefaults(),arguments,["value"]);return n._sig=n.context.createConstantSource(),n._sig.start(0),n._param=n._sig.offset,n._multiplier=o.multiplier,n._events.cancel(0),n._events.add({ticks:0,time:0,type:"setValue",value:n._fromType(o.value)}),n.setValueAtTime(o.value,0),n}return nu(e,t),e.getDefaults=function(){return Object.assign(Ic.getDefaults(),{multiplier:1,param:sc().createConstantSource().offset,units:"hertz",value:1})},e.prototype.setTargetAtTime=function(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);for(var o=this._fromType(t),r=this._events.get(e),i=Math.round(Math.max(1/n,1)),s=0;s<=i;s++){var a=n*s+e,c=this._exponentialApproach(r.time,r.value,o,n,a);this.linearRampToValueAtTime(this._toType(c),a)}return this},e.prototype.setValueAtTime=function(e,n){var o=this.toSeconds(n);t.prototype.setValueAtTime.call(this,e,n);var r=this._events.get(o),i=this._events.previousEvent(r),s=this._getTicksUntilEvent(i,o);return r.ticks=Math.max(s,0),this},e.prototype.linearRampToValueAtTime=function(e,n){var o=this.toSeconds(n);t.prototype.linearRampToValueAtTime.call(this,e,n);var r=this._events.get(o),i=this._events.previousEvent(r),s=this._getTicksUntilEvent(i,o);return r.ticks=Math.max(s,0),this},e.prototype.exponentialRampToValueAtTime=function(t,e){e=this.toSeconds(e);for(var n=this._fromType(t),o=this._events.get(e),r=Math.round(Math.max(10*(e-o.time),1)),i=(e-o.time)/r,s=0;s<=r;s++){var a=i*s+o.time,c=this._exponentialInterpolate(o.time,o.value,e,n,a);this.linearRampToValueAtTime(this._toType(c),a)}return this},e.prototype._getTicksUntilEvent=function(t,e){if(null===t)t={ticks:0,time:0,type:"setValue",value:0};else if(Oa(t.ticks)){var n=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(n,t.time)}var o=this._fromType(this.getValueAtTime(t.time)),r=this._fromType(this.getValueAtTime(e)),i=this._events.get(e);return i&&i.time===e&&"setValue"===i.type&&(r=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(o+r)+t.ticks},e.prototype.getTicksAtTime=function(t){var e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)},e.prototype.getDurationOfTicks=function(t,e){var n=this.toSeconds(e),o=this.getTicksAtTime(e);return this.getTimeOfTick(o+t)-n},e.prototype.getTimeOfTick=function(t){var e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linear"===n.type&&e.value!==n.value){var o=this._fromType(this.getValueAtTime(e.time)),r=this._fromType(this.getValueAtTime(n.time)),i=(r-o)/(n.time-e.time),s=Math.sqrt(Math.pow(o,2)-2*i*(e.ticks-t)),a=(-o+s)/i,c=(-o-s)/i;return(a>0?a:c)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue},e.prototype.ticksToTime=function(t,e){return this.getDurationOfTicks(t,e)},e.prototype.timeToTicks=function(t,e){var n=this.toSeconds(e),o=this.toSeconds(t),r=this.getTicksAtTime(n),i=this.getTicksAtTime(n+o);return i-r},e.prototype._fromType=function(e){return"bpm"===this.units&&this.multiplier?1/(60/e/this.multiplier):t.prototype._fromType.call(this,e)},e.prototype._toType=function(e){return"bpm"===this.units&&this.multiplier?e/this.multiplier*60:t.prototype._toType.call(this,e)},Object.defineProperty(e.prototype,"multiplier",{get:function(){return this._multiplier},set:function(t){var e=this.value;this._multiplier=t,this.value=e},enumerable:!0,configurable:!0}),e.prototype.connect=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),Rc(this._sig,t,e,n),this},e}(Ic),ru=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),iu=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["frequency"]))||this;n.name="TickSource",n._state=new eu,n._tickOffset=new Ga;var o=Na(e.getDefaults(),arguments,["frequency"]);return n.frequency=new ou({context:n.context,units:o.units,value:n.toFrequency(o.frequency)}),qc(n,"frequency"),n._state.setStateAtTime("stopped",0),n.setTicksAtTime(0,0),n}return ru(e,t),e.getDefaults=function(){return Object.assign({frequency:1,units:"hertz"},Pc.getDefaults())},Object.defineProperty(e.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())},enumerable:!0,configurable:!0}),e.prototype.start=function(t,e){var n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),ka(e)&&this.setTicksAtTime(e,n)),this},e.prototype.stop=function(t){var e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){var n=this._state.get(e);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this},e.prototype.pause=function(t){var e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this},e.prototype.cancel=function(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this},e.prototype.getTicksAtTime=function(t){var e=this,n=this.toSeconds(t),o=this._state.getLastState("stopped",n);if(!o)return 0;var r={state:"paused",time:n};this._state.add(r);var i=o,s=0;return this._state.forEachBetween(o.time,n+this.sampleTime,(function(t){var n=i.time,o=e._tickOffset.get(t.time);o&&o.time>=i.time&&(s=o.ticks,n=o.time),"started"===i.state&&"started"!==t.state&&(s+=e.frequency.getTicksAtTime(t.time)-e.frequency.getTicksAtTime(n)),i=t})),this._state.remove(r),s},Object.defineProperty(e.prototype,"ticks",{get:function(){return this.getTicksAtTime(this.now())},set:function(t){this.setTicksAtTime(t,this.now())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seconds",{get:function(){return this.getSecondsAtTime(this.now())},set:function(t){var e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)},enumerable:!0,configurable:!0}),e.prototype.getSecondsAtTime=function(t){var e=this;t=this.toSeconds(t);var n=this._state.getLastState("stopped",t);if(!n)return 0;var o={state:"paused",time:t};this._state.add(o);var r=n,i=0;return this._state.forEachBetween(n.time,t+this.sampleTime,(function(t){var n=r.time,o=e._tickOffset.get(t.time);o&&o.time>=r.time&&(i=o.seconds,n=o.time),"started"===r.state&&"started"!==t.state&&(i+=t.time-n),r=t})),this._state.remove(o),i},e.prototype.setTicksAtTime=function(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this},e.prototype.getStateAtTime=function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)},e.prototype.getTimeOfTick=function(t,e){void 0===e&&(e=this.now());var n=this._tickOffset.get(e),o=this._state.get(e),r=Math.max(n.time,o.time),i=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(i)},e.prototype.forEachTickBetween=function(t,e,n){var o=this,r=this.toSeconds(t),i=this.toSeconds(e),s=this._state.get(r);this._state.forEachBetween(r,i,(function(t){s&&"started"===s.state&&"started"!==t.state&&o.forEachTickBetween(Math.max(s.time,r),t.time-o.sampleTime,n),s=t}));var a=null;if(s&&"started"===s.state&&this._state){var c=Math.max(s.time,r),u=this.frequency.getTicksAtTime(c),l=this.frequency.getTicksAtTime(s.time),h=u-l,p=h%1;0!==p&&(p=1-p);var f=this.frequency.getTimeOfTick(u+p);while(f<i&&this._state){try{n(f,Math.round(this.getTicksAtTime(f)))}catch(d){a=d;break}this._state&&(f+=this.frequency.getDurationOfTicks(1,f))}}if(a)throw a;return this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this},e}(Pc),su=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),au=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["callback","frequency"]))||this;n.name="Clock",n.callback=Vc,n._lastUpdate=0,n._state=new eu("stopped"),n._boundLoop=n._loop.bind(n);var o=Na(e.getDefaults(),arguments,["callback","frequency"]);return n.callback=o.callback,n._tickSource=new iu({context:n.context,frequency:o.frequency,units:o.units}),n._lastUpdate=0,n.frequency=n._tickSource.frequency,qc(n,"frequency"),n._state.setStateAtTime("stopped",0),n.context.on("tick",n._boundLoop),n}return su(e,t),e.getDefaults=function(){return Object.assign(Pc.getDefaults(),{callback:Vc,frequency:1,units:"hertz"})},Object.defineProperty(e.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())},enumerable:!0,configurable:!0}),e.prototype.start=function(t,e){this.context.resume();var n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this},e.prototype.stop=function(t){var e=this.toSeconds(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this},e.prototype.pause=function(t){var e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this},Object.defineProperty(e.prototype,"ticks",{get:function(){return Math.ceil(this.getTicksAtTime(this.now()))},set:function(t){this._tickSource.ticks=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seconds",{get:function(){return this._tickSource.seconds},set:function(t){this._tickSource.seconds=t},enumerable:!0,configurable:!0}),e.prototype.getSecondsAtTime=function(t){return this._tickSource.getSecondsAtTime(t)},e.prototype.setTicksAtTime=function(t,e){return this._tickSource.setTicksAtTime(t,e),this},e.prototype.getTicksAtTime=function(t){return this._tickSource.getTicksAtTime(t)},e.prototype.nextTickTime=function(t,e){var n=this.toSeconds(e),o=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(o+t,n)},e.prototype._loop=function(){var t=this,e=this._lastUpdate,n=this.now();this._lastUpdate=n,e!==n&&(this._state.forEachBetween(e,n,(function(e){switch(e.state){case"started":var n=t._tickSource.getTicksAtTime(e.time);t.emit("start",e.time,n);break;case"stopped":0!==e.time&&t.emit("stop",e.time);break;case"paused":t.emit("pause",e.time);break}})),this._tickSource.forEachTickBetween(e,n,(function(e,n){t.callback(e,n)})))},e.prototype.getStateAtTime=function(t){var e=this.toSeconds(t);return this._state.getValueAtTime(e)},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this},e}(Pc);za.mixin(au);var cu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),uu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Ticks",e.defaultUnits="i",e}return cu(e,t),e.prototype._now=function(){return this.context.transport.ticks},e.prototype._beatsToUnits=function(t){return this._getPPQ()*t},e.prototype._secondsToUnits=function(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())},e.prototype._ticksToUnits=function(t){return t},e.prototype.toTicks=function(){return this.valueOf()},e.prototype.toSeconds=function(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())},e}(Ac);var lu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),hu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Midi",e.defaultUnits="midi",e}return lu(e,t),e.prototype._frequencyToUnits=function(e){return mc(t.prototype._frequencyToUnits.call(this,e))},e.prototype._ticksToUnits=function(e){return mc(t.prototype._ticksToUnits.call(this,e))},e.prototype._beatsToUnits=function(e){return mc(t.prototype._beatsToUnits.call(this,e))},e.prototype._secondsToUnits=function(e){return mc(t.prototype._secondsToUnits.call(this,e))},e.prototype.toMidi=function(){return this.valueOf()},e.prototype.toFrequency=function(){return _c(this.toMidi())},e.prototype.transpose=function(t){return new e(this.context,this.toMidi()+t)},e}(kc);var pu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),fu=(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Draw",e.expiration=.25,e.anticipation=.008,e._events=new Ga,e._boundDrawLoop=e._drawLoop.bind(e),e._animationFrame=-1,e}pu(e,t),e.prototype.schedule=function(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this},e.prototype.cancel=function(t){return this._events.cancel(this.toSeconds(t)),this},e.prototype._drawLoop=function(){var t=this.context.currentTime;while(this._events.length&&this._events.peek().time-this.anticipation<=t){var e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}(Pc),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),du=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="IntervalTimeline",e._root=null,e._length=0,e}return fu(e,t),e.prototype.add=function(t){this.assert(ka(t.time),"Events must have a time property"),this.assert(ka(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();var e=new yu(t.time,t.time+t.duration,t);null===this._root?this._root=e:this._root.insert(e),this._length++;while(null!==e)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this},e.prototype.remove=function(t){if(null!==this._root){var e=[];this._root.search(t.time,e);for(var n=0,o=e;n<o.length;n++){var r=o[n];if(r.event===t){this._removeNode(r),this._length--;break}}}return this},Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),e.prototype.cancel=function(t){var e=this;return this.forEachFrom(t,(function(t){return e.remove(t)})),this},e.prototype._setRoot=function(t){this._root=t,null!==this._root&&(this._root.parent=null)},e.prototype._replaceNodeInParent=function(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)},e.prototype._removeNode=function(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{var e=t.getBalance(),n=void 0,o=null;if(e>0)if(null===t.left.right)n=t.left,n.right=t.right,o=n;else{n=t.left.right;while(null!==n.right)n=n.right;n.parent&&(n.parent.right=n.left,o=n.parent,n.left=t.left,n.right=t.right)}else if(null===t.right.left)n=t.right,n.left=t.left,o=n;else{n=t.right.left;while(null!==n.left)n=n.left;n.parent&&(n.parent.left=n.right,o=n.parent,n.left=t.left,n.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=n:t.parent.right=n:this._setRoot(n),o&&this._rebalance(o)}t.dispose()},e.prototype._rotateLeft=function(t){var e=t.parent,n=t.isLeftChild(),o=t.right;o&&(t.right=o.left,o.left=t),null!==e?n?e.left=o:e.right=o:this._setRoot(o)},e.prototype._rotateRight=function(t){var e=t.parent,n=t.isLeftChild(),o=t.left;o&&(t.left=o.right,o.right=t),null!==e?n?e.left=o:e.right=o:this._setRoot(o)},e.prototype._rebalance=function(t){var e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))},e.prototype.get=function(t){if(null!==this._root){var e=[];if(this._root.search(t,e),e.length>0){for(var n=e[0],o=1;o<e.length;o++)e[o].low>n.low&&(n=e[o]);return n.event}}return null},e.prototype.forEach=function(t){if(null!==this._root){var e=[];this._root.traverse((function(t){return e.push(t)})),e.forEach((function(e){e.event&&t(e.event)}))}return this},e.prototype.forEachAtTime=function(t,e){if(null!==this._root){var n=[];this._root.search(t,n),n.forEach((function(t){t.event&&e(t.event)}))}return this},e.prototype.forEachFrom=function(t,e){if(null!==this._root){var n=[];this._root.searchAfter(t,n),n.forEach((function(t){t.event&&e(t.event)}))}return this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),null!==this._root&&this._root.traverse((function(t){return t.dispose()})),this._root=null,this},e}(Ua),yu=function(){function t(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}return t.prototype.insert=function(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)},t.prototype.search=function(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))},t.prototype.searchAfter=function(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)},t.prototype.traverse=function(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)},t.prototype.updateHeight=function(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0},t.prototype.updateMax=function(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))},t.prototype.getBalance=function(){var t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t},t.prototype.isLeftChild=function(){return null!==this.parent&&this.parent.left===this},Object.defineProperty(t.prototype,"left",{get:function(){return this._left},set:function(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this._right},set:function(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.parent=null,this._left=null,this._right=null,this.event=null},t}(),mu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),vu=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["volume"]))||this;n.name="Volume";var o=Na(e.getDefaults(),arguments,["volume"]);return n.input=n.output=new Lc({context:n.context,gain:o.volume,units:"decibels"}),n.volume=n.output.gain,qc(n,"volume"),n._unmutedVolume=o.volume,n.mute=o.mute,n}return mu(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{mute:!1,volume:0})},Object.defineProperty(e.prototype,"mute",{get:function(){return this.volume.value===-1/0},set:function(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.input.dispose(),this.volume.dispose(),this},e}(Dc),_u=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),gu=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments))||this;n.name="Destination",n.input=new vu({context:n.context}),n.output=new Lc({context:n.context}),n.volume=n.input.volume;var o=Na(e.getDefaults(),arguments);return Nc(n.input,n.output,n.context.rawContext.destination),n.mute=o.mute,n}return _u(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{mute:!1,volume:0})},Object.defineProperty(e.prototype,"mute",{get:function(){return this.input.mute},set:function(t){this.input.mute=t},enumerable:!0,configurable:!0}),e.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Nc.apply(void 0,t),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.volume.dispose(),this},e}(Dc);Ya((function(t){t.destination=new gu({context:t})})),Xa((function(t){t.destination.dispose()}));var bu=function(){function t(e,n){this.id=t._eventId++;var o=Object.assign(t.getDefaults(),n);this.transport=e,this.callback=o.callback,this._once=o.once,this.time=o.time}return t.getDefaults=function(){return{callback:Vc,once:!1,time:0}},t.prototype.invoke=function(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))},t.prototype.dispose=function(){return this.callback=void 0,this},t._eventId=0,t}(),wu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),xu=function(t){function e(n,o){var r=t.call(this,n,o)||this;r._currentId=-1,r._nextId=-1,r._nextTick=r.time,r._boundRestart=r._restart.bind(r);var i=Object.assign(e.getDefaults(),o);return r.duration=new uu(n.context,i.duration).valueOf(),r._interval=new uu(n.context,i.interval).valueOf(),r._nextTick=i.time,r.transport.on("start",r._boundRestart),r.transport.on("loopStart",r._boundRestart),r.context=r.transport.context,r._restart(),r}return wu(e,t),e.getDefaults=function(){return Object.assign({},bu.getDefaults(),{duration:1/0,interval:1,once:!1})},e.prototype.invoke=function(e){this._createEvents(e),t.prototype.invoke.call(this,e)},e.prototype._createEvents=function(t){var e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new uu(this.context,this._nextTick).toSeconds()))},e.prototype._restart=function(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;var e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new uu(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new uu(this.context,this._nextTick).toSeconds())},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this},e}(bu),Ou=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ku=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments))||this;n.name="Transport",n.loop=!1,n._loopStart=0,n._loopEnd=0,n._scheduledEvents={},n._timeline=new Ga,n._repeatedEvents=new du,n._syncedSignals=[],n._swingAmount=0;var o=Na(e.getDefaults(),arguments);return n._ppq=o.ppq,n._clock=new au({callback:n._processTick.bind(n),context:n.context,frequency:0,units:"bpm"}),n._bindClockEvents(),n.bpm=n._clock.frequency,n._clock.frequency.multiplier=o.ppq,n.bpm.value=o.bpm,qc(n,"bpm"),n._timeSignature=o.timeSignature,n._swingTicks=o.ppq/2,n}return Ou(e,t),e.getDefaults=function(){return Object.assign(Pc.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})},e.prototype._processTick=function(t,e){if(this._swingAmount>0&&e%this._ppq!==0&&e%(2*this._swingTicks)!==0){var n=e%(2*this._swingTicks)/(2*this._swingTicks),o=Math.sin(n*Math.PI)*this._swingAmount;t+=new uu(this.context,2*this._swingTicks/3).toSeconds()*o}this.loop&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._timeline.forEachAtTime(e,(function(e){return e.invoke(t)}))},e.prototype.schedule=function(t,e){var n=new bu(this,{callback:t,time:new Ac(this.context,e).toTicks()});return this._addEvent(n,this._timeline)},e.prototype.scheduleRepeat=function(t,e,n,o){void 0===o&&(o=1/0);var r=new xu(this,{callback:t,duration:new xc(this.context,o).toTicks(),interval:new xc(this.context,e).toTicks(),time:new Ac(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)},e.prototype.scheduleOnce=function(t,e){var n=new bu(this,{callback:t,once:!0,time:new Ac(this.context,e).toTicks()});return this._addEvent(n,this._timeline)},e.prototype.clear=function(t){if(this._scheduledEvents.hasOwnProperty(t)){var e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this},e.prototype._addEvent=function(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id},e.prototype.cancel=function(t){var e=this;void 0===t&&(t=0);var n=this.toTicks(t);return this._timeline.forEachFrom(n,(function(t){return e.clear(t.id)})),this._repeatedEvents.forEachFrom(n,(function(t){return e.clear(t.id)})),this},e.prototype._bindClockEvents=function(){var t=this;this._clock.on("start",(function(e,n){n=new uu(t.context,n).toSeconds(),t.emit("start",e,n)})),this._clock.on("stop",(function(e){t.emit("stop",e)})),this._clock.on("pause",(function(e){t.emit("pause",e)}))},Object.defineProperty(e.prototype,"state",{get:function(){return this._clock.getStateAtTime(this.now())},enumerable:!0,configurable:!0}),e.prototype.start=function(t,e){var n;return ka(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this},e.prototype.stop=function(t){return this._clock.stop(t),this},e.prototype.pause=function(t){return this._clock.pause(t),this},e.prototype.toggle=function(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this},Object.defineProperty(e.prototype,"timeSignature",{get:function(){return this._timeSignature},set:function(t){Ma(t)&&(t=t[0]/t[1]*4),this._timeSignature=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopStart",{get:function(){return new xc(this.context,this._loopStart,"i").toSeconds()},set:function(t){this._loopStart=this.toTicks(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopEnd",{get:function(){return new xc(this.context,this._loopEnd,"i").toSeconds()},set:function(t){this._loopEnd=this.toTicks(t)},enumerable:!0,configurable:!0}),e.prototype.setLoopPoints=function(t,e){return this.loopStart=t,this.loopEnd=e,this},Object.defineProperty(e.prototype,"swing",{get:function(){return this._swingAmount},set:function(t){this._swingAmount=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"swingSubdivision",{get:function(){return new uu(this.context,this._swingTicks).toNotation()},set:function(t){this._swingTicks=this.toTicks(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){var t=this.now(),e=this._clock.getTicksAtTime(t);return new uu(this.context,e).toBarsBeatsSixteenths()},set:function(t){var e=this.toTicks(t);this.ticks=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seconds",{get:function(){return this._clock.seconds},set:function(t){var e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"progress",{get:function(){if(this.loop){var t=this.now(),e=this._clock.getTicksAtTime(t);return(e-this._loopStart)/(this._loopEnd-this._loopStart)}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ticks",{get:function(){return this._clock.ticks},set:function(t){if(this._clock.ticks!==t){var e=this.now();"started"===this.state?(this.emit("stop",e),this._clock.setTicksAtTime(t,e),this.emit("start",e,this.seconds)):this._clock.setTicksAtTime(t,e)}},enumerable:!0,configurable:!0}),e.prototype.getTicksAtTime=function(t){return Math.round(this._clock.getTicksAtTime(t))},e.prototype.getSecondsAtTime=function(t){return this._clock.getSecondsAtTime(t)},Object.defineProperty(e.prototype,"PPQ",{get:function(){return this._clock.frequency.multiplier},set:function(t){this._clock.frequency.multiplier=t},enumerable:!0,configurable:!0}),e.prototype.nextSubdivision=function(t){if(t=this.toTicks(t),"started"!==this.state)return 0;var e=this.now(),n=this.getTicksAtTime(e),o=t-n%t;return this._clock.nextTickTime(o,e)},e.prototype.syncSignal=function(t,e){if(!e){var n=this.now();if(0!==t.getValueAtTime(n)){var o=this.bpm.getValueAtTime(n),r=1/(60/o/this.PPQ);e=t.getValueAtTime(n)/r}else e=0}var i=new Lc(e);return this.bpm.connect(i),i.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:i,signal:t}),t.value=0,this},e.prototype.unsyncSignal=function(t){for(var e=this._syncedSignals.length-1;e>=0;e--){var n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._clock.dispose(),Fc(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this},e}(Pc);za.mixin(ku),Ya((function(t){t.transport=new ku({context:t})})),Xa((function(t){t.transport.dispose()}));n("5586");var Cu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Tu=function(t){function e(e){var n=t.call(this,e)||this;return n.input=void 0,n._state=new eu("stopped"),n._synced=!1,n._scheduled=[],n._syncedStart=Vc,n._syncedStop=Vc,n._state.memory=100,n._volume=n.output=new vu({context:n.context,mute:e.mute,volume:e.volume}),n.volume=n._volume.volume,qc(n,"volume"),n.onstop=e.onstop,n}return Cu(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{mute:!1,onstop:Vc,volume:0})},Object.defineProperty(e.prototype,"state",{get:function(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mute",{get:function(){return this._volume.mute},set:function(t){this._volume.mute=t},enumerable:!0,configurable:!0}),e.prototype._clampToCurrentTime=function(t){return this._synced?t:Math.max(t,this.context.currentTime)},e.prototype.start=function(t,e,n){var o=this,r=Oa(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(r=this._clampToCurrentTime(r),this.log("start",r),"started"===this._state.getValueAtTime(r))this._state.cancel(r),this._state.setStateAtTime("started",r),this.restart(r,e,n);else if(this._state.setStateAtTime("started",r),this._synced){var i=this._state.get(r);i&&(i.offset=this.toSeconds(Ba(e,0)),i.duration=n?this.toSeconds(n):void 0);var s=this.context.transport.schedule((function(t){o._start(t,e,n)}),r);this._scheduled.push(s),"started"===this.context.transport.state&&this._syncedStart(this.now(),this.context.transport.seconds)}else this._start(r,e,n);return this},e.prototype.stop=function(t){var e=Oa(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),this.log("stop",e),this._synced){var n=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(n)}else this._stop(e);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this},e.prototype.sync=function(){var t=this;return this._synced||(this._synced=!0,this._syncedStart=function(e,n){if(n>0){var o=t._state.get(n);if(o&&"started"===o.state&&o.time!==n){var r=n-t.toSeconds(o.time),i=void 0;o.duration&&(i=t.toSeconds(o.duration)-r),t._start(e,t.toSeconds(o.offset)+r,i)}}},this._syncedStop=function(e){var n=t.context.transport.getSecondsAtTime(Math.max(e-t.sampleTime,0));"started"===t._state.getValueAtTime(n)&&t._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this},e.prototype.unsync=function(){var t=this;return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((function(e){return t.context.transport.clear(e)})),this._scheduled=[],this._state.cancel(0),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.onstop=Vc,this.unsync(),this._volume.dispose(),this._state.dispose(),this},e}(Dc),Su=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Au=function(t){function e(e){var n=t.call(this,e)||this;return n.onended=Vc,n._startTime=-1,n._stopTime=-1,n._timeout=-1,n.output=new Lc({context:n.context,gain:0}),n._gainNode=n.output,n.getStateAtTime=function(t){var e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},n._fadeIn=e.fadeIn,n._fadeOut=e.fadeOut,n._curve=e.curve,n.onended=e.onended,n}return Su(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Vc})},e.prototype._startGain=function(t,e){void 0===e&&(e=1),this.assert(-1===this._startTime,"Source cannot be started more than once");var n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this},e.prototype.stop=function(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this},e.prototype._stopGain=function(t){var e=this;this.assert(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();var n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+n,this._stopTime=Math.max(this._stopTime,this.context.currentTime),n>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,n,t):this._gainNode.gain.targetRampTo(0,n,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((function(){var t="exponential"===e._curve?2*n:0;e._stopSource(e.now()+t),e._onended()}),this._stopTime-this.context.now()),this},e.prototype._onended=function(){var t=this;this.onended!==Vc&&(this.onended(this),this.onended=Vc,setTimeout((function(){return t.dispose()}),1e3))},Object.defineProperty(e.prototype,"state",{get:function(){return this.getStateAtTime(this.now())},enumerable:!0,configurable:!0}),e.prototype.cancelStop=function(){return this.log("cancelStop"),this.assert(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._gainNode.disconnect(),this},e}(Dc),Mu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pu=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["buffer","onload"]))||this;n.name="ToneBufferSource",n._source=n.context.createBufferSource(),n._internalChannels=[n._source],n._sourceStarted=!1,n._sourceStopped=!1;var o=Na(e.getDefaults(),arguments,["buffer","onload"]);return Rc(n._source,n._gainNode),n._source.onended=function(){return n._stopSource()},n.playbackRate=new Ic({context:n.context,param:n._source.playbackRate,units:"positive",value:o.playbackRate}),n.loop=o.loop,n.loopStart=o.loopStart,n.loopEnd=o.loopEnd,n._buffer=new $c(o.buffer,o.onload),n._internalChannels.push(n._source),n}return Mu(e,t),e.getDefaults=function(){return Object.assign(Au.getDefaults(),{buffer:new $c,loop:!1,loopEnd:0,loopStart:0,onload:Vc,playbackRate:1})},Object.defineProperty(e.prototype,"fadeIn",{get:function(){return this._fadeIn},set:function(t){this._fadeIn=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fadeOut",{get:function(){return this._fadeOut},set:function(t){this._fadeOut=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curve",{get:function(){return this._curve},set:function(t){this._curve=t},enumerable:!0,configurable:!0}),e.prototype.start=function(t,e,n,o){void 0===o&&(o=1),this.assert(this.buffer.loaded,"buffer is either not set or not loaded");var r=this.toSeconds(t);this._startGain(r,o),e=this.loop?Ba(e,this.loopStart):Ba(e,0);var i=Math.max(this.toSeconds(e),0);if(this.loop){var s=this.toSeconds(this.loopEnd)||this.buffer.duration,a=this.toSeconds(this.loopStart),c=s-a;i>=s&&(i=(i-a)%c+a)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,i<this.buffer.duration&&(this._sourceStarted=!0,this._source.start(r,i)),ka(n)){var u=this.toSeconds(n);u=Math.max(u,0),this.stop(r+u)}return this},e.prototype._stopSource=function(t){this._sourceStopped||(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())},Object.defineProperty(e.prototype,"loopStart",{get:function(){return this._source.loopStart},set:function(t){this._source.loopStart=this.toSeconds(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopEnd",{get:function(){return this._source.loopEnd},set:function(t){this._source.loopEnd=this.toSeconds(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this._buffer},set:function(t){this._buffer.set(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._source.loop},set:function(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this},e}(Au),Eu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Iu=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["type"]))||this;n.name="Noise",n._source=null;var o=Na(e.getDefaults(),arguments,["type"]);return n._playbackRate=o.playbackRate,n.type=o.type,n._fadeIn=o.fadeIn,n._fadeOut=o.fadeOut,n}return Eu(e,t),e.getDefaults=function(){return Object.assign(Tu.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){if(this.assert(t in Ru,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){var e=this.now();this._stop(e),this._start(e)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)},enumerable:!0,configurable:!0}),e.prototype._start=function(t){var e=this,n=Ru[this._type];this._source=new Pu({buffer:n,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:function(){return e.onstop(e)},playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(n.duration-.001))},e.prototype._stop=function(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)},Object.defineProperty(e.prototype,"fadeIn",{get:function(){return this._fadeIn},set:function(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fadeOut",{get:function(){return this._fadeOut},set:function(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)},enumerable:!0,configurable:!0}),e.prototype.restart=function(t){return this._stop(t),this._start(t),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._source&&this._source.disconnect(),this},e}(Tu),ju=220500,Du=2,Nu={brown:null,pink:null,white:null},Ru={get brown(){if(!Nu.brown){for(var t=[],e=0;e<Du;e++){var n=new Float32Array(ju);t[e]=n;for(var o=0,r=0;r<ju;r++){var i=2*Math.random()-1;n[r]=(o+.02*i)/1.02,o=n[r],n[r]*=3.5}}Nu.brown=(new $c).fromArray(t)}return Nu.brown},get pink(){if(!Nu.pink){for(var t=[],e=0;e<Du;e++){var n=new Float32Array(ju);t[e]=n;var o=void 0,r=void 0,i=void 0,s=void 0,a=void 0,c=void 0,u=void 0;o=r=i=s=a=c=u=0;for(var l=0;l<ju;l++){var h=2*Math.random()-1;o=.99886*o+.0555179*h,r=.99332*r+.0750759*h,i=.969*i+.153852*h,s=.8665*s+.3104856*h,a=.55*a+.5329522*h,c=-.7616*c-.016898*h,n[l]=o+r+i+s+a+c+u+.5362*h,n[l]*=.11,u=.115926*h}}Nu.pink=(new $c).fromArray(t)}return Nu.pink},get white(){if(!Nu.white){for(var t=[],e=0;e<Du;e++){var n=new Float32Array(ju);t[e]=n;for(var o=0;o<ju;o++)n[o]=2*Math.random()-1}Nu.white=(new $c).fromArray(t)}return Nu.white}},Bu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),qu=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["value","units"]))||this;n.name="Signal",n.override=!0,n._constantSource=n.context.createConstantSource(),n.output=n._constantSource;var o=Na(e.getDefaults(),arguments,["value","units"]);return n._constantSource.start(0),n.input=n._param=new Ic({context:n.context,convert:o.convert,param:n._constantSource.offset,units:o.units,value:o.value}),n}return Bu(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",convert:!0,units:"number",value:0})},e.prototype.connect=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),Fu(this,t,e,n),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._param.dispose(),this._constantSource.stop(this.now()),this._constantSource.disconnect(),this},e.prototype.setValueAtTime=function(t,e){return this._param.setValueAtTime(t,e),this},e.prototype.getValueAtTime=function(t){return this._param.getValueAtTime(t)},e.prototype.setRampPoint=function(t){return this._param.setRampPoint(t),this},e.prototype.linearRampToValueAtTime=function(t,e){return this._param.linearRampToValueAtTime(t,e),this},e.prototype.exponentialRampToValueAtTime=function(t,e){return this._param.exponentialRampToValueAtTime(t,e),this},e.prototype.exponentialRampTo=function(t,e,n){return this._param.exponentialRampTo(t,e,n),this},e.prototype.linearRampTo=function(t,e,n){return this._param.linearRampTo(t,e,n),this},e.prototype.targetRampTo=function(t,e,n){return this._param.targetRampTo(t,e,n),this},e.prototype.exponentialApproachValueAtTime=function(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this},e.prototype.setTargetAtTime=function(t,e,n){return this._param.setTargetAtTime(t,e,n),this},e.prototype.setValueCurveAtTime=function(t,e,n,o){return this._param.setValueCurveAtTime(t,e,n,o),this},e.prototype.cancelScheduledValues=function(t){return this._param.cancelScheduledValues(t),this},e.prototype.cancelAndHoldAtTime=function(t){return this._param.cancelAndHoldAtTime(t),this},e.prototype.rampTo=function(t,e,n){return this._param.rampTo(t,e,n),this},Object.defineProperty(e.prototype,"value",{get:function(){return this._param.value},set:function(t){this._param.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"convert",{get:function(){return this._param.convert},set:function(t){this._param.convert=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"units",{get:function(){return this._param.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overridden",{get:function(){return this._param.overridden},set:function(t){this._param.overridden=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxValue",{get:function(){return this._param.maxValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minValue",{get:function(){return this._param.minValue},enumerable:!0,configurable:!0}),e}(Dc);function Fu(t,e,n,o){(e instanceof Ic||_a(e)||e instanceof qu&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof qu&&(e.overridden=!0)),Rc(t,e,n,o)}var Vu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Uu=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["frequency","type"]))||this;n.name="ToneOscillatorNode",n._oscillator=n.context.createOscillator(),n._internalChannels=[n._oscillator];var o=Na(e.getDefaults(),arguments,["frequency","type"]);return Rc(n._oscillator,n._gainNode),n.type=o.type,n.frequency=new Ic({context:n.context,param:n._oscillator.frequency,units:"frequency",value:o.frequency}),n.detune=new Ic({context:n.context,param:n._oscillator.detune,units:"cents",value:o.detune}),n}return Vu(e,t),e.getDefaults=function(){return Object.assign(Au.getDefaults(),{detune:0,frequency:440,type:"sine"})},e.prototype.start=function(t){var e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this},e.prototype._stopSource=function(t){this._oscillator.stop(t)},e.prototype.setPeriodicWave=function(t){return this._oscillator.setPeriodicWave(t),this},Object.defineProperty(e.prototype,"type",{get:function(){return this._oscillator.type},set:function(t){this._oscillator.type=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this},e}(Au),Lu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),zu=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["frequency","type"]))||this;n.name="Oscillator",n._oscillator=null;var o=Na(e.getDefaults(),arguments,["frequency","type"]);return n.frequency=new qu({context:n.context,units:"frequency",value:o.frequency}),qc(n,"frequency"),n.detune=new qu({context:n.context,units:"cents",value:o.detune}),qc(n,"detune"),n._partials=o.partials,n._partialCount=o.partialCount,n._type=o.type,o.partialCount&&"custom"!==o.type&&(n._type=n.baseType+o.partialCount.toString()),n.phase=o.phase,n}return Lu(e,t),e.getDefaults=function(){return Object.assign(Tu.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})},e.prototype._start=function(t){var e=this,n=this.toSeconds(t),o=new Uu({context:this.context,onended:function(){return e.onstop(e)}});this._oscillator=o,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)},e.prototype._stop=function(t){var e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)},e.prototype.restart=function(t){var e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this},e.prototype.syncFrequency=function(){return this.context.transport.syncSignal(this.frequency),this},e.prototype.unsyncFrequency=function(){return this.context.transport.unsyncSignal(this.frequency),this},e.prototype._getCachedPeriodicWave=function(){var t=this;if("custom"===this._type){var n=e._periodicWaveCache.find((function(e){return e.phase===t._phase&&Da(e.partials,t._partials)}));return n&&[n.real,n.imag]}n=e._periodicWaveCache.find((function(e){return e.type===t._type&&e.phase===t._phase}));return this._partialCount=n?n.partialCount:this._partialCount,n&&[n.real,n.imag]},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t;var n=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&n)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{var o=this._getCachedPeriodicWave();if(ka(o)){var r=o[0],i=o[1];this._wave=this.context.createPeriodicWave(r,i),null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{var s=this._getRealImaginary(t,this._phase),a=(r=s[0],i=s[1],this.context.createPeriodicWave(r,i));this._wave=a,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),e._periodicWaveCache.push({imag:i,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:r,type:this._type}),e._periodicWaveCache.length>100&&e._periodicWaveCache.shift()}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseType",{get:function(){return this._type.replace(this.partialCount.toString(),"")},set:function(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partialCount",{get:function(){return this._partialCount},set:function(t){var e=this._type,n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);n&&(e=n[1]),"custom"!==this._type&&(this.type=0===t?e:e+t.toString())},enumerable:!0,configurable:!0}),e.prototype.get=function(){var e=t.prototype.get.call(this);return"custom"!==e.type&&delete e.partials,e},e.prototype._getRealImaginary=function(t,e){var n=4096,o=n/2,r=new Float32Array(o),i=new Float32Array(o),s=1;if("custom"===t){if(s=this._partials.length+1,this._partialCount=this._partials.length,o=s,0===this._partials.length)return[r,i]}else{var a=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);a?(s=parseInt(a[2],10)+1,this._partialCount=parseInt(a[2],10),t=a[1],s=Math.max(s,2),o=s):this._partialCount=0,this._partials=[]}for(var c=1;c<o;++c){var u=2/(c*Math.PI),l=void 0;switch(t){case"sine":l=c<=s?1:0,this._partials[c-1]=l;break;case"square":l=1&c?2*u:0,this._partials[c-1]=l;break;case"sawtooth":l=u*(1&c?1:-1),this._partials[c-1]=l;break;case"triangle":l=1&c?u*u*2*(c-1>>1&1?-1:1):0,this._partials[c-1]=l;break;case"custom":l=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==l?(r[c]=-l*Math.sin(e*c),i[c]=l*Math.cos(e*c)):(r[c]=0,i[c]=0)}return[r,i]},e.prototype._inverseFFT=function(t,e,n){for(var o=0,r=t.length,i=0;i<r;i++)o+=t[i]*Math.cos(i*n)+e[i]*Math.sin(i*n);return o},e.prototype._getInitialValue=function(){for(var t=this._getRealImaginary(this._type,0),e=t[0],n=t[1],o=0,r=2*Math.PI,i=0;i<8;i++)o=Math.max(this._inverseFFT(e,n,i/8*r),o);return-this._inverseFFT(e,n,this._phase)/o},Object.defineProperty(e.prototype,"partials",{get:function(){return this._partials},set:function(t){this._partials=t,t.length&&(this.type="custom")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"phase",{get:function(){return this._phase*(180/Math.PI)},set:function(t){this._phase=t*Math.PI/180,this.type=this._type},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this},e._periodicWaveCache=[],e}(Tu),Wu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Gu=function(t){function e(){return t.call(this,Object.assign(Na(e.getDefaults(),arguments,["context"])))||this}return Wu(e,t),e.prototype.connect=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),Fu(this,t,e,n),this},e}(Dc),$u=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Yu=function(t){function e(){var n=t.call(this,Object.assign(Na(e.getDefaults(),arguments,["mapping","length"])))||this;n.name="WaveShaper",n._shaper=n.context.createWaveShaper(),n.input=n._shaper,n.output=n._shaper;var o=Na(e.getDefaults(),arguments,["mapping","length"]);return Ma(o.mapping)||o.mapping instanceof Float32Array?n.curve=Float32Array.from(o.mapping):Ca(o.mapping)&&n.setMap(o.mapping,o.length),n}return $u(e,t),e.getDefaults=function(){return Object.assign(qu.getDefaults(),{length:1024})},e.prototype.setMap=function(t,e){void 0===e&&(e=1024);for(var n=new Float32Array(e),o=0,r=e;o<r;o++){var i=o/(r-1)*2-1;n[o]=t(i,o)}return this.curve=n,this},Object.defineProperty(e.prototype,"curve",{get:function(){return this._shaper.curve},set:function(t){this._shaper.curve=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){var e=["none","2x","4x"].some((function(e){return e.includes(t)}));this.assert(e,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._shaper.disconnect(),this},e}(Gu),Qu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Hu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="AudioToGain",e._norm=new Yu({context:e.context,mapping:function(t){return(t+1)/2}}),e.input=e._norm,e.output=e._norm,e}return Qu(e,t),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._norm.dispose(),this},e}(Gu),Xu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ju=function(t){function e(){var n=t.call(this,Object.assign(Na(e.getDefaults(),arguments,["value"])))||this;n.name="Multiply",n.override=!1,n._mult=new Lc({context:n.context}),n.input=n._mult,n.output=n._mult;var o=Na(e.getDefaults(),arguments,["value"]);return n.factor=n._param=n._mult.gain,n.factor.setValueAtTime(o.value,0),n}return Xu(e,t),e.getDefaults=function(){return Object.assign(qu.getDefaults(),{value:0})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._mult.dispose(),this},e}(qu),Zu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ku=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["frequency","type","modulationType"]))||this;n.name="AMOscillator",n._modulationScale=new Hu({context:n.context}),n._modulationNode=new Lc({context:n.context});var o=Na(e.getDefaults(),arguments,["frequency","type","modulationType"]);return n._carrier=new zu({context:n.context,detune:o.detune,frequency:o.frequency,onstop:function(){return n.onstop(n)},phase:o.phase,type:o.type}),n.frequency=n._carrier.frequency,n.detune=n._carrier.detune,n._modulator=new zu({context:n.context,phase:o.phase,type:o.modulationType}),n.harmonicity=new Ju({context:n.context,units:"positive",value:o.harmonicity}),n.frequency.chain(n.harmonicity,n._modulator.frequency),n._modulator.chain(n._modulationScale,n._modulationNode.gain),n._carrier.chain(n._modulationNode,n.output),qc(n,["frequency","detune","harmonicity"]),n}return Zu(e,t),e.getDefaults=function(){return Object.assign(zu.getDefaults(),{harmonicity:1,modulationType:"square"})},e.prototype._start=function(t){this._modulator.start(t),this._carrier.start(t)},e.prototype._stop=function(t){this._modulator.stop(t),this._carrier.stop(t)},e.prototype.restart=function(t){return this._modulator.restart(t),this._carrier.restart(t),this},Object.defineProperty(e.prototype,"type",{get:function(){return this._carrier.type},set:function(t){this._carrier.type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseType",{get:function(){return this._carrier.baseType},set:function(t){this._carrier.baseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partialCount",{get:function(){return this._carrier.partialCount},set:function(t){this._carrier.partialCount=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modulationType",{get:function(){return this._modulator.type},set:function(t){this._modulator.type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"phase",{get:function(){return this._carrier.phase},set:function(t){this._carrier.phase=t,this._modulator.phase=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partials",{get:function(){return this._carrier.partials},set:function(t){this._carrier.partials=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this},e}(Tu),tl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),el=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["frequency","type","modulationType"]))||this;n.name="FMOscillator",n._modulationNode=new Lc({context:n.context,gain:0});var o=Na(e.getDefaults(),arguments,["frequency","type","modulationType"]);return n._carrier=new zu({context:n.context,detune:o.detune,frequency:0,onstop:function(){return n.onstop(n)},phase:o.phase,type:o.type}),n.detune=n._carrier.detune,n.frequency=new qu({context:n.context,units:"frequency",value:o.frequency}),n._modulator=new zu({context:n.context,phase:o.phase,type:o.modulationType}),n.harmonicity=new Ju({context:n.context,units:"positive",value:o.harmonicity}),n.modulationIndex=new Ju({context:n.context,units:"positive",value:o.modulationIndex}),n.frequency.connect(n._carrier.frequency),n.frequency.chain(n.harmonicity,n._modulator.frequency),n.frequency.chain(n.modulationIndex,n._modulationNode),n._modulator.connect(n._modulationNode.gain),n._modulationNode.connect(n._carrier.frequency),n._carrier.connect(n.output),n.detune.connect(n._modulator.detune),qc(n,["modulationIndex","frequency","detune","harmonicity"]),n}return tl(e,t),e.getDefaults=function(){return Object.assign(zu.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})},e.prototype._start=function(t){this._modulator.start(t),this._carrier.start(t)},e.prototype._stop=function(t){this._modulator.stop(t),this._carrier.stop(t)},e.prototype.restart=function(t){return this._modulator.restart(t),this._carrier.restart(t),this},Object.defineProperty(e.prototype,"type",{get:function(){return this._carrier.type},set:function(t){this._carrier.type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseType",{get:function(){return this._carrier.baseType},set:function(t){this._carrier.baseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partialCount",{get:function(){return this._carrier.partialCount},set:function(t){this._carrier.partialCount=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modulationType",{get:function(){return this._modulator.type},set:function(t){this._modulator.type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"phase",{get:function(){return this._carrier.phase},set:function(t){this._carrier.phase=t,this._modulator.phase=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partials",{get:function(){return this._carrier.partials},set:function(t){this._carrier.partials=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this},e}(Tu),nl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ol=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["frequency","width"]))||this;n.name="PulseOscillator",n._widthGate=new Lc({context:n.context,gain:0}),n._thresh=new Yu({context:n.context,mapping:function(t){return t<=0?-1:1}});var o=Na(e.getDefaults(),arguments,["frequency","width"]);return n.width=new qu({context:n.context,units:"audioRange",value:o.width}),n._sawtooth=new zu({context:n.context,detune:o.detune,frequency:o.frequency,onstop:function(){return n.onstop(n)},phase:o.phase,type:"sawtooth"}),n.frequency=n._sawtooth.frequency,n.detune=n._sawtooth.detune,n._sawtooth.chain(n._thresh,n.output),n.width.chain(n._widthGate,n._thresh),qc(n,["width","frequency","detune"]),n}return nl(e,t),e.getDefaults=function(){return Object.assign(Tu.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})},e.prototype._start=function(t){t=this.toSeconds(t),this._sawtooth.start(t),this._widthGate.gain.setValueAtTime(1,t)},e.prototype._stop=function(t){t=this.toSeconds(t),this._sawtooth.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)},e.prototype.restart=function(t){var e=this.toSeconds(t);return this._sawtooth.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e),this},Object.defineProperty(e.prototype,"phase",{get:function(){return this._sawtooth.phase},set:function(t){this._sawtooth.phase=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return"pulse"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseType",{get:function(){return"pulse"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partials",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partialCount",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._sawtooth.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this},e}(Tu),rl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),il=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["frequency","type","spread"]))||this;n.name="FatOscillator",n._oscillators=[];var o=Na(e.getDefaults(),arguments,["frequency","type","spread"]);return n.frequency=new qu({context:n.context,units:"frequency",value:o.frequency}),n.detune=new qu({context:n.context,units:"cents",value:o.detune}),n._spread=o.spread,n._type=o.type,n._phase=o.phase,n._partials=o.partials,n._partialCount=o.partialCount,n.count=o.count,qc(n,["frequency","detune"]),n}return rl(e,t),e.getDefaults=function(){return Object.assign(zu.getDefaults(),{count:3,spread:20,type:"sawtooth"})},e.prototype._start=function(t){t=this.toSeconds(t),this._forEach((function(e){return e.start(t)}))},e.prototype._stop=function(t){t=this.toSeconds(t),this._forEach((function(e){return e.stop(t)}))},e.prototype.restart=function(t){return t=this.toSeconds(t),this._forEach((function(e){return e.restart(t)})),this},e.prototype._forEach=function(t){for(var e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this._forEach((function(e){return e.type=t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spread",{get:function(){return this._spread},set:function(t){if(this._spread=t,this._oscillators.length>1){var e=-t/2,n=t/(this._oscillators.length-1);this._forEach((function(t,o){return t.detune.value=e+n*o}))}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this._oscillators.length},set:function(t){var e=this;if(t=Math.max(t,1),this._oscillators.length!==t){this._forEach((function(t){return t.dispose()})),this._oscillators=[];for(var n=0;n<t;n++){var o=new zu({context:this.context,onstop:0===n?function(){return e.onstop(e)}:Vc});"custom"===this.type?o.partials=this._partials:o.type=this._type,o.partialCount=this._partialCount,o.phase=this._phase+n/t*360,o.volume.value=-6-1.1*t,this.frequency.connect(o.frequency),this.detune.connect(o.detune),o.connect(this.output),this._oscillators[n]=o}this.spread=this._spread,"started"===this.state&&this._forEach((function(t){return t.start()}))}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"phase",{get:function(){return this._phase},set:function(t){this._phase=t,this._forEach((function(e){return e.phase=t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseType",{get:function(){return this._oscillators[0].baseType},set:function(t){this._forEach((function(e){return e.baseType=t})),this._type=this._oscillators[0].type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partials",{get:function(){return this._oscillators[0].partials},set:function(t){this._partials=t,t.length&&(this._type="custom",this._forEach((function(e){return e.partials=t})))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partialCount",{get:function(){return this._oscillators[0].partialCount},set:function(t){this._partialCount=t,this._forEach((function(e){return e.partialCount=t})),this._type=this._oscillators[0].type},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.frequency.dispose(),this.detune.dispose(),this._forEach((function(t){return t.dispose()})),this},e}(Tu),sl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),al=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["frequency","modulationFrequency"]))||this;n.name="PWMOscillator",n.sourceType="pwm",n._scale=new Ju({context:n.context,value:2});var o=Na(e.getDefaults(),arguments,["frequency","modulationFrequency"]);return n._pulse=new ol({context:n.context,frequency:o.modulationFrequency}),n._pulse._sawtooth.type="sine",n.modulationFrequency=n._pulse.frequency,n._modulator=new zu({context:n.context,detune:o.detune,frequency:o.frequency,onstop:function(){return n.onstop(n)},phase:o.phase}),n.frequency=n._modulator.frequency,n.detune=n._modulator.detune,n._modulator.chain(n._scale,n._pulse.width),n._pulse.connect(n.output),qc(n,["modulationFrequency","frequency","detune"]),n}return sl(e,t),e.getDefaults=function(){return Object.assign(Tu.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})},e.prototype._start=function(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)},e.prototype._stop=function(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)},e.prototype.restart=function(t){return this._modulator.restart(t),this._pulse.restart(t),this},Object.defineProperty(e.prototype,"type",{get:function(){return"pwm"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseType",{get:function(){return"pwm"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partials",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partialCount",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"phase",{get:function(){return this._modulator.phase},set:function(t){this._modulator.phase=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this},e}(Tu),cl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ul={am:Ku,fat:il,fm:el,oscillator:zu,pulse:ol,pwm:al},ll=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["frequency","type"]))||this;n.name="OmniOscillator";var o=Na(e.getDefaults(),arguments,["frequency","type"]);return n.frequency=new qu({context:n.context,units:"frequency",value:o.frequency}),n.detune=new qu({context:n.context,units:"cents",value:o.detune}),qc(n,["frequency","detune"]),n.set(o),n}return cl(e,t),e.getDefaults=function(){return Object.assign(zu.getDefaults(),el.getDefaults(),Ku.getDefaults(),il.getDefaults(),ol.getDefaults(),al.getDefaults())},e.prototype._start=function(t){this._oscillator.start(t)},e.prototype._stop=function(t){this._oscillator.stop(t)},e.prototype.restart=function(t){return this._oscillator.restart(t),this},Object.defineProperty(e.prototype,"type",{get:function(){var t=this,e="";return["am","fm","fat"].some((function(e){return t._sourceType===e}))&&(e=this._sourceType),e+this._oscillator.type},set:function(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partials",{get:function(){return this._oscillator.partials},set:function(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partialCount",{get:function(){return this._oscillator.partialCount},set:function(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)},enumerable:!0,configurable:!0}),e.prototype.set=function(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),t.prototype.set.call(this,e),this},e.prototype.get=function(){var t=this._oscillator.get();return t.type=this.type,t},e.prototype._createNewOscillator=function(t){var e=this;if(t!==this._sourceType){this._sourceType=t;var n=ul[t],o=this.now();if(this._oscillator){var r=this._oscillator;r.stop(o),this.context.setTimeout((function(){return r.dispose()}),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=function(){return e.onstop(e)},"started"===this.state&&this._oscillator.start(o)}},Object.defineProperty(e.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(t){this._oscillator.phase=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sourceType",{get:function(){return this._sourceType},set:function(t){var e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")},enumerable:!0,configurable:!0}),e.prototype._getOscType=function(t,e){return t instanceof ul[e]},Object.defineProperty(e.prototype,"baseType",{get:function(){return this._oscillator.baseType},set:function(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0},set:function(t){this._getOscType(this._oscillator,"fat")&&Ta(t)&&(this._oscillator.count=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spread",{get:function(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0},set:function(t){this._getOscType(this._oscillator,"fat")&&Ta(t)&&(this._oscillator.spread=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modulationType",{get:function(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0},set:function(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Pa(t)&&(this._oscillator.modulationType=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modulationIndex",{get:function(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"harmonicity",{get:function(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modulationFrequency",{get:function(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this},e}(Tu),hl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),pl=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(s,a)}c((o=o.apply(t,e||[])).next())}))},fl=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,o&&(r=2&i[0]?o["return"]:i[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},dl=(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["url","onload"]))||this;n.name="Player",n._activeSources=new Set;var o=Na(e.getDefaults(),arguments,["url","onload"]);return n._buffer=new $c({onload:n._onload.bind(n,o.onload),reverse:o.reverse,url:o.url}),n.autostart=o.autostart,n._loop=o.loop,n._loopStart=o.loopStart,n._loopEnd=o.loopEnd,n._playbackRate=o.playbackRate,n.fadeIn=o.fadeIn,n.fadeOut=o.fadeOut,n}hl(e,t),e.getDefaults=function(){return Object.assign(Tu.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Vc,playbackRate:1,reverse:!1})},e.prototype.load=function(t){return pl(this,void 0,void 0,(function(){return fl(this,(function(e){switch(e.label){case 0:return[4,this._buffer.load(t)];case 1:return e.sent(),this._onload(),[2,this]}}))}))},e.prototype._onload=function(t){void 0===t&&(t=Vc),t(),this.autostart&&this.start()},e.prototype._onSourceEnd=function(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||this._state.setStateAtTime("stopped",this.now())},e.prototype.start=function(e,n,o){return t.prototype.start.call(this,e,n,o),this},e.prototype._start=function(t,e,n){e=this._loop?Ba(e,this._loopStart):Ba(e,0);var o=this.toSeconds(e);this._synced&&(o*=this._playbackRate);var r=n;n=Ba(n,Math.max(this._buffer.duration-o,0));var i=this.toSeconds(n);i/=this._playbackRate,t=this.toSeconds(t);var s=new Pu({buffer:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||this._state.setStateAtTime("stopped",t+i,{implicitEnd:!0}),this._activeSources.add(s),this._loop&&Oa(r)?s.start(t,o):s.start(t,o,i-this.toSeconds(this.fadeOut))},e.prototype._stop=function(t){var e=this.toSeconds(t);this._activeSources.forEach((function(t){return t.stop(e)}))},e.prototype.restart=function(t,e,n){return this._stop(t),this._start(t,e,n),this},e.prototype.seek=function(t,e){var n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){var o=this.toSeconds(t);this._stop(n),this._start(n,o)}return this},e.prototype.setLoopPoints=function(t,e){return this.loopStart=t,this.loopEnd=e,this},Object.defineProperty(e.prototype,"loopStart",{get:function(){return this._loopStart},set:function(t){this._loopStart=t,this._activeSources.forEach((function(e){e.loopStart=t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(t){this._loopEnd=t,this._activeSources.forEach((function(e){e.loopEnd=t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this._buffer},set:function(t){this._buffer.set(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((function(e){e.loop=t})),t)){var e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t;var e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((function(t){return t.cancelStop()}))),this._activeSources.forEach((function(n){n.playbackRate.setValueAtTime(t,e)}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverse",{get:function(){return this._buffer.reverse},set:function(t){this._buffer.reverse=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loaded",{get:function(){return this._buffer.loaded},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._activeSources.forEach((function(t){return t.dispose()})),this._activeSources.clear(),this._buffer.dispose(),this}}(Tu),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),yl=function(t){function e(){var n=t.call(this,Object.assign(Na(e.getDefaults(),arguments,["value"])))||this;return n.override=!1,n.name="Add",n._sum=new Lc({context:n.context}),n.input=n._sum,n.output=n._sum,n.addend=n._param,Nc(n._constantSource,n._sum),n}return dl(e,t),e.getDefaults=function(){return Object.assign(qu.getDefaults(),{value:0})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._sum.dispose(),this},e}(qu),ml=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),vl=(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Abs",e._abs=new Yu({context:e.context,mapping:function(t){return Math.abs(t)<.001?0:Math.abs(t)}}),e.input=e._abs,e.output=e._abs,e}ml(e,t),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._abs.dispose(),this}}(Gu),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),_l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="GainToAudio",e._norm=new Yu({context:e.context,mapping:function(t){return 2*Math.abs(t)-1}}),e.input=e._norm,e.output=e._norm,e}return vl(e,t),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._norm.dispose(),this},e}(Gu),gl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),bl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Negate",e._multiply=new Ju({context:e.context,value:-1}),e.input=e._multiply,e.output=e._multiply,e}return gl(e,t),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._multiply.dispose(),this},e}(Gu),wl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),xl=(function(t){function e(){var n=t.call(this,Object.assign(Na(e.getDefaults(),arguments,["value"])))||this;return n.override=!1,n.name="Subtract",n._sum=new Lc({context:n.context}),n.input=n._sum,n.output=n._sum,n._neg=new bl({context:n.context}),n.subtrahend=n._param,Nc(n._constantSource,n._neg,n._sum),n}wl(e,t),e.getDefaults=function(){return Object.assign(qu.getDefaults(),{value:0})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._neg.dispose(),this._sum.dispose(),this}}(qu),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),Ol=(function(t){function e(){var n=t.call(this,Object.assign(Na(e.getDefaults(),arguments)))||this;return n.name="Zero",n._gain=new Lc({context:n.context}),n.output=n._gain,n.input=void 0,Rc(n.context.getConstant(0),n._gain),n}xl(e,t),e.prototype.dispose=function(){return t.prototype.dispose.call(this),Bc(this.context.getConstant(0),this._gain),this}}(Gu),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),kl=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["attack","decay","sustain","release"]))||this;n.name="Envelope",n._sig=new qu({context:n.context,value:0}),n.output=n._sig,n.input=void 0;var o=Na(e.getDefaults(),arguments,["attack","decay","sustain","release"]);return n.attack=o.attack,n.decay=o.decay,n.sustain=o.sustain,n.release=o.release,n.attackCurve=o.attackCurve,n.releaseCurve=o.releaseCurve,n.decayCurve=o.decayCurve,n}return Ol(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})},Object.defineProperty(e.prototype,"value",{get:function(){return this.getValueAtTime(this.now())},enumerable:!0,configurable:!0}),e.prototype._getCurve=function(t,e){if(Pa(t))return t;var n=void 0;for(n in Cl)if(Cl[n][e]===t)return n;return t},e.prototype._setCurve=function(t,e,n){if(Pa(n)&&Reflect.has(Cl,n)){var o=Cl[n];Sa(o)?"_decayCurve"!==t&&(this[t]=o[e]):this[t]=o}else{if(!Ma(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}},Object.defineProperty(e.prototype,"attackCurve",{get:function(){return this._getCurve(this._attackCurve,"In")},set:function(t){this._setCurve("_attackCurve","In",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"releaseCurve",{get:function(){return this._getCurve(this._releaseCurve,"Out")},set:function(t){this._setCurve("_releaseCurve","Out",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"decayCurve",{get:function(){return this._decayCurve},set:function(t){this.assert(["linear","exponential"].some((function(e){return e===t})),"Invalid envelope curve: "+t),this._decayCurve=t},enumerable:!0,configurable:!0}),e.prototype.triggerAttack=function(t,e){void 0===e&&(e=1),this.log("triggerAttack",t,e),t=this.toSeconds(t);var n=this.toSeconds(this.attack),o=n,r=this.toSeconds(this.decay),i=this.getValueAtTime(t);if(i>0){var s=1/o,a=1-i;o=a/s}if(0===o)this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,o,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,o,t);else{this._sig.cancelAndHoldAtTime(t);for(var c=this._attackCurve,u=1;u<c.length;u++)if(c[u-1]<=i&&i<=c[u]){c=this._attackCurve.slice(u),c[0]=i;break}this._sig.setValueCurveAtTime(c,t,o,e)}if(r){var l=e*this.sustain,h=t+o;this.log("decay",h),"linear"===this._decayCurve?this._sig.linearRampTo(l,r,h+this.sampleTime):(this.assert("exponential"===this._decayCurve,'decayCurve can only be "linear" or "exponential", got '+this._decayCurve),this._sig.exponentialApproachValueAtTime(l,h,r))}return this},e.prototype.triggerRelease=function(t){this.log("triggerRelease",t),t=this.toSeconds(t);var e=this.getValueAtTime(t);if(e>0){var n=this.toSeconds(this.release);"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(this.assert(Ma(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this},e.prototype.getValueAtTime=function(t){return this._sig.getValueAtTime(t)},e.prototype.triggerAttackRelease=function(t,e,n){return void 0===n&&(n=1),e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this},e.prototype.cancel=function(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this},e.prototype.connect=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),Fu(this,t,e,n),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._sig.dispose(),this},e}(Dc),Cl=function(){var t,e,n=128,o=[];for(t=0;t<n;t++)o[t]=Math.sin(t/(n-1)*(Math.PI/2));var r=[],i=6.4;for(t=0;t<n-1;t++){e=t/(n-1);var s=Math.sin(e*(2*Math.PI)*i-Math.PI/2)+1;r[t]=s/10+.83*e}r[n-1]=1;var a=[],c=5;for(t=0;t<n;t++)a[t]=Math.ceil(t/(n-1)*c)/c;var u=[];for(t=0;t<n;t++)e=t/(n-1),u[t]=.5*(1-Math.cos(Math.PI*e));var l=[];for(t=0;t<n;t++){e=t/(n-1);var h=4*Math.pow(e,3)+.2,p=Math.cos(h*Math.PI*2*e);l[t]=Math.abs(p*(1-e))}function f(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=1-t[n];return e}function d(t){return t.slice(0).reverse()}return{bounce:{In:f(l),Out:l},cosine:{In:o,Out:d(o)},exponential:"exponential",linear:"linear",ripple:{In:r,Out:f(r)},sine:{In:u,Out:f(u)},step:{In:a,Out:f(a)}}}(),Tl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Sl=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["attack","decay","sustain","release"]))||this;return n.name="AmplitudeEnvelope",n._gainNode=new Lc({context:n.context,gain:0}),n.output=n._gainNode,n.input=n._gainNode,n._sig.connect(n._gainNode.gain),n.output=n._gainNode,n.input=n._gainNode,n}return Tl(e,t),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._gainNode.dispose(),this},e}(kl),Al=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ml=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments))||this;n._scheduledEvents=[],n._synced=!1,n._original_triggerAttack=n.triggerAttack,n._original_triggerRelease=n.triggerRelease;var o=Na(e.getDefaults(),arguments);return n._volume=n.output=new vu({context:n.context,volume:o.volume}),n.volume=n._volume.volume,qc(n,"volume"),n}return Al(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{volume:0})},e.prototype.sync=function(){return this._synced||(this._synced=!0,this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this},e.prototype._syncMethod=function(t,e){var n=this,o=this["_original_"+t]=this[t];this[t]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=t[e],s=n.context.transport.schedule((function(r){t[e]=r,o.apply(n,t)}),i);n._scheduledEvents.push(s)}},e.prototype.unsync=function(){var t=this;return this._scheduledEvents.forEach((function(e){return t.context.transport.clear(e)})),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this},e.prototype.triggerAttackRelease=function(t,e,n,o){var r=this.toSeconds(n),i=this.toSeconds(e);return this.triggerAttack(t,r,o),this.triggerRelease(r+i),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this},e}(Dc),Pl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),El=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments))||this,o=Na(e.getDefaults(),arguments);return n.portamento=o.portamento,n.onsilence=o.onsilence,n}return Pl(e,t),e.getDefaults=function(){return Object.assign(Ml.getDefaults(),{detune:0,onsilence:Vc,portamento:0})},e.prototype.triggerAttack=function(t,e,n){void 0===n&&(n=1),this.log("triggerAttack",t,e,n);var o=this.toSeconds(e);return this._triggerEnvelopeAttack(o,n),this.setNote(t,o),this},e.prototype.triggerRelease=function(t){this.log("triggerRelease",t);var e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this},e.prototype.getLevelAtTime=function(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)},e.prototype.setNote=function(t,e){var n=this.toSeconds(e),o=t instanceof kc?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){var r=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(o,r,n)}else this.frequency.setValueAtTime(o,n);return this},e}(Ml),Il=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),jl=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments))||this;n.name="Synth";var o=Na(e.getDefaults(),arguments);return n.oscillator=new ll(Object.assign({context:n.context,detune:o.detune,onstop:function(){return n.onsilence(n)}},o.oscillator)),n.frequency=n.oscillator.frequency,n.detune=n.oscillator.detune,n.envelope=new Sl(Object.assign({context:n.context},o.envelope)),n.oscillator.chain(n.envelope,n.output),qc(n,["oscillator","frequency","detune","envelope"]),n}return Il(e,t),e.getDefaults=function(){return Object.assign(El.getDefaults(),{envelope:Object.assign(qa(kl.getDefaults(),Object.keys(Dc.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(qa(ll.getDefaults(),Object.keys(Tu.getDefaults()).concat(["frequency","detune"])),{type:"triangle"})})},e.prototype._triggerEnvelopeAttack=function(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){var n=this.toSeconds(this.envelope.attack),o=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+n+o)}},e.prototype._triggerEnvelopeRelease=function(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.oscillator.dispose(),this.envelope.dispose(),this},e}(El),Dl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Nl=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"))||this;n.name="Sampler",n._activeSources=new Map;var o=Na(e.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),r={};return Object.keys(o.urls).forEach((function(t){var e=parseInt(t,10);if(n.assert(Ea(t)||Ta(e)&&isFinite(e),"url key is neither a note or midi pitch: "+t),Ea(t)){var i=new kc(n.context,t).toMidi();r[i]=o.urls[t]}else Ta(e)&&isFinite(e)&&(r[e]=o.urls[e])})),n._buffers=new Jc(r,o.onload,o.baseUrl),n.attack=o.attack,n.release=o.release,n.curve=o.curve,n}return Dl(e,t),e.getDefaults=function(){return Object.assign(Ml.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Vc,release:.1,urls:{}})},e.prototype._findClosest=function(t){var e=96,n=0;while(n<e){if(this._buffers.has(t+n))return-n;if(this._buffers.has(t-n))return n;n++}throw new Error("No available buffers for note: "+t)},e.prototype.triggerAttack=function(t,e,n){var o=this;return void 0===n&&(n=1),this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((function(t){var r=new kc(o.context,t).toMidi(),i=o._findClosest(r),s=r-i,a=o._buffers.get(s),c=pc(i),u=new Pu({buffer:a,context:o.context,curve:o.curve,fadeIn:o.attack,fadeOut:o.release,playbackRate:c}).connect(o.output);u.start(e,0,a.duration/c,n),Ma(o._activeSources.get(r))||o._activeSources.set(r,[]),o._activeSources.get(r).push(u),u.onended=function(){if(o._activeSources&&o._activeSources.has(r)){var t=o._activeSources.get(r),e=t.indexOf(u);-1!==e&&t.splice(e,1)}}})),this},e.prototype.triggerRelease=function(t,e){var n=this;return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((function(t){var o=new kc(n.context,t).toMidi();if(n._activeSources.has(o)&&n._activeSources.get(o).length){var r=n._activeSources.get(o);e=n.toSeconds(e),r.forEach((function(t){t.stop(e)})),n._activeSources.set(o,[])}})),this},e.prototype.releaseAll=function(t){var e=this.toSeconds(t);return this._activeSources.forEach((function(t){while(t.length){var n=t.shift();n.stop(e)}})),this},e.prototype.sync=function(){return this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this},e.prototype.triggerAttackRelease=function(t,e,n,o){var r=this;void 0===o&&(o=1);var i=this.toSeconds(n);return this.triggerAttack(t,i,o),Ma(e)?(this.assert(Ma(t),"notes must be an array when duration is array"),t.forEach((function(t,n){var o=e[Math.min(n,e.length-1)];r.triggerRelease(t,i+r.toSeconds(o))}))):this.triggerRelease(t,i+this.toSeconds(e)),this},e.prototype.add=function(t,e,n){if(this.assert(Ea(t)||isFinite(t),"note must be a pitch or midi: "+t),Ea(t)){var o=new kc(this.context,t).toMidi();this._buffers.add(o,e,n)}else this._buffers.add(t,e,n);return this},Object.defineProperty(e.prototype,"loaded",{get:function(){return this._buffers.loaded},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._buffers.dispose(),this._activeSources.forEach((function(t){t.forEach((function(t){return t.dispose()}))})),this._activeSources.clear(),this},e}(Ml),Rl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Bl=(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["voice","options"]))||this;n.name="PolySynth",n._availableVoices=[],n._activeVoices=[],n._voices=[],n._gcTimeout=-1,n._averageActiveVoices=0;var o=Na(e.getDefaults(),arguments,["voice","options"]);n.assert(!Ta(o.voice),"DEPRECATED: The polyphony count is no longer the first argument.");var r=o.voice.getDefaults();return n.options=Object.assign(r,o.options),n.voice=o.voice,n.maxPolyphony=o.maxPolyphony,n._collectGarbage(),n}Rl(e,t),e.getDefaults=function(){return Object.assign(Ml.getDefaults(),{maxPolyphony:32,options:{},voice:jl})},Object.defineProperty(e.prototype,"activeVoices",{get:function(){return this._activeVoices.length},enumerable:!0,configurable:!0}),e.prototype._getActiveVoice=function(t){var e=this._activeVoices.find((function(e){var n=e.midi;return n===t}));if(e)return e.voice},e.prototype._makeVoiceAvailable=function(t){this._availableVoices.push(t);var e=this._activeVoices.findIndex((function(e){return e.voice===t}));this._activeVoices.splice(e,1)},e.prototype._getNextAvailableVoice=function(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){var t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}console.warn("Max polyphony exceeded. Note dropped.")},e.prototype._collectGarbage=function(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>this._averageActiveVoices){var t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),t.dispose()}this._gcTimeout=this.context.setTimeout(this._collectGarbage.bind(this),1)},e.prototype._triggerAttack=function(t,e,n){var o=this;t.forEach((function(t){var r=new hu(o.context,t).toMidi(),i=o._getActiveVoice(r);if(i&&i.getLevelAtTime(e)>0){var s=o._activeVoices.findIndex((function(t){return t.voice===i}));o._activeVoices.splice(s,1)}else i=o._getNextAvailableVoice();i&&(i.triggerAttack(t,e,n),o._activeVoices.unshift({midi:r,voice:i}),o.log("triggerAttack",t,e))}))},e.prototype._triggerRelease=function(t,e){var n=this;t.forEach((function(t){var o=new hu(n.context,t).toMidi(),r=n._getActiveVoice(o);r&&(r.triggerRelease(e),n.log("triggerRelease",t,e))}))},e.prototype._scheduleEvent=function(t,e,n,o){var r=this;this.assert(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,o):this._triggerRelease(e,n):this.context.setTimeout((function(){r._scheduleEvent(t,e,n,o)}),n-this.now())},e.prototype.triggerAttack=function(t,e,n){Array.isArray(t)||(t=[t]);var o=this.toSeconds(e);return this._scheduleEvent("attack",t,o,n),this},e.prototype.triggerRelease=function(t,e){Array.isArray(t)||(t=[t]);var n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this},e.prototype.triggerAttackRelease=function(t,e,n,o){var r=this.toSeconds(n);if(this.triggerAttack(t,r,o),Ma(e)){this.assert(Ma(t),"If the duration is an array, the notes must also be an array"),t=t;for(var i=0;i<t.length;i++){var s=e[Math.min(i,e.length-1)],a=this.toSeconds(s);this.assert(a>0,"The duration must be greater than 0"),this.triggerRelease(t[i],r+a)}}else{a=this.toSeconds(e);this.assert(a>0,"The duration must be greater than 0"),this.triggerRelease(t,r+a)}return this},e.prototype.sync=function(){return this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this},e.prototype.set=function(t){var e=this;return this.options=ja(this.options,t),this._voices.forEach((function(t){return t.set(e.options)})),this},e.prototype.get=function(){return Object.assign({},this.options)},e.prototype.releaseAll=function(){var t=this.now();return this._activeVoices.forEach((function(e){var n=e.voice;n.triggerRelease(t)})),this._activeVoices=[],this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._voices.forEach((function(t){return t.dispose()})),this._activeVoices=[],this._availableVoices=[],this.context.clearTimeout(this._gcTimeout),this}}(Ml),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),ql=(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments))||this;n.name="MembraneSynth",n.portamento=0;var o=Na(e.getDefaults(),arguments);return n.pitchDecay=o.pitchDecay,n.octaves=o.octaves,qc(n,["oscillator","envelope"]),n}Bl(e,t),e.getDefaults=function(){return ja(El.getDefaults(),jl.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})},e.prototype.setNote=function(t,e){var n=this.toSeconds(e),o=this.toFrequency(t instanceof kc?t.toFrequency():t),r=o*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(o,n+this.toSeconds(this.pitchDecay)),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this}}(jl),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),Fl=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["frequency","type","rolloff"]))||this;n.name="Filter",n.input=new Lc({context:n.context}),n.output=new Lc({context:n.context}),n._filters=[];var o=Na(e.getDefaults(),arguments,["frequency","type","rolloff"]);return n._filters=[],n.Q=new qu({context:n.context,units:"positive",value:o.Q}),n.frequency=new qu({context:n.context,units:"frequency",value:o.frequency}),n.detune=new qu({context:n.context,units:"cents",value:o.detune}),n.gain=new qu({context:n.context,units:"decibels",value:o.gain}),n._type=o.type,n.rolloff=o.rolloff,qc(n,["detune","frequency","gain","Q"]),n}return ql(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){var e=["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"];this.assert(-1!==e.indexOf(t),"Invalid filter type: "+t),this._type=t,this._filters.forEach((function(e){return e.type=t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rolloff",{get:function(){return this._rolloff},set:function(t){var e=Ta(t)?t:parseInt(t,10),n=[-12,-24,-48,-96],o=n.indexOf(e);this.assert(-1!==o,"rolloff can only be "+n.join(", ")),o+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach((function(t){return t.disconnect()})),this._filters=new Array(o);for(var r=0;r<o;r++){var i=this.context.createBiquadFilter();i.type=this._type,this.frequency.connect(i.frequency),this.detune.connect(i.detune),this.Q.connect(i.Q),this.gain.connect(i.gain),this._filters[r]=i}this._internalChannels=this._filters,Nc.apply(void 0,[this.input].concat(this._internalChannels,[this.output]))},enumerable:!0,configurable:!0}),e.prototype.getFrequencyResponse=function(t){var e=this;void 0===t&&(t=128);for(var n=new Float32Array(t).map((function(){return 1})),o=new Float32Array(t),r=0;r<t;r++){var i=Math.pow(r/t,2),s=19980*i+20;o[r]=s}var a=new Float32Array(t),c=new Float32Array(t);return this._filters.forEach((function(){var t=e.context.createBiquadFilter();t.type=e._type,t.Q.value=e.Q.value,t.frequency.value=e.frequency.value,t.gain.value=e.gain.value,t.getFrequencyResponse(o,a,c),a.forEach((function(t,e){n[e]*=t}))})),n},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._filters.forEach((function(t){t.disconnect()})),Fc(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this},e}(Dc),Vl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ul=function(t){function e(){var n=t.call(this,Object.assign(Na(e.getDefaults(),arguments,["min","max"])))||this;n.name="Scale",n.input=new Ju({context:n.context,value:1}),n.output=new yl({context:n.context,value:0});var o=Na(e.getDefaults(),arguments,["min","max"]);return n._outputMin=o.min,n._outputMax=o.max,n.input.connect(n.output),n._setRange(),n}return Vl(e,t),e.getDefaults=function(){return Object.assign(Gu.getDefaults(),{max:1,min:0})},Object.defineProperty(e.prototype,"min",{get:function(){return this._outputMin},set:function(t){this._outputMin=t,this._setRange()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._outputMax},set:function(t){this._outputMax=t,this._setRange()},enumerable:!0,configurable:!0}),e.prototype._setRange=function(){this.output.value=this._outputMin,this.input.value=this._outputMax-this._outputMin},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.input.dispose(),this.output.dispose(),this},e}(Gu),Ll=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),zl=[1,1.483,1.932,2.546,2.63,3.897],Wl=(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments))||this;n.name="MetalSynth",n._oscillators=[],n._freqMultipliers=[];var o=Na(e.getDefaults(),arguments);n.detune=new qu({context:n.context,units:"cents",value:o.detune}),n.frequency=new qu({context:n.context,units:"frequency"}),n._amplitude=new Lc({context:n.context,gain:0}).connect(n.output),n._highpass=new Fl({Q:-3.0102999566398125,context:n.context,type:"highpass"}).connect(n._amplitude);for(var r=0;r<zl.length;r++){var i=new el({context:n.context,harmonicity:o.harmonicity,modulationIndex:o.modulationIndex,modulationType:"square",onstop:0===r?function(){return n.onsilence(n)}:Vc,type:"square"});i.connect(n._highpass),n._oscillators[r]=i;var s=new Ju({context:n.context,value:zl[r]});n._freqMultipliers[r]=s,n.frequency.chain(s,i.frequency),n.detune.connect(i.detune)}return n._filterFreqScaler=new Ul({context:n.context,max:7e3,min:n.toFrequency(o.resonance)}),n.envelope=new kl({attack:o.envelope.attack,attackCurve:"linear",context:n.context,decay:o.envelope.decay,release:o.envelope.release,sustain:0}),n.envelope.chain(n._filterFreqScaler,n._highpass.frequency),n.envelope.connect(n._amplitude.gain),n._octaves=o.octaves,n.octaves=o.octaves,n}Ll(e,t),e.getDefaults=function(){return ja(El.getDefaults(),{envelope:Object.assign(qa(kl.getDefaults(),Object.keys(Dc.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})},e.prototype._triggerEnvelopeAttack=function(t,e){var n=this;return void 0===e&&(e=1),this.envelope.triggerAttack(t,e),this._oscillators.forEach((function(e){return e.start(t)})),0===this.envelope.sustain&&this._oscillators.forEach((function(e){e.stop(n.toSeconds(t)+n.toSeconds(n.envelope.attack)+n.toSeconds(n.envelope.decay))})),this},e.prototype._triggerEnvelopeRelease=function(t){var e=this;return this.envelope.triggerRelease(t),this._oscillators.forEach((function(n){return n.stop(e.toSeconds(t)+e.toSeconds(e.envelope.release))})),this},Object.defineProperty(e.prototype,"modulationIndex",{get:function(){return this._oscillators[0].modulationIndex.value},set:function(t){this._oscillators.forEach((function(e){return e.modulationIndex.value=t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"harmonicity",{get:function(){return this._oscillators[0].harmonicity.value},set:function(t){this._oscillators.forEach((function(e){return e.harmonicity.value=t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resonance",{get:function(){return this._filterFreqScaler.min},set:function(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._oscillators.forEach((function(t){return t.dispose()})),this._freqMultipliers.forEach((function(t){return t.dispose()})),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}(El),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),Gl=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["callback","value"]))||this;n.name="ToneEvent",n._state=new eu("stopped"),n._startOffset=0;var o=Na(e.getDefaults(),arguments,["callback","value"]);return n._loop=o.loop,n.callback=o.callback,n.value=o.value,n._loopStart=n.toTicks(o.loopStart),n._loopEnd=n.toTicks(o.loopEnd),n._playbackRate=o.playbackRate,n._probability=o.probability,n._humanize=o.humanize,n.mute=o.mute,n.playbackRate=o.playbackRate,n}return Wl(e,t),e.getDefaults=function(){return Object.assign(Pc.getDefaults(),{callback:Vc,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})},e.prototype._rescheduleEvents=function(t){var e=this;void 0===t&&(t=-1),this._state.forEachFrom(t,(function(t){var n;if("started"===t.state){-1!==t.id&&e.context.transport.clear(t.id);var o=t.time+Math.round(e.startOffset/e._playbackRate);if(!0===e._loop||Ta(e._loop)&&e._loop>1){n=1/0,Ta(e._loop)&&(n=e._loop*e._getLoopDuration());var r=e._state.getAfter(o);null!==r&&(n=Math.min(n,r.time-o)),n!==1/0&&(e._state.setStateAtTime("stopped",o+n+1,{id:-1}),n=new uu(e.context,n));var i=new uu(e.context,e._getLoopDuration());t.id=e.context.transport.scheduleRepeat(e._tick.bind(e),i,new uu(e.context,o),n)}else t.id=e.context.transport.schedule(e._tick.bind(e),new uu(e.context,o))}}))},Object.defineProperty(e.prototype,"state",{get:function(){return this._state.getValueAtTime(this.context.transport.ticks)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startOffset",{get:function(){return this._startOffset},set:function(t){this._startOffset=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"probability",{get:function(){return this._probability},set:function(t){this._probability=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"humanize",{get:function(){return this._humanize},set:function(t){this._humanize=t},enumerable:!0,configurable:!0}),e.prototype.start=function(t){var e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this},e.prototype.stop=function(t){this.cancel(t);var e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});var n=this._state.getBefore(e),o=e;null!==n&&(o=n.time),this._rescheduleEvents(o)}return this},e.prototype.cancel=function(t){var e=this;t=Ba(t,-1/0);var n=this.toTicks(t);return this._state.forEachFrom(n,(function(t){e.context.transport.clear(t.id)})),this._state.cancel(n),this},e.prototype._tick=function(t){var e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){var n=.02;Aa(this.humanize)||(n=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*n}this.callback(t,this.value)}},e.prototype._getLoopDuration=function(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)},Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._rescheduleEvents()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._rescheduleEvents()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopEnd",{get:function(){return new uu(this.context,this._loopEnd).toSeconds()},set:function(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopStart",{get:function(){return new uu(this.context,this._loopStart).toSeconds()},set:function(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"progress",{get:function(){if(this._loop){var t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){var n=this._getLoopDuration(),o=(t-e.time)%n;return o/n}return 0}return 0},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.cancel(),this._state.dispose(),this},e}(Pc),$l=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Yl=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["callback","events"]))||this;n.name="Part",n._state=new eu("stopped"),n._events=new Set;var o=Na(e.getDefaults(),arguments,["callback","events"]);return o.events.forEach((function(t){Ma(t)?n.add(t[0],t[1]):n.add(t)})),n}return $l(e,t),e.getDefaults=function(){return Object.assign(Gl.getDefaults(),{events:[]})},e.prototype.start=function(t,e){var n=this,o=this.toTicks(t);if("started"!==this._state.getValueAtTime(o)){e=Ba(e,this._loop?this._loopStart:0),e=this._loop?Ba(e,this._loopStart):Ba(e,0);var r=this.toTicks(e);this._state.add({id:-1,offset:r,state:"started",time:o}),this._forEach((function(t){n._startNote(t,o,r)}))}return this},e.prototype._startNote=function(t,e,n){e-=n,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<n&&(e+=this._getLoopDuration()),t.start(new uu(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=n&&(t.loop=!1,t.start(new uu(this.context,e))):t.startOffset>=n&&t.start(new uu(this.context,e))},Object.defineProperty(e.prototype,"startOffset",{get:function(){return this._startOffset},set:function(t){var e=this;this._startOffset=t,this._forEach((function(t){t.startOffset+=e._startOffset}))},enumerable:!0,configurable:!0}),e.prototype.stop=function(t){var e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach((function(e){e.stop(t)})),this},e.prototype.at=function(t,e){var n=new Ac(this.context,t).toTicks(),o=new uu(this.context,1).toSeconds(),r=this._events.values(),i=r.next();while(!i.done){var s=i.value;if(Math.abs(n-s.startOffset)<o)return ka(e)&&(s.value=e),s;i=r.next()}return ka(e)?(this.add(t,e),this.at(t)):null},e.prototype.add=function(t,e){t instanceof Object&&Reflect.has(t,"time")&&(e=t,t=e.time);var n,o=this.toTicks(t);return e instanceof Gl?(n=e,n.callback=this._tick.bind(this)):n=new Gl({callback:this._tick.bind(this),context:this.context,value:e}),n.startOffset=o,n.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(n),this._restartEvent(n),this},e.prototype._restartEvent=function(t){var e=this;this._state.forEach((function(n){"started"===n.state?e._startNote(t,n.time,n.offset):t.stop(new uu(e.context,n.time))}))},e.prototype.remove=function(t,e){var n=this;return Sa(t)&&t.hasOwnProperty("time")&&(e=t,t=e.time),t=this.toTicks(t),this._events.forEach((function(o){o.startOffset===t&&(Oa(e)||ka(e)&&o.value===e)&&(n._events.delete(o),o.dispose())})),this},e.prototype.clear=function(){return this._forEach((function(t){return t.dispose()})),this._events.clear(),this},e.prototype.cancel=function(t){return this._forEach((function(e){return e.cancel(t)})),this._state.cancel(this.toTicks(t)),this},e.prototype._forEach=function(t){return this._events&&this._events.forEach((function(n){n instanceof e?n._forEach(t):t(n)})),this},e.prototype._setAll=function(t,e){this._forEach((function(n){n[t]=e}))},e.prototype._tick=function(t,e){this.mute||this.callback(t,e)},e.prototype._testLoopBoundries=function(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)},Object.defineProperty(e.prototype,"probability",{get:function(){return this._probability},set:function(t){this._probability=t,this._setAll("probability",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"humanize",{get:function(){return this._humanize},set:function(t){this._humanize=t,this._setAll("humanize",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){var e=this;this._loop=t,this._forEach((function(n){n.loopStart=e.loopStart,n.loopEnd=e.loopEnd,n.loop=t,e._testLoopBoundries(n)}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopEnd",{get:function(){return new uu(this.context,this._loopEnd).toSeconds()},set:function(t){var e=this;this._loopEnd=this.toTicks(t),this._loop&&this._forEach((function(n){n.loopEnd=t,e._testLoopBoundries(n)}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopStart",{get:function(){return new uu(this.context,this._loopStart).toSeconds()},set:function(t){var e=this;this._loopStart=this.toTicks(t),this._loop&&this._forEach((function(t){t.loopStart=e.loopStart,e._testLoopBoundries(t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._setAll("playbackRate",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._events.size},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.clear(),this},e}(Gl),Ql=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Hl=(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["callback","events","subdivision"]))||this;n.name="Sequence",n._part=new Yl({callback:n._seqCallback.bind(n),context:n.context}),n._events=[],n._eventsArray=[];var o=Na(e.getDefaults(),arguments,["callback","events","subdivision"]);return n._subdivision=n.toTicks(o.subdivision),n.events=o.events,n.loop=o.loop,n.loopStart=o.loopStart,n.loopEnd=o.loopEnd,n.playbackRate=o.playbackRate,n.probability=o.probability,n.humanize=o.humanize,n.mute=o.mute,n.playbackRate=o.playbackRate,n}Ql(e,t),e.getDefaults=function(){return Object.assign(qa(Gl.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})},e.prototype._seqCallback=function(t,e){null!==e&&this.callback(t,e)},Object.defineProperty(e.prototype,"events",{get:function(){return this._events},set:function(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()},enumerable:!0,configurable:!0}),e.prototype.start=function(t,e){return this._part.start(t,e?this._indexTime(e):e),this},e.prototype.stop=function(t){return this._part.stop(t),this},Object.defineProperty(e.prototype,"subdivision",{get:function(){return new uu(this.context,this._subdivision).toSeconds()},enumerable:!0,configurable:!0}),e.prototype._createSequence=function(t){var e=this;return new Proxy(t,{get:function(t,e){return t[e]},set:function(t,n,o){if(Pa(n)&&isFinite(parseInt(n,10))){parseInt(n,10);Ma(o)?t[n]=e._createSequence(o):t[n]=o}else t[n]=o;return e._eventsUpdated(),!0}})},e.prototype._eventsUpdated=function(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd},e.prototype._rescheduleSequence=function(t,e,n){var o=this;t.forEach((function(t,r){var i=r*e+n;if(Ma(t))o._rescheduleSequence(t,e/t.length,i);else{var s=new uu(o.context,i,"i").toSeconds();o._part.add(s,t)}}))},e.prototype._indexTime=function(t){return new uu(this.context,t*this._subdivision+this.startOffset).toSeconds()},e.prototype.clear=function(){return this._part.clear(),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._part.dispose(),this},Object.defineProperty(e.prototype,"loop",{get:function(){return this._part.loop},set:function(t){this._part&&(this._part.loop=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopStart",{get:function(){return this._loopStart},set:function(t){this._loopStart=t,this._part&&(this._part.loopStart=this._indexTime(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(t){this._loopEnd=t,this._part&&(this._part.loopEnd=0===t?this._indexTime(this._eventsArray.length):this._indexTime(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startOffset",{get:function(){return this._part.startOffset},set:function(t){this._part&&(this._part.startOffset=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._part.playbackRate},set:function(t){this._part&&(this._part.playbackRate=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"probability",{get:function(){return this._part.probability},set:function(t){this._part&&(this._part.probability=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"humanize",{get:function(){return this._part.humanize},set:function(t){this._part&&(this._part.humanize=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._part.length},enumerable:!0,configurable:!0})}(Gl),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),Xl=function(t){function e(){var n=t.call(this,Object.assign(Na(e.getDefaults(),arguments,["fade"])))||this;n.name="CrossFade",n._panner=n.context.createStereoPanner(),n._split=n.context.createChannelSplitter(2),n._g2a=new _l({context:n.context}),n.a=new Lc({context:n.context,gain:0}),n.b=new Lc({context:n.context,gain:0}),n.output=new Lc({context:n.context}),n._internalChannels=[n.a,n.b];var o=Na(e.getDefaults(),arguments,["fade"]);return n.fade=new qu({context:n.context,units:"normalRange",value:o.fade}),qc(n,"fade"),n.context.getConstant(1).connect(n._panner),n._panner.connect(n._split),n._panner.channelCount=1,n._panner.channelCountMode="explicit",Rc(n._split,n.a.gain,0),Rc(n._split,n.b.gain,1),n.fade.chain(n._g2a,n._panner.pan),n.a.connect(n.output),n.b.connect(n.output),n}return Hl(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{fade:.5})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this},e}(Dc),Jl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Zl=function(t){function e(e){var n=t.call(this,e)||this;return n.name="Effect",n._dryWet=new Xl({context:n.context}),n.wet=n._dryWet.fade,n.effectSend=new Lc({context:n.context}),n.effectReturn=new Lc({context:n.context}),n.input=new Lc({context:n.context}),n.output=n._dryWet,n.input.fan(n._dryWet.a,n.effectSend),n.effectReturn.connect(n._dryWet.b),n.wet.setValueAtTime(e.wet,0),n._internalChannels=[n.effectReturn,n.effectSend],qc(n,"wet"),n}return Jl(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{wet:1})},e.prototype.connectEffect=function(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this},e}(Dc),Kl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),th=function(t){function e(e){var n=t.call(this,e)||this;return n.name="FeedbackEffect",n._feedbackGain=new Lc({context:n.context,gain:e.feedback,units:"normalRange"}),n.feedback=n._feedbackGain.gain,qc(n,"feedback"),n.effectReturn.chain(n._feedbackGain,n.effectSend),n}return Kl(e,t),e.getDefaults=function(){return Object.assign(Zl.getDefaults(),{feedback:.125})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._feedbackGain.dispose(),this.feedback.dispose(),this},e}(Zl),eh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),nh=(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["delayTime","feedback"]))||this;n.name="FeedbackDelay";var o=Na(e.getDefaults(),arguments,["delayTime","feedback"]);return n._delayNode=new Kc({context:n.context,delayTime:o.delayTime,maxDelay:o.maxDelay}),n.delayTime=n._delayNode.delayTime,n.connectEffect(n._delayNode),qc(n,"delayTime"),n}eh(e,t),e.getDefaults=function(){return Object.assign(th.getDefaults(),{delayTime:.25,maxDelay:1})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._delayNode.dispose(),this.delayTime.dispose(),this}}(th),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),oh=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(s,a)}c((o=o.apply(t,e||[])).next())}))},rh=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,o&&(r=2&i[0]?o["return"]:i[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},ih=(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["url","onload"]))||this;n.name="Convolver",n._convolver=n.context.createConvolver();var o=Na(e.getDefaults(),arguments,["url","onload"]);return n._buffer=new $c(o.url,(function(t){n.buffer=t,o.onload()})),n._buffer.loaded&&(n.buffer=n._buffer),n.normalize=o.normalize,n.connectEffect(n._convolver),n}nh(e,t),e.getDefaults=function(){return Object.assign(Zl.getDefaults(),{normalize:!0,onload:Vc})},e.prototype.load=function(t){return oh(this,void 0,void 0,(function(){var e;return rh(this,(function(n){switch(n.label){case 0:return e=this,[4,this._buffer.load(t)];case 1:return e.buffer=n.sent(),[2]}}))}))},Object.defineProperty(e.prototype,"buffer",{get:function(){return this._buffer.length?this._buffer:null},set:function(t){t&&this._buffer.set(t),this._convolver.buffer&&(this.effectSend.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.connectEffect(this._convolver));var e=this._buffer.get();this._convolver.buffer=e||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalize",{get:function(){return this._convolver.normalize},set:function(t){this._convolver.normalize=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._buffer.dispose(),this._convolver.disconnect(),this}}(Zl),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),sh=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["channels"]))||this;n.name="Merge";var o=Na(e.getDefaults(),arguments,["channels"]);return n._merger=n.output=n.input=n.context.createChannelMerger(o.channels),n}return ih(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{channels:2})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._merger.disconnect(),this},e}(Dc),ah=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ch=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(s,a)}c((o=o.apply(t,e||[])).next())}))},uh=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,o&&(r=2&i[0]?o["return"]:i[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},lh=(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["decay"]))||this;n.name="Reverb",n._convolver=n.context.createConvolver();var o=Na(e.getDefaults(),arguments,["decay"]);return n.decay=o.decay,n.preDelay=o.preDelay,n.connectEffect(n._convolver),n}ah(e,t),e.getDefaults=function(){return Object.assign(Zl.getDefaults(),{decay:1.5,preDelay:.01})},e.prototype.generate=function(){return ch(this,void 0,void 0,(function(){var t,e=this;return uh(this,(function(n){switch(n.label){case 0:return[4,Hc((function(t){var n=new Iu({context:t}),o=new Iu({context:t}),r=new sh({context:t});n.connect(r,0,0),o.connect(r,0,1);var i=new Lc({context:t}).toDestination();r.connect(i),n.start(0),o.start(0),i.gain.setValueAtTime(0,0),i.gain.setValueAtTime(1,e.preDelay),i.gain.exponentialApproachValueAtTime(0,e.preDelay,e.decay)}),this.decay+this.preDelay)];case 1:return t=n.sent(),this._convolver.buffer=t.get(),[2,this]}}))}))},e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._convolver.disconnect(),this}}(Zl),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),hh=(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["type","size"]))||this;n.name="Analyser",n._analyser=n.context.createAnalyser();var o=Na(e.getDefaults(),arguments,["type","size"]);return n.size=o.size,n.type=o.type,n.input=n.output=n._analyser,n}lh(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{size:1024,smoothing:.8,type:"fft"})},e.prototype.getValue=function(){return"fft"===this._type?this._analyser.getFloatFrequencyData(this._buffer):"waveform"===this._type&&this._analyser.getFloatTimeDomainData(this._buffer),this._buffer},Object.defineProperty(e.prototype,"size",{get:function(){return this._analyser.frequencyBinCount},set:function(t){this._analyser.fftSize=2*t,this._buffer=new Float32Array(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this.assert("waveform"===t||"fft"===t,"Analyser: invalid type: "+t),this._type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smoothing",{get:function(){return this._analyser.smoothingTimeConstant},set:function(t){this._analyser.smoothingTimeConstant=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._analyser.disconnect(),this}}(Dc),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),ph=function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["lowFrequency","highFrequency"]))||this;n.name="MultibandSplit",n.input=new Lc({context:n.context}),n.output=void 0,n.low=new Fl({context:n.context,frequency:0,type:"lowpass"}),n._lowMidFilter=new Fl({context:n.context,frequency:0,type:"highpass"}),n.mid=new Fl({context:n.context,frequency:0,type:"lowpass"}),n.high=new Fl({context:n.context,frequency:0,type:"highpass"}),n._internalChannels=[n.low,n.mid,n.high];var o=Na(e.getDefaults(),arguments,["lowFrequency","highFrequency"]);return n.lowFrequency=new qu({context:n.context,units:"frequency",value:o.lowFrequency}),n.highFrequency=new qu({context:n.context,units:"frequency",value:o.highFrequency}),n.Q=new qu({context:n.context,units:"positive",value:o.Q}),n.input.fan(n.low,n.high),n.input.chain(n._lowMidFilter,n.mid),n.lowFrequency.fan(n.low.frequency,n._lowMidFilter.frequency),n.highFrequency.fan(n.mid.frequency,n.high.frequency),n.Q.connect(n.low.Q),n.Q.connect(n._lowMidFilter.Q),n.Q.connect(n.mid.Q),n.Q.connect(n.high.Q),qc(n,["high","mid","low","highFrequency","lowFrequency"]),n}return hh(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),Fc(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this},e}(Dc),fh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),dh=(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["low","mid","high"]))||this;n.name="EQ3",n.output=new Lc({context:n.context}),n._internalChannels=[];var o=Na(e.getDefaults(),arguments,["low","mid","high"]);return n.input=n._multibandSplit=new ph({context:n.context,highFrequency:o.highFrequency,lowFrequency:o.lowFrequency}),n._lowGain=new Lc({context:n.context,gain:o.low,units:"decibels"}),n._midGain=new Lc({context:n.context,gain:o.mid,units:"decibels"}),n._highGain=new Lc({context:n.context,gain:o.high,units:"decibels"}),n.low=n._lowGain.gain,n.mid=n._midGain.gain,n.high=n._highGain.gain,n.Q=n._multibandSplit.Q,n.lowFrequency=n._multibandSplit.lowFrequency,n.highFrequency=n._multibandSplit.highFrequency,n._multibandSplit.low.chain(n._lowGain,n.output),n._multibandSplit.mid.chain(n._midGain,n.output),n._multibandSplit.high.chain(n._highGain,n.output),qc(n,["low","mid","high","lowFrequency","highFrequency"]),n._internalChannels=[n._multibandSplit],n}fh(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})},e.prototype.dispose=function(){return t.prototype.dispose.call(this),Fc(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}(Dc),function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}());(function(t){function e(){var n=t.call(this,Na(e.getDefaults(),arguments,["treshold","ratio"]))||this;n.name="Compressor",n._compressor=n.context.createDynamicsCompressor(),n.input=n._compressor,n.output=n._compressor;var o=Na(e.getDefaults(),arguments,["treshold","ratio"]);return n.threshold=new Ic({context:n.context,convert:!1,param:n._compressor.threshold,units:"decibels",value:o.threshold}),n.attack=new Ic({context:n.context,param:n._compressor.attack,units:"time",value:o.attack}),n.release=new Ic({context:n.context,param:n._compressor.release,units:"time",value:o.release}),n.knee=new Ic({context:n.context,convert:!1,param:n._compressor.knee,units:"decibels",value:o.knee}),n.ratio=new Ic({context:n.context,convert:!1,param:n._compressor.ratio,units:"positive",value:o.ratio}),qc(n,["knee","release","attack","ratio","threshold"]),n}dh(e,t),e.getDefaults=function(){return Object.assign(Dc.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})},Object.defineProperty(e.prototype,"reduction",{get:function(){return this._compressor.reduction},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){return t.prototype.dispose.call(this),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}})(Dc);sc().transport,sc().destination;var yh,mh=n("081e"),vh=n("596b"),_h=n.n(vh),gh=n("3835"),bh=(n("2ca0"),n("a15b"),n("5319"),n("05e2")),wh="BCEJKMRSUhik",xh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Oh=[].reduce.call(xh,(function(t,e,n){return t[e]=n,t}),{});function kh(t){if(t<4096)return xh[t>>6]+xh[63&t]}function Ch(t){return Oh[t[0]]<<6|Oh[t[1]]}function Th(t){var e=t.startsWith("b"),n=t.substr(t.length-2,2),o=Object(gh["a"])(n,2),r=o[0],i=o[1];return Rh[(r.charCodeAt(0)+3)%7]-(e?1:0)+12*(+i+2)}var Sh,Ah=[[],[0],[1],[0,1],[2],[1,2],[0,2],[0,1,2]],Mh=[[0],[3],[6],[0,2,4],[9],[3,5,7],[0,1,3],[3,4,6]],Ph=function(){for(var t={},e=function(e){if(0===(7&e))return"continue";var n=Ah[7&e],o=Mh[e>>3],r=xh[e],i=[];n.forEach((function(t){o.forEach((function(e){i.push(t+e)}))})),i.length&&(t[r]=Object(bh["a"])(i).sort())},n=1;n<xh.length;n++)e(n);return t}(),Eh=Object.keys(Ph).reduce((function(t,e){return t[Ph[e].join("_")]=e,t}),{});(function(t){t[t["PentatonicMinor"]=1]="PentatonicMinor",t[t["PentatonicMajor"]=2]="PentatonicMajor",t[t["Chromatic"]=3]="Chromatic",t[t["Hexatonic"]=4]="Hexatonic",t[t["Major"]=5]="Major",t[t["Minor"]=6]="Minor",t[t["Hirajoshi"]=7]="Hirajoshi",t[t["Phrygian"]=8]="Phrygian",t[t["Yo"]=9]="Yo"})(Sh||(Sh={}));var Ih,jh=(yh={},Object(u["a"])(yh,Sh.PentatonicMinor,["C3","bE3","F3","G3","bB3","C4","bE4","F4","G4","bB4","C5","bE5"]),Object(u["a"])(yh,Sh.PentatonicMajor,["C3","D3","E3","G3","A3","C4","D4","E4","G4","A4","C5","D5"]),Object(u["a"])(yh,Sh.Chromatic,["C3","bD3","D3","bE3","E3","F3","bG3","G3","bA3","A3","bB3","B3"]),Object(u["a"])(yh,Sh.Hexatonic,["C3","bE3","F3","bG3","G3","bB3","C4","bE4","F4","bG4","G4","bB4"]),Object(u["a"])(yh,Sh.Major,["C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4"]),Object(u["a"])(yh,Sh.Minor,["C3","D3","bE3","F3","G3","bA3","bB3","C4","D4","bE4","F4","G4"]),Object(u["a"])(yh,Sh.Hirajoshi,["C3","bD3","F3","bG3","bA3","C4","bD4","F4","bG4","bA4","C5","bD5"]),Object(u["a"])(yh,Sh.Phrygian,["C3","bD3","E3","F3","G3","bA3","bB3","C4","bD4","E4","F4","G4"]),Object(u["a"])(yh,Sh.Yo,["bD3","bE3","bG3","bA3","bB3","bD4","bE4","bG4","bA4","bB4","bD5","bE5"]),yh),Dh="BCEJKMRSUhik",Nh=[].reduce.call(Dh,(function(t,e,n){return t[e]=n,t}),{}),Rh=[0,2,4,5,7,9,11],Bh=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],qh=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],Fh=["1","1#","2","2#","3","4","4#","5","5#","6","6#","7"],Vh=["1","#1","2","#2","3","4","#4","5","#5","6","#6","7"],Uh=["1","b2","2","b3","3","4","b5","5","b6","6","b7","7"],Lh=function(){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Object(i["a"])(this,t),this.seq=0,this.midi=0,"string"===typeof e&&(e=Nh[e]),this.seq=e,this.parent=n,this.duration=o,this.recalc()}return Object(s["a"])(t,[{key:"shiftMidi",get:function(){return this.midi+this.parent.numberShift}},{key:"code",get:function(){return Dh[this.seq]}},{key:"number",get:function(){return this.seq<0?"0":Uh[this.shiftMidi%12]}},{key:"sharpNumber",get:function(){return this.seq<0?"0":Fh[this.shiftMidi%12]}},{key:"codeNumber",get:function(){return this.seq<0?"0":Vh[this.shiftMidi%12]}},{key:"tone",get:function(){return(this.shiftMidi/12|0)-6}},{key:"sharpName",get:function(){return this.seq<0?"0":Bh[this.shiftMidi%12]+((this.shiftMidi/12|0)-2)}},{key:"toneName",get:function(){return this.seq<0?"0":qh[this.midi%12]+((this.midi/12|0)-2)}},{key:"recalc",value:function(){if(this.seq<0)this.name="0";else if(this.parent.modeMap){var t=this.parent.modeMap[this.seq];this.name=t,this.midi=Th(t)}}}]),t}(),zh=function(t){Object(a["a"])(n,t);var e=Object(c["a"])(n);function n(t){return Object(i["a"])(this,n),e.call(this,t.seq,t.parent)}return n}(Lh),Wh=function(){function t(){Object(i["a"])(this,t),this.timeSignature=[4,4],this.bpm=240,this.numberShift=0,this.modeMap=jh[Sh.Major],this._mode=Sh.Major,this.notes=[]}return Object(s["a"])(t,[{key:"mode",get:function(){return this._mode},set:function(t){this._mode=t,this.modeMap=jh[t],this.notes&&this.notes.forEach((function(t){t.recalc()}))}},{key:"midiMap",get:function(){return this.modeMap.map((function(t){return Th(t)}))}},{key:"space",get:function(){return 960/this.bpm|0}},{key:"musicNotes",get:function(){for(var t=this,e=this.space,n=0,o=[],r=[],i=function(i){var a=t.notes[i];while(a.seq<0)if(n+=e*a.duration,a=t.notes[++i],!a)return s=i,{v:o};var c=new zh(a);c.position=n,c.duration=a.duration,n+=e*a.duration,0===a.duration?r.push(c):(r.forEach((function(t){return t.duration=a.duration})),r=[]),o.push(c),s=i},s=0;s<this.notes.length;s++){var a=i(s);if("object"===Object(l["a"])(a))return a.v}return o}},{key:"code",get:function(){for(var t=this.musicNotes,e=[],n=[],o=0;o<t.length;o++){var r=t[o],i=t[o+1],s=kh(r.position);if(!s)break;if(i&&r.position===i.position)e.push(r.seq);else if(e.length){var a=Object(bh["a"])(e.concat(r.seq)).sort().join("_"),c=Eh[a]||wh[r.seq];n.push("".concat(c).concat(s)),e.length=0}else n.push("".concat(wh[r.seq]).concat(s))}return"".concat(this.mode).concat(n.join(""))},set:function(t){var e=this;this._mode=+t[0],this.modeMap=jh[this._mode];for(var n=t.substr(1),o=[],r=this.space,i=function(t){var i=[n[t],n.substr(t+1,2)],a=i[0],c=i[1],u=Ch(c);if(u%r!=0&&e.bpm<960){for(var l=r-1;l>0;--l)if(u%l===0){e.bpm=960/l,r=l;break}return o=[],t=0,s=t,"continue"}var h=Ph[a];h&&h.forEach((function(t){o.push([t,u/r])})),t+=3,s=t},s=0;s<n.length-2;)i(s);this.setSeqs(o)}},{key:"setSeqs",value:function(t){var e=this,n=[],o=1,r=function(t){if(t){for(var o=~~(t/4),r=~~(t%4/2),i=t%2,s=function(t){return new Lh(-1,e,t)},a=0;a<o;a++)n.push(s(4));r&&n.push(s(2)),i&&n.push(s(1))}};0!==t[0][1]&&r(t[0][1]);for(var i=0;i<t.length;i++){var s=Object(gh["a"])(t[i],2),a=s[0],c=s[1],u=t[i+1],l=new Lh(a,this),h=0;if(u){var p=u[1],f=p-c;f>4?(l.duration=4,h=f-4):3===f?(l.duration=2,h=1):l.duration=f,o=l.duration||o}else l.duration=o;n.push(l),h&&r(h)}this.notes=n}},{key:"clear",value:function(){this.notes=[]}},{key:"addNote",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=new Lh(t?t.seq:-1,this,e);this.notes.push(n)}},{key:"removeNote",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;-1===t?this.notes.pop():this.notes.splice(t)}},{key:"getNoteByMidi",value:function(t,e){var n=this.midiMap,o=n.findIndex((function(e){return e>=t}));return t-n[o-1]<t-n[o]&&o--,new Lh(Math.max(0,o),this,e)}},{key:"totalDuration",get:function(){var t=0;return this.musicNotes.forEach((function(e){t+=e.duration})),t}},{key:"numberSeqs",get:function(){for(var t=[],e=2,n=0,o=0;o<this.notes.length;o++){var r=this.notes[o-1],i=this.notes[o],s=["_",,"^","^^"][i.tone+1]||"",a="";0!==o&&i.duration==e||(a=["(","=","-",,"."][i.duration]),t.push("".concat(o>0&&n%16===0?" ":"").concat(a).concat(s).concat(i.codeNumber).concat(o>0&&i.duration!=r.duration&&0===r.duration?")":"")),e=i.duration||e,n+=i.duration}return t.join("")},set:function(t){var e=this,n=[],o=2,r=6,i=!1,s=/([\.=\-\[\],{}])|((?:[_\^\/+]+)?[b#]?[0-7]|\((?:(?:[_\^\/+]+)?[b#]?[0-7])+?\))/g,a=/([_\^\/+]+)?([b#])?([0-7])/g;t.replace(s,(function(t,s,c){if(s)switch(s){case",":n.push(new Lh(-1,e,Math.max(1,o/2))),i=!0;break;case"[":o=Math.max(1,o/2);break;case"]":o*=2;break;case"{":r++;break;case"}":r--;break;default:o={"=":1,"-":2,".":4}[s]}if(c){var u=[];c.replace(a,(function(t,n,o,i){if("0"===i)u.push(new Lh(-1,e,0));else{var s=n&&{_:-1,"^":1,"/":-1,"+":1}[n[0]]*n.length||0,a={"#":1,b:-1}[o]||0,c=Rh[i.charCodeAt(0)%7]+12*(s+r)+a-e.numberShift;u.push(e.getNoteByMidi(c,0))}return t})),u[u.length-1].duration=i?o/2:o,i=!1,n=n.concat(u)}return t})),this.notes=n}}]),t}(),Gh=function(){return window.requestAnimationFrame||window["webkitRequestAnimationFrame"]||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),$h=function(){function t(e,n){var o=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Object(i["a"])(this,t),this.isRunning=!1,this.step=0,this.skipMode=!1,this.visibilitychange=function(){document.hidden&&o.tick()},this.tick=function(t){if(o.isRunning){var e=!t;t||(t=performance.now());var n=t-o.startTime;n/o.peroid>o.step&&(o.skipMode?(o.step=1+~~(n/o.peroid),o.callback(o.step)):(o.callback(~~(n/o.peroid)),o.step++)),e?setTimeout(o.tick,1e3/60):Gh(o.tick)}},this.callback=e,this.peroid=n,this.skipMode=r}return Object(s["a"])(t,[{key:"start",value:function(){if(!this.isRunning)return this.seek(),this.isRunning=!0,document.addEventListener("visibilitychange",this.visibilitychange),this.tick(this.startTime),this}},{key:"seek",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.step=0,this.pauseTime=0,this.startTime=performance.now()-t,this}},{key:"seekStep",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.seek(t*this.peroid),this}},{key:"pause",value:function(){return this.pauseTime=performance.now()-this.startTime,this.isRunning=!1,this._nativetimer&&clearInterval(this._nativetimer),document.removeEventListener("visibilitychange",this.visibilitychange),this}},{key:"stop",value:function(){return this.isRunning=!1,this.step=0,this.pauseTime=0,this._nativetimer&&clearInterval(this._nativetimer),document.removeEventListener("visibilitychange",this.visibilitychange),this}}]),t}(),Yh={en:"# Shawzin Music Editor\n\n## Features\n\n- [x] Keyboard or mouse input notes\n- [x] Import existing code (supports automatic adjustment of BPM)\n- [x] Switch BPM\n- [x] Live recording\n- [x] Play preview and switch between different sounds (although there are only two now)\n\n## How to choose BPM [Important]\n\nBPM is the number of beats per minute, calculated as the number of beats per second *60, that is, 1 second and 2 beats corresponds to 120 BPM.\n\nSince there are no eighth notes and sixteenth notes, if you use the spectrum you used, multiply BPM by 2 or 4 (for example, if you use a 16th note at 120BPM, you need to use 480BPM and change all 16th to four. Divided into the original four points into full notes and so on)\n\nBPM cannot be adjusted arbitrarily due to game code accuracy restrictions. If your song has a BPM calibration, please use the closest option (also adjusted according to the above rules)\n\n## Action\n\nNotice the row of buttons in the upper toolbar. The 3 icons are the tools that switch the current one.\n\nThe default is move tool, support for box selection, which you have used similar software should be familiar.\n\nThe second is add note tool, also click on the blank to add notes.\n\nThe third is delete note tool, click on the note to delete, of course, delete the shortcut key is the DEL on the keyboard, see the keyboard shortcuts below.\n\n## transposition\n\nWhen the spectral subrange may not be sufficient, a certain degree of transposition is required to make the range just fall within the interval.\n\nFor example, the first song of the world is in the lower 5 to the high 1 and the major is lower in the 1st to the high 5, so use the G key to make the major 1 of the major 1 low and you can put down all the notes.\n\nHere are some of the more common transpositions:\n\n- Minor to D (bass 2 to mid 6 missing 7)\n- Minor to F (bass 4 to treble 1 missing 7)\n- Major to G (bass 5 to treble 2 missing 4)\n- Minor to A (bass 6 to treble 3)\n- Pentatonic minor to D (bass 2 to treble 4)\n- Yo to bG (bass 5 to treble 6)\n- Pentatonic minor to A (bass 6 to high 1)\n- Pentatonic minor to E (bass 3 to treble 5 23567)\n- Pentatonic major to G (bass 5 to treble 6 23567)\n- Yo to bD (bass 2 to treble 3 23567)\n- Yo to B (mid 1 to high 2 12456)\n\n## Notation code\n\nThe notation code is a kind of readable code for easy import and transfer. You can quickly import existing spectra into this tool. Most situations need to be combined with the transfer tool.\n\n**Note that only the note information is imported, please adjust BPM by yourself. **\n\nExample: (, Major C 240BPM)\n```\n}000[35]|66[65]5|[35350321]|15[50]3|[4323]00|\n667^1|[7^1750321]|15[53]3|[4321]0[35]|\n66[6555]|[35350321]|[11555334]|[4323]00|\n[66]67^1|[^2^17^10665]|667^1|[{3121}]00|000[07]|\n[7767]5[05]|{[33]3[3432]|1,[2]2}[05]|{[22]2[2432]|\n1,[2]35|10_61|2[1]_7[101]|3[450]1[2|0]1,0[0_5]|\n[33]3[3432]|1,[2]2[0_5]|2[202432]|1,[2]35|\n10[0_601]|4[320]1[1]|_700[0_6]|100[01]}\n```\n\n### Symbol list\n\nOther characters are meaningless except the following characters.\n\n- `. - =` respectively indicates that the note is a full note / half note / quarter note. for all subsequent notes.\n- `[ ]` respectively indicates that the length of the note is half/double before. For example, -123=45-1 can also be written as -123[45]1\n- `_(or /) ^(or +)` respectively indicate bass / treble , only modify one note\n- `{ }` respectively indicate that the note is higher/lower by one octave. For example, _1_2_3123^1^2^3 can also be written as}123{123{123\n- `# b` means semitone, only modify one note\n- `,` indicates the attachment point. ==3003 can also be written as -3,=3\n- If you do not write `. or =` at the beginning, the default starts with a half note.\n\n## Chords\n\nAll simultaneous notes (chords) in the game are currently supported (import and export).\n\nImport this code to see all supported combinations: `5BAACAIEAQJAYKAgMAoRAwSA4UBAhBIiBQkBYDBgGBoFBwLB4OCANCITCQWCYVCgjComCwlC4HDAPDIXDQnDYZDgaDocDwpD4qEAsEIxEQyEY0Eg5Eo6Ew8E4bFAdFI/FQtFYeFguFozFw1F47GA9GI2GQ+GY`\n\n## Keyboard shortcuts\n\n`DEL`: delete selected notes\n\n`Shift+DEL`: Ripple deletes the selected note (the space to be deleted is moved forward with the back note)\n\n`BACKSPACE`: delete last note\n\n`Q~]`: Input notes\n\n`1~7`: Same as above, also input notes, the difference is matching the notation. The default is the bass Shift midrange Alt treble\n\n`S, 0`: Rest note\n\n`JKL`: Switch note duration\n\n`/`: Select previous/next note\n\n`/`: Move the cursor forward/backward\n\n`Shift+/`: Select from the selected note to the beginning/end\n\n`Shift+/`: Scale the current note (adjust the time value of a single note)\n\n`Ctrl+Shift+/`: Zoom the current note and move the back note\n\n`Ctrl+///`: Move notes up/down/left/right\n\n`INS`: Insert blank before the current selection of notes, `Shift+INS` 2 grids `Ctrl+INS` 4 grids `Alt+INS` -1 grids\n\n`Shift+MouseLeft`: Select from the selected note to the currently clicked note\n\n`Ctrl+MouseLeft`: Multi-selected notes\n\n`Home/End`: Go to first/last note.\n\n## Related\n\nOpen source repository: [GitHub-Riven.IM](https://github.com/pa001024/riven-mirror)\n\nTool source [GitHub-Shawzin Music Editor](https://github.com/pa001024/riven-mirror/tree/dev/src/views/music)\n\nTool link: [https://riven.im/music](https://riven.im/music)\n",cn:"# \n\n## \n\n- [x] \n- [x] BPM\n- [x] BPM\n- [x] \n- [x] \n\n## BPM\n\nBPM*602120BPM\n\nBPM24120BPM 480BPM   \n\nBPM BPM\n\n## \n\n3\n\n\n\n\n\nDELDEL\n\n## \n\n\n\n 51 15 G15\n\n:\n\n- D (26 7)\n- F (41 7)\n- G (52 4)\n- A (63)\n- D (24)\n- YobG (56)\n- A (61)\n- E (35 23567)\n- G (56 23567)\n- YobD (23 23567)\n- YoB (12 12456)\n\n## \n\n\n\n**BPM**\n\n: ( C 240BPM)\n```\n}000[35]|66[65]5|[35350321]|15[50]3|[4323]00|\n667^1|[7^1750321]|15[53]3|[4321]0[35]|\n66[6555]|[35350321]|[11555334]|[4323]00|\n[66]67^1|[^2^17^10665]|667^1|[{3121}]00|000[07]|\n[7767]5[05]|{[33]3[3432]|1,[2]2}[05]|{[22]2[2432]|\n1,[2]35|10_61|2[1]_7[101]|3[450]1[2|0]1,0[0_5]|\n[33]3[3432]|1,[2]2[0_5]|2[202432]|1,[2]35|\n10[0_601]|4[320]1[1]|_700[0_6]|100[01]}\n```\n\n## MIDI\n\n [https://www.bilibili.com/video/av70918823/](https://www.bilibili.com/video/av70918823/)\n\n### \n\n  \n\n- `. - =`    \n- `[ ]` / -123=45-1-123[45]1\n- `_(/) ^(+)`   \n- `{ }` / _1_2_3123^1^2^3}123{123{123\n- `# b`  \n- `,`  =3003-3,=3\n- `.=`\n\n## \n\n()\n\n: `5BAACAIEAQJAYKAgMAoRAwSA4UBAhBIiBQkBYDBgGBoFBwLB4OCANCITCQWCYVCgjComCwlC4HDAPDIXDQnDYZDgaDocDwpD4qEAsEIxEQyEY0Eg5Eo6Ew8E4bFAdFI/FQtFYeFguFozFw1F47GA9GI2GQ+GY`\n\n## \n\n`Ctrl+Z`\n\n`Ctrl+Shift+Z`\n\n`Shift+DEL`\n\n`BACKSPACE`\n\n`Q~]`\n\n`1~7`  Shift Alt\n\n`S0`\n\n`JKL`\n\n`/`/\n\n`/`/\n\n`Shift+/`/\n\n`Shift+/`\n\n`Ctrl+Shift+/`\n\n`Ctrl+///`///\n\n`INS` `Shift+INS` 2 `Ctrl+INS` 4 `Alt+INS` -1\n\n`Shift+`\n\n`Ctrl+`\n\n`Home/End`: /\n\n## \n\n [GitHub-](https://github.com/pa001024/riven-mirror)\n\n[https://riven.im/music](https://riven.im/music)\n\n[](https://warframe.huijiwiki.com/p/31525) [](https://github.com/pa001024/riven-mirror/blob/dev/src/views/music/song.txt)\n",zh:"# \n\n## \n\n- [x] \n- [x] BPM\n- [x] BPM\n- [x] \n- [x] \n\n## BPM\n\nBPM*602120BPM\n\nBPM24120BPM 480BPM   \n\nBPM BPM\n\n## \n\n3\n\n\n\n\n\nDELDEL\n\n## \n\n\n\n 51 15 G15\n\n:\n\n- D (26 7)\n- F (41 7)\n- G (52 4)\n- A (63)\n- D (24)\n- YobG (56)\n- A (61)\n- E (35 23567)\n- G (56 23567)\n- YobD (23 23567)\n- YoB (12 12456)\n\n## \n\n\n\n**BPM**\n\n: ( C 240BPM)\n```\n}000[35]|66[65]5|[35350321]|15[50]3|[4323]00|\n667^1|[7^1750321]|15[53]3|[4321]0[35]|\n66[6555]|[35350321]|[11555334]|[4323]00|\n[66]67^1|[^2^17^10665]|667^1|[{3121}]00|000[07]|\n[7767]5[05]|{[33]3[3432]|1,[2]2}[05]|{[22]2[2432]|\n1,[2]35|10_61|2[1]_7[101]|3[450]1[2|0]1,0[0_5]|\n[33]3[3432]|1,[2]2[0_5]|2[202432]|1,[2]35|\n10[0_601]|4[320]1[1]|_700[0_6]|100[01]}\n```\n\n### \n\n  \n\n- `. - =`    \n- `[ ]` / -123=45-1-123[45]1\n- `_(/) ^(+)`   \n- `{ }` / _1_2_3123^1^2^3}123{123{123\n- `# b`  \n- `,`  =3003-3,=3\n- `.=`\n\n## \n\n()\n\n: `5BAACAIEAQJAYKAgMAoRAwSA4UBAhBIiBQkBYDBgGBoFBwLB4OCANCITCQWCYVCgjComCwlC4HDAPDIXDQnDYZDgaDocDwpD4qEAsEIxEQyEY0Eg5Eo6Ew8E4bFAdFI/FQtFYeFguFozFw1F47GA9GI2GQ+GY`\n\n## \n\n`Ctrl+Z`\n\n`Ctrl+Shift+Z`\n\n`Shift+DEL`\n\n`BACKSPACE`\n\n`Q~]`\n\n`1~7`  Shift Alt\n\n`S0`\n\n`JKL`\n\n`/`/\n\n`/`/\n\n`Shift+/`/\n\n`Shift+/`\n\n`Ctrl+Shift+/`\n\n`Ctrl+///`///\n\n`INS` `Shift+INS` 2 `Ctrl+INS` 4 `Alt+INS` -1\n\n`Shift+`\n\n`Ctrl+`\n\n`Home/End`: /\n\n## \n\n [GitHub-](https://github.com/pa001024/riven-mirror)\n\n[https://riven.im/music](https://riven.im/music)\n\n[](https://warframe.huijiwiki.com/p/31525) [](https://github.com/pa001024/riven-mirror/blob/dev/src/views/music/song.txt)\n"},Qh=n("ef75"),Hh=n("d4cd"),Xh=n.n(Hh),Jh=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"===typeof Reflect?"undefined":Object(l["a"])(Reflect))&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Zh=Xh()(),Kh={Q:"B",W:"C",E:"E",R:"J",T:"K",Y:"M",U:"R",I:"S",O:"U",P:"h","[":"i","]":"k"},tp=(Ih={},Object(u["a"])(Ih,Sh.PentatonicMinor,{1:"B",2:"C",4:"E",5:"J",6:"K","+!":"M","+@":"R","+$":"S","+%":"U","+^":"h","!1":"i","!2":"k"}),Object(u["a"])(Ih,Sh.PentatonicMajor,{1:"B",2:"C",3:"E",5:"J",6:"K","+!":"M","+@":"R","+#":"S","+%":"U","+^":"h","!1":"i","!2":"k"}),Object(u["a"])(Ih,Sh.Chromatic,{1:"B",2:"E",3:"K",4:"M",5:"S",6:"h",7:"k"}),Object(u["a"])(Ih,Sh.Hexatonic,{1:"B",2:"C",4:"E",5:"K",6:"M","+!":"R","+@":"S","+$":"U","+%":"i","+^":"k"}),Object(u["a"])(Ih,Sh.Major,{1:"B",2:"C",3:"E",4:"J",5:"K",6:"M",7:"R","+!":"S","+@":"U","+#":"h","+$":"i","+%":"k"}),Object(u["a"])(Ih,Sh.Minor,{1:"B",2:"C",3:"E",4:"J",5:"K",6:"M",7:"R","+!":"S","+@":"U","+#":"h","+$":"i","+%":"k"}),Object(u["a"])(Ih,Sh.Hirajoshi,{1:"B",2:"C",4:"E",5:"K",6:"M","+!":"R","+@":"S","+$":"U","+%":"i","+^":"k"}),Object(u["a"])(Ih,Sh.Phrygian,{1:"B",2:"C",3:"E",4:"J",5:"K",6:"M",7:"R","+!":"S","+@":"U","+#":"h","+$":"i","+%":"k"}),Ih),ep={B:"Q",C:"W",E:"E",J:"R",K:"T",M:"Y",R:"U",S:"I",U:"O",h:"P",i:"[",k:"]"},np=Object(h["a"])("BCEJKMRSUhik".split("")),op={piano:{path:"https://cdn.riven.im/instruments/piano/",keys:["C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5","D5","E5"]},shawzin:{path:"https://cdn.riven.im/instruments/shawzin/",keys:["C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","C5","D5","Db3","Eb3","Gb3","Ab3","Bb3","Db4","Eb4","Gb4","Ab4","Bb4","Db5","Eb5"]},lotus:{path:"https://cdn.riven.im/instruments/lotus/",keys:["C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","C5","D5","Db3","Eb3","Gb3","Ab3","Bb3","Db4","Eb4","Gb4","Ab4","Bb4","Db5","Eb5"]}},rp=20,ip=32,sp=function(t){Object(a["a"])(n,t);var e=Object(c["a"])(n);function n(){var t;return Object(i["a"])(this,n),t=e.apply(this,arguments),t.editMode="move",t.instrument="lotus",t.useNumber=!0,t.useSharp=!0,t.modeMaps=jh,t.modes=[{name:"pentatonicMinor",val:1},{name:"pentatonicMajor",val:2},{name:"chromatic",val:3},{name:"hexatonic",val:4},{name:"major",val:5},{name:"minor",val:6},{name:"hirajoshi",val:7},{name:"phrygian",val:8},{name:"yo",val:9}],t.bpms=[64,80,96,120,160,192,240,320,480,960],t.timeSignatures=[1,2,3,4,5,6,8,16],t.keyMaps=ep,t.sampler=null,t.isLoaded=!1,t.duration=1,t.music=new Wh,t.isDragCanvas=!1,t.draggingCanvas=!1,t.showHelp=!1,t.clearConfirmVisible=!1,t.settingVisible=!1,t.loop=!1,t.showStaff=document.body.clientWidth>760,t.history=[],t.historyIndex=0,t.copyCache=[],t.blocks=[],t.isSelect=!1,t.isMoveCursor=!1,t.selectBorder={x:0,y:0,w:0,h:0,x1:0,y1:0},t.isShowStop=!1,t.isBlockMoving=!1,t.isBlockMoved=!1,t.isPlaying=!1,t.isRecording=!1,t.playTimer=null,t}return Object(s["a"])(n,[{key:"userGuide",get:function(){var t,e=this.$i18n.locale;switch(e){case"zh-CN":case"zh-CY":t=Yh.cn;break;default:t=this.$t("zh")?Yh.zh:Yh.en}return this.renderMD(t)}},{key:"renderMD",value:function(t){return Zh.render(t)}},{key:"lineToTime",value:function(t){var e=6e4/this.music.bpm,n=4*t*e/1e3;if(n%1!=0)return"";var o=~~(n/60);return o%=60,n%=60,"".concat(o<10?"0"+o:o,":").concat(n<10?"0"+n:n)}},{key:"timeToPixelRatio",get:function(){return this.music.bpm/60*rp}},{key:"midiFile",get:function(){return this.$refs.midiFile}},{key:"pianoWindow",get:function(){return this.$refs.pianoWindow}},{key:"notes",get:function(){var t=this;return y(np.map((function(e){return new Lh(e,t.music)})),"code")}},{key:"maxLines",get:function(){return 4*this.music.bpm}},{key:"toNote",value:function(t){var e=this.notes[np[~~(t/ip)]];return this.useNumber?this.useSharp?e.sharpNumber:e.number:this.useSharp?e.sharpName:e.name}},{key:"calcNoteType",value:function(t){for(var e=this.music.notes[t],n=e.duration,o=t;o<this.music.notes.length;o++){var r=this.music.notes[o];if(0!=r.duration){n=r.duration;break}}return 1===n?"quard":2===n?"half":"full"}},{key:"playNote",value:function(t){var e,n=this;if("undefined"!==typeof t||(t=this.blocks.filter((function(t){return t.x===rp*(n.currentLine-1)})).map((function(t){return np[~~(t.y/ip)]})),t.length)){"number"===typeof t&&(t=np[~~(t/ip)]),e=Array.isArray(t)?t.map((function(t){return n.notes[t].toneName})):this.notes[t].toneName;try{this.sampler.triggerAttack(e)}catch(o){}}}},{key:"playAndAddNote",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.playNote(t,e),-1!==this.currentLine){var n=np.indexOf(t)*ip;this.blocks.push({x:(this.currentLine-1)*rp,y:n,width:rp,selected:!1}),this.commitBlocks()}else this.music.addNote(this.notes[t],e),this.reload(),this.pushState()}},{key:"analysis",value:function(){this.$refs.spectrogram.upload()}},{key:"move",value:function(t,e){var n=this.blocks.filter((function(t){return t.selected})),o=this.maxLines;if(n.length)return n.forEach((function(n){n.x=Math.min(Math.max(0,n.x+t*rp),o*rp),n.y=Math.min(Math.max(0,n.y+e*ip),11*ip)})),1===n.length&&this.playNote(n[0].y),this}},{key:"moveSelect",value:function(t,e){var n=this.blocks.findIndex((function(t){return t.selected}));return this.selectAll(!1),this.blocks[n+t]&&(this.blocks[n+t].selected=!0),this}},{key:"selectTo",value:function(t){return t>0?this.blocks.reduce((function(t,e){return e.selected=t||e.selected}),!1):this.blocks.reduceRight((function(t,e){return e.selected=t||e.selected}),!1),this}},{key:"scale",value:function(t){var e=this.blocks.filter((function(t){return t.selected}));return e.length||(e=[this.blocks[this.blocks.length-1]]),t>0?e.forEach((function(t){t.width=Math.max(rp,t.width+rp)})):e.forEach((function(t){t.width=Math.max(rp,t.width-rp)})),this}},{key:"scaleAndMove",value:function(t){var e=this.blocks.find((function(t){return t.selected}));return this.scale(t).selectTo(1).move(t,0).selectAll(!1),e.selected=!0,e.x-=t*rp,this}},{key:"insert",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this.blocks.find((function(t){return t.selected}));return this.selectTo(1).move(t,0).selectAll(!1),e.selected=!0,this}},{key:"undo",value:function(){var t=this.history[this.historyIndex-1];return t&&(this.music.code=t,this.reload(),this.history[this.historyIndex-1]&&--this.historyIndex),this}},{key:"redo",value:function(){var t=this.history[this.historyIndex+1];return t&&(this.music.code=t,this.reload(),this.history[this.historyIndex+1]&&++this.historyIndex),this}},{key:"scrollTo",value:function(t){return t<0&&(t=~~(this.blocks[this.blocks.length-1].x/rp)),this.pianoWindow.scrollTo(t*rp-this.pianoWindow.clientWidth/2,0),this}},{key:"scrollToSoft",value:function(t){t<0&&(t=~~(this.blocks[this.blocks.length-1].x/rp));var e=this.pianoWindow;return 0===t?e.scrollLeft=0:e.scrollLeft<t*rp-2*e.clientWidth+120?e.scrollLeft=t*rp-40:e.scrollLeft<t*rp-e.clientWidth+40&&(e.scrollLeft+=e.clientWidth-80),this}},{key:"selectAll",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.blocks.forEach((function(e){return e.selected=t})),this}},{key:"delete",value:function(){return this.blocks=this.blocks.filter((function(t){return!t.selected})),this}},{key:"rippleDelete",value:function(){var t=this.blocks.filter((function(t){return t.selected})),e=t[0].x,n=t[t.length-1].x+t[t.length-1].width,o=n-e;return this.blocks=this.blocks.filter((function(t){return!t.selected})).map((function(t){return t.x>=n&&(t.x-=o),t})),this}},{key:"cut",value:function(){return this.copyCache=this.blocks.filter((function(t){return t.selected})),this.delete(),this.$message({showClose:!0,message:this.$t("shawzin.blockCopied"),type:"success"}),this}},{key:"copy",value:function(){return this.copyCache=this.blocks.filter((function(t){return t.selected})),this.$message({showClose:!0,message:this.$t("shawzin.blockCopied"),type:"success"}),this}},{key:"paste",value:function(){if(this.copyCache.length){var t;if(-1!=this.currentLine)t=(this.currentLine-1)*rp;else{var e=this.blocks[this.blocks.length-1];t=e.x+e.width}var n=Object(m["a"])(this.copyCache);this.blocks.forEach((function(t){return t.selected=!1}));var o=n.reduce((function(t,e){return Math.min(t,e.x)}),1/0),r=t-o;if(!isNaN(r)){var i=n.map((function(t){return t.x+=r,t.selected=!0,t}));return this.blocks=this.blocks.concat(i),this}}}},{key:"backspace",value:function(){this.music.removeNote(),this.reload(),this.pushState()}},{key:"pushState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.historyIndex<this.history.length-1&&this.history.splice(0,this.historyIndex+1);var e=this.music.code;this.history.push(e),t||localStorage.setItem("lastMusic",e),this.historyIndex=this.history.length-1,this.history.length>100&&this.history.shift()}},{key:"reload",value:function(){for(var t=this.music.space,e=[],n=this.music.musicNotes,o=[],r=function(r){var i=n[r];0===i.duration?o.push(i):(o.forEach((function(t){return t.duration=i.duration})),o=[]),e.push({x:i.position/t*rp,y:(11-i.seq)*ip,width:i.duration*rp,selected:!1})},i=0;i<n.length;i++)r(i);this.blocks=e}},{key:"created",value:function(){this.reloadInstrumentResource();var t=this.code||localStorage.getItem("lastMusic")||"5MAAEAQKAUMAcSAgRAoMAwEA0MA8EBMKBQMBYSBcUBgMBo";localStorage.getItem("lastMusic")||(this.showHelp=!0),this.music.code=t,this.reload(),this.pushState(!0)}},{key:"reloadInstrumentResource",value:function(){var t=this;this.sampler&&this.sampler.dispose(),this.isLoaded=!1;var e=op[this.instrument],n=e.keys.map((function(t){return[t,"".concat(e.path).concat(t,".mp3")]})).reduce((function(t,e){return t[e[0]]=e[1],t}),{});this.sampler=new Nl(n,(function(){t.isLoaded=!0})).toDestination()}},{key:"mounted",value:function(){this.currentLine=-1,this.updateAnchorPosition();var t=this.$refs.pianoWindow;t.addEventListener("mousewheel",this.scrollHorizontally,!1),t.addEventListener("DOMMouseScroll",this.scrollHorizontally,!1)}},{key:"destroyed",value:function(){this.stopSeq()}},{key:"scrollHorizontally",value:function(t){t.preventDefault();var e=Math.max(-1,Math.min(1,t["wheelDelta"]||-t.detail));this.pianoWindow.scrollLeft-=40*e}},{key:"keyDown",value:function(t){var e=(t.ctrlKey?"^":"")+(t.shiftKey?"+":"")+(t.altKey?"!":"")+t.key.toUpperCase();if(tp[this.music.mode]&&tp[this.music.mode][e]){if(this.isPlaying)return;return t.preventDefault(),void this.playAndAddNote(tp[this.music.mode][e],this.duration)}if(Kh[e]){if(this.isPlaying)return;return t.preventDefault(),void this.playAndAddNote(Kh[e],this.duration)}switch(e){case" ":this.isDragCanvas=!0;break;case"BACKSPACE":this.backspace();break;case"DELETE":this.delete().commitBlocks();break;case"^DELETE":case"+DELETE":this.rippleDelete().commitBlocks();break;case"J":this.duration=1;break;case"K":this.duration=2;break;case"L":this.duration=4;break;case"S":case"0":this.music.addNote(null,this.duration);break;case"^Z":this.undo().commitBlocks(!1);break;case"^+Z":this.redo().commitBlocks(!1);break;case"^A":t.preventDefault(),this.selectAll();break;case"^X":this.cut().commitBlocks();break;case"^C":this.copy();break;case"^V":this.paste().commitBlocks();break;case"^ARROWDOWN":this.move(0,1).commitBlocks();break;case"^ARROWUP":this.move(0,-1).commitBlocks();break;case"^ARROWLEFT":this.move(-1,0).commitBlocks();break;case"^ARROWRIGHT":this.move(1,0).commitBlocks();break;case"+ARROWLEFT":case"+HOME":this.selectTo(-1);break;case"+ARROWRIGHT":case"+END":this.selectTo(1);break;case"ARROWLEFT":t.preventDefault(),this.currentLine=Math.max(this.currentLine-1,-1),this.updateAnchorPosition();break;case"ARROWRIGHT":t.preventDefault(),this.currentLine=Math.min(this.currentLine+1,this.maxLines),this.updateAnchorPosition();break;case"ARROWUP":t.preventDefault(),this.moveSelect(-1,0);break;case"ARROWDOWN":t.preventDefault(),this.moveSelect(1,0);break;case"+ARROWUP":t.preventDefault(),this.scale(1);break;case"+ARROWDOWN":t.preventDefault(),this.scale(-1);break;case"^+ARROWUP":t.preventDefault(),this.scaleAndMove(1).commitBlocks();break;case"^+ARROWDOWN":t.preventDefault(),this.scaleAndMove(-1).commitBlocks();break;case"INSERT":t.preventDefault(),this.insert().commitBlocks();break;case"+INSERT":t.preventDefault(),this.insert(2).commitBlocks();break;case"^INSERT":t.preventDefault(),this.insert(4).commitBlocks();break;case"!INSERT":t.preventDefault(),this.insert(-1).commitBlocks();break;case"END":t.preventDefault(),this.scrollTo(-1);break;case"HOME":t.preventDefault(),this.scrollTo(0);break;default:case"^CONTROL":case"+SHIFT":}}},{key:"keyUp",value:function(t){var e=t.key.toUpperCase();switch(e){case" ":this.isDragCanvas=!1;break}}},{key:"onCanvasDragStart",value:function(t){this.isDragCanvas&&(this.draggingCanvas=!0,document.addEventListener("mousemove",this.onCanvasDragging),document.addEventListener("mouseup",this.onCanvasDragEnd),document["onselectstart"]=function(){return!1})}},{key:"onCanvasDragging",value:function(t){this.draggingCanvas&&(t.preventDefault(),this.$refs.pianoWindow["scrollBy"](-t.movementX,-t.movementY))}},{key:"onCanvasDragEnd",value:function(t){this.draggingCanvas=!1,document.removeEventListener("mousemove",this.onCanvasDragging),document.removeEventListener("mouseup",this.onCanvasDragEnd),document["onselectstart"]=null}},{key:"selectStart",value:function(t){if(0==t.button&&!this.isDragCanvas){var e=this.$refs.pCanvas,n=e.getBoundingClientRect(),o=t.clientX-n.left,r=t.clientY-n.top;switch(this.editMode){case"add":this.blocks.push({x:~~(o/rp)*rp,y:~~(r/ip)*ip,width:this.duration*rp,selected:!1}),this.playNote(r),this.commitBlocks();break;case"move":this.isSelect=!0,this.selectBorder.x=this.selectBorder.x1=o,this.selectBorder.y=this.selectBorder.y1=r,this.selectBorder.w=0,this.selectBorder.h=0,this.updateSelectBorder();break}}}},{key:"moveCursor",value:function(t){if(0==t.button&&!this.isDragCanvas){this.isMoveCursor=!0,this.isShowStop=!0;var e=this.$refs.pCanvas,n=e.getBoundingClientRect(),o=t.clientX-n.left;t.clientY,n.top;this.currentLine=1+~~(o/rp),this.updateAnchorPosition(),this.isPlaying&&this.playTimer.seekStep(this.currentLine)}}},{key:"updateAnchorPosition",value:function(){var t=this.$refs.timeAnchor;t.style.transform="translate(".concat(20*this.currentLine-21,"px)")}},{key:"singleSelectStart",value:function(t,e){var n=e.block,o=e.index;if(0==t.button){var r=this.$refs.pCanvas,i=r.getBoundingClientRect(),s=t.clientX-i.left,a=t.clientY-i.top;switch(this.editMode){case"add":case"move":if(this.isBlockMoving=!0,this.isBlockMoved=!1,this.movingOffsetX=s-n.x,this.movingOffsetY=a-n.y,this.movingIndex=o,t.ctrlKey)n.selected=!n.selected;else if(!n.selected)if(t.shiftKey){var c=this.blocks.filter((function(t){return t.selected}));if(c.length){var u=c[0].x,l=Math.min(u,n.x),h=Math.max(u,n.x);this.blocks.forEach((function(t){t.x>=l&&t.x<=h&&(t.selected=!0)}))}}else this.blocks.forEach((function(t){return t.selected=!1})),n.selected=!0;default:this.playNote(n.y);break;case"delete":this.blocks.splice(o,1),this.commitBlocks();break}}}},{key:"updateSelectBorder",value:function(){var t=this.$refs.selectBorder;t.style.left=this.selectBorder.x+"px",t.style.top=this.selectBorder.y+"px",t.style.width=this.selectBorder.w+"px",t.style.height=this.selectBorder.h+"px"}},{key:"selectMove",value:function(t){var e=this.$refs.pCanvas,n=e.getBoundingClientRect(),o=t.clientX-n.left,r=t.clientY-n.top;if(this.isMoveCursor){var i=1+~~(o/rp);this.currentLine!==i&&(this.currentLine=i,this.updateAnchorPosition(),this.isPlaying?this.playTimer.seekStep(this.currentLine):this.playNote())}if(this.isSelect&&(this.selectBorder.x=Math.min(this.selectBorder.x1,o),this.selectBorder.y=Math.min(this.selectBorder.y1,r),this.selectBorder.w=Math.abs(this.selectBorder.x1-o),this.selectBorder.h=Math.abs(this.selectBorder.y1-r),this.updateSelectBorder()),this.isBlockMoving){this.selectBorder;var s=this.blocks[this.movingIndex],a=Math.floor((o-s.x+rp/2-this.movingOffsetX)/rp),c=Math.floor((r-s.y+ip/2-this.movingOffsetY)/ip),u=this.blocks.filter((function(t){return t.selected})),l=this.maxLines;(a||c)&&(u.forEach((function(t){t.x=Math.min(Math.max(0,t.x+a*rp),l*rp),t.y=Math.min(Math.max(0,t.y+c*ip),11*ip)})),this.isBlockMoved=!0)}}},{key:"selectEnd",value:function(t){var e=this;this.music.space;if(this.isSelect){this.isSelect=!1;var n=this.selectBorder;this.blocks.forEach((function(o){Math.abs(o.x+o.width/2-(n.x+n.w/2))<=(o.width+n.w)/2&&Math.abs(o.y+ip/2-(n.y+n.h/2))<=(ip+n.h)/2?(o.selected=!0,"move"!=e.editMode&&(e.editMode="move")):t.ctrlKey||(o.selected=!1)}))}this.isBlockMoving&&(this.isBlockMoving=!1,this.isBlockMoved&&this.commitBlocks()),this.isMoveCursor&&(this.isMoveCursor=!1)}},{key:"commitBlocks",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.blocks.sort((function(t,e){return t.x-e.x||t.y-e.y})).map((function(t){var e=11-(t.y/ip|0),n=t.x/rp|0;return[e,n]}));this.music.setSeqs(e),t&&this.pushState()}},{key:"importCode",value:function(){var t=prompt(this.$t("shawzin.importCode"),"");t&&(this.music.code=t,this.reload(),this.pushState())}},{key:"copyCode",value:function(){_h()(this.music.code),this.$message({showClose:!0,message:this.$t("shawzin.codeCopied"),type:"success"})}},{key:"importNumberSeqs",value:function(){var t=prompt(this.$t("shawzin.importNumberSeqs"),"");t&&(this.music.numberSeqs=t,this.reload(),this.pushState())}},{key:"copyNumberSeqs",value:function(){_h()(this.music.numberSeqs),this.$message({showClose:!0,message:this.$t("shawzin.numCopied"),type:"success"})}},{key:"importMidi",value:function(){this.midiFile.click()}},{key:"midiFileChange",value:function(t){var e=this,n=t.target.files;if(n.length>0){var o=n[0],r=new FileReader;r.onload=function(t){var n=new Qh["Midi"](t.target.result);e.loadMidi(n),e.midiFile.value=null},r.readAsArrayBuffer(o)}}},{key:"loadMidi",value:function(t){var e=this,n=t.header.tempos[0].bpm,o=t.tracks[0].notes,r=o.reduce((function(t,e){return Math.min(t,e.midi)}),99),i=12*(r/12-5|0);console.log(i);var s=o.map((function(t){return[e.music.getNoteByMidi(t.midi-i-e.music.numberShift).seq,t.time/120*n*16|0]}));this.music.setSeqs(s),this.reload(),this.pushState()}},{key:"playSeq",value:function(){var t=this;this.isPlaying=!0;var e=[],n=0;this.blocks.forEach((function(t){var o=~~(t.x/rp),r=np[~~(t.y/ip)];n=Math.max(n,o),e[o]?e[o].push(r):e[o]=[r]})),n++,-1!=this.currentLine&&this.currentLine--;var o=this.currentLine;this.playTimer=new $h((function(r){t.currentLine=r+o,t.updateAnchorPosition(),t.scrollToSoft(t.currentLine),e[t.currentLine]&&t.playNote(e[t.currentLine]),t.currentLine>n&&(t.loop?(o=-1,t.playTimer.seek(-1e3)):t.stopSeq())}),6e4/this.music.bpm).start()}},{key:"stopSeq",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t||(this.currentLine=-1,this.updateAnchorPosition()),this.playTimer&&this.playTimer.stop(),this.isPlaying=!1,this.isRecording=!1,this.isShowStop=!1}},{key:"recordSeq",value:function(){var t=this;this.isRecording=!0;var e=this.$refs.pianoWindow,n=this.currentLine;this.playTimer=new $h((function(o){t.currentLine=o+n,t.updateAnchorPosition(),e.scrollTo(20*t.currentLine-e.clientWidth/2,0)}),6e4/this.music.bpm).start()}},{key:"clearNotes",value:function(){this.music.clear(),this.reload(),this.pushState()}}]),n}(v["e"]);Jh([Object(v["d"])()],sp.prototype,"code",void 0),Jh([Object(v["f"])("instrument")],sp.prototype,"reloadInstrumentResource",null),Jh([mh["bind"]],sp.prototype,"keyDown",null),Jh([mh["bind"]],sp.prototype,"keyUp",null),Jh([mh["bind"]],sp.prototype,"onCanvasDragStart",null),Jh([mh["bind"]],sp.prototype,"onCanvasDragging",null),Jh([mh["bind"]],sp.prototype,"onCanvasDragEnd",null),sp=Jh([Object(v["a"])({components:{CopyText:_["a"],Staff:rt,Notation:lt}})],sp);var ap=sp,cp=ap,up=(n("b79c"),Object(T["a"])(cp,o,r,!1,null,null,null));e["default"]=up.exports},"3ee2":function(t,e,n){"use strict";var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=n("02d5"),s=n("7430"),a=r(n("06e9"));function c(t,e){return[{absoluteTime:t.ticks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOn",velocity:Math.floor(127*t.velocity)},{absoluteTime:t.ticks+t.durationTicks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOff",velocity:Math.floor(127*t.noteOffVelocity)}]}function u(t){return a.default(t.notes.map((function(e){return c(e,t.channel)})))}function l(t,e){return{absoluteTime:t.ticks,channel:e,controllerType:t.number,deltaTime:0,type:"controller",value:Math.floor(127*t.value)}}function h(t){for(var e=[],n=0;n<127;n++)t.controlChanges.hasOwnProperty(n)&&t.controlChanges[n].forEach((function(n){e.push(l(n,t.channel))}));return e}function p(t,e){return{absoluteTime:t.ticks,channel:e,deltaTime:0,type:"pitchBend",value:t.value}}function f(t){var e=[];return t.pitchBends.forEach((function(n){e.push(p(n,t.channel))})),e}function d(t){return{absoluteTime:0,channel:t.channel,deltaTime:0,programNumber:t.instrument.number,type:"programChange"}}function y(t){return{absoluteTime:0,deltaTime:0,meta:!0,text:t,type:"trackName"}}function m(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/t.bpm),type:"setTempo"}}function v(t){return{absoluteTime:t.ticks,deltaTime:0,denominator:t.timeSignature[1],meta:!0,metronome:24,numerator:t.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function _(t){var e=s.keySignatureKeys.indexOf(t.key);return{absoluteTime:t.ticks,deltaTime:0,key:e+7,meta:!0,scale:"major"===t.scale?0:1,type:"keySignature"}}function g(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,text:t.text,type:t.type}}function b(t){var e={header:{format:1,numTracks:t.tracks.length+1,ticksPerBeat:t.header.ppq},tracks:o([o([{absoluteTime:0,deltaTime:0,meta:!0,text:t.header.name,type:"trackName"}],t.header.keySignatures.map((function(t){return _(t)})),t.header.meta.map((function(t){return g(t)})),t.header.tempos.map((function(t){return m(t)})),t.header.timeSignatures.map((function(t){return v(t)})))],t.tracks.map((function(t){return o([y(t.name),d(t)],u(t),h(t),f(t))})))};return e.tracks=e.tracks.map((function(t){t=t.sort((function(t,e){return t.absoluteTime-e.absoluteTime}));var e=0;return t.forEach((function(t){t.deltaTime=t.absoluteTime-e,e=t.absoluteTime,delete t.absoluteTime})),t.push({deltaTime:0,meta:!0,type:"endOfTrack"}),t})),new Uint8Array(i.writeMidi(e))}e.encode=b},"474f":function(t,e,n){"use strict";n("788a")},"48bc":function(t,e,n){},"4e51":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],e.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],e.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}},5586:function(t,e){},"596b":function(t,e,n){"use strict";const o=(t,{target:e=document.body}={})=>{const n=document.createElement("textarea"),o=document.activeElement;n.value=t,n.setAttribute("readonly",""),n.style.contain="strict",n.style.position="absolute",n.style.left="-9999px",n.style.fontSize="12pt";const r=document.getSelection();let i=!1;r.rangeCount>0&&(i=r.getRangeAt(0)),e.append(n),n.select(),n.selectionStart=0,n.selectionEnd=t.length;let s=!1;try{s=document.execCommand("copy")}catch(a){}return n.remove(),i&&(r.removeAllRanges(),r.addRange(i)),o&&o.focus(),s};t.exports=o,t.exports.default=o},"5a43":function(t,e){function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}t.exports=n,t.exports["default"]=t.exports,t.exports.__esModule=!0},"5bc3":function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function o(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}t.exports=o,t.exports["default"]=t.exports,t.exports.__esModule=!0},"5d84":function(t,e){function n(t,e){if("object"!==typeof t)throw"Invalid MIDI data";e=e||{};var n,i=t.header||{},a=t.tracks||[],c=a.length,u=new s;for(o(u,i,c),n=0;n<c;n++)r(u,a[n],e);return u.buffer}function o(t,e,n){var o=null==e.format?1:e.format,r=128;e.timeDivision?r=e.timeDivision:e.ticksPerFrame&&e.framesPerSecond?r=-(255&e.framesPerSecond)<<8|255&e.ticksPerFrame:e.ticksPerBeat&&(r=32767&e.ticksPerBeat);var i=new s;i.writeUInt16(o),i.writeUInt16(n),i.writeUInt16(r),t.writeChunk("MThd",i.buffer)}function r(t,e,n){var o,r=new s,a=e.length,c=null;for(o=0;o<a;o++)!1!==n.running&&(n.running||e[o].running)||(c=null),c=i(r,e[o],c,n.useByte9ForNoteOff);t.writeChunk("MTrk",r.buffer)}function i(t,e,n,o){var r=e.type,i=e.deltaTime,s=e.text||"",a=e.data||[],c=null;switch(t.writeVarInt(i),r){case"sequenceNumber":t.writeUInt8(255),t.writeUInt8(0),t.writeVarInt(2),t.writeUInt16(e.number);break;case"text":t.writeUInt8(255),t.writeUInt8(1),t.writeVarInt(s.length),t.writeString(s);break;case"copyrightNotice":t.writeUInt8(255),t.writeUInt8(2),t.writeVarInt(s.length),t.writeString(s);break;case"trackName":t.writeUInt8(255),t.writeUInt8(3),t.writeVarInt(s.length),t.writeString(s);break;case"instrumentName":t.writeUInt8(255),t.writeUInt8(4),t.writeVarInt(s.length),t.writeString(s);break;case"lyrics":t.writeUInt8(255),t.writeUInt8(5),t.writeVarInt(s.length),t.writeString(s);break;case"marker":t.writeUInt8(255),t.writeUInt8(6),t.writeVarInt(s.length),t.writeString(s);break;case"cuePoint":t.writeUInt8(255),t.writeUInt8(7),t.writeVarInt(s.length),t.writeString(s);break;case"channelPrefix":t.writeUInt8(255),t.writeUInt8(32),t.writeVarInt(1),t.writeUInt8(e.channel);break;case"portPrefix":t.writeUInt8(255),t.writeUInt8(33),t.writeVarInt(1),t.writeUInt8(e.port);break;case"endOfTrack":t.writeUInt8(255),t.writeUInt8(47),t.writeVarInt(0);break;case"setTempo":t.writeUInt8(255),t.writeUInt8(81),t.writeVarInt(3),t.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":t.writeUInt8(255),t.writeUInt8(84),t.writeVarInt(5);var u={24:0,25:32,29:64,30:96},l=31&e.hour|u[e.frameRate];t.writeUInt8(l),t.writeUInt8(e.min),t.writeUInt8(e.sec),t.writeUInt8(e.frame),t.writeUInt8(e.subFrame);break;case"timeSignature":t.writeUInt8(255),t.writeUInt8(88),t.writeVarInt(4),t.writeUInt8(e.numerator);var h=255&Math.floor(Math.log(e.denominator)/Math.LN2);t.writeUInt8(h),t.writeUInt8(e.metronome),t.writeUInt8(e.thirtyseconds||8);break;case"keySignature":t.writeUInt8(255),t.writeUInt8(89),t.writeVarInt(2),t.writeInt8(e.key),t.writeUInt8(e.scale);break;case"sequencerSpecific":t.writeUInt8(255),t.writeUInt8(127),t.writeVarInt(a.length),t.writeBytes(a);break;case"unknownMeta":null!=e.metatypeByte&&(t.writeUInt8(255),t.writeUInt8(e.metatypeByte),t.writeVarInt(a.length),t.writeBytes(a));break;case"sysEx":t.writeUInt8(240),t.writeVarInt(a.length),t.writeBytes(a);break;case"endSysEx":t.writeUInt8(247),t.writeVarInt(a.length),t.writeBytes(a);break;case"noteOff":var p=!1!==o&&e.byte9||o&&0==e.velocity?144:128;c=p|e.channel,c!==n&&t.writeUInt8(c),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteOn":c=144|e.channel,c!==n&&t.writeUInt8(c),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteAftertouch":c=160|e.channel,c!==n&&t.writeUInt8(c),t.writeUInt8(e.noteNumber),t.writeUInt8(e.amount);break;case"controller":c=176|e.channel,c!==n&&t.writeUInt8(c),t.writeUInt8(e.controllerType),t.writeUInt8(e.value);break;case"programChange":c=192|e.channel,c!==n&&t.writeUInt8(c),t.writeUInt8(e.programNumber);break;case"channelAftertouch":c=208|e.channel,c!==n&&t.writeUInt8(c),t.writeUInt8(e.amount);break;case"pitchBend":c=224|e.channel,c!==n&&t.writeUInt8(c);var f=8192+e.value,d=127&f,y=f>>7&127;t.writeUInt8(d),t.writeUInt8(y);break;default:throw"Unrecognized event type: "+r}return c}function s(){this.buffer=[]}s.prototype.writeUInt8=function(t){this.buffer.push(255&t)},s.prototype.writeInt8=s.prototype.writeUInt8,s.prototype.writeUInt16=function(t){var e=t>>8&255,n=255&t;this.writeUInt8(e),this.writeUInt8(n)},s.prototype.writeInt16=s.prototype.writeUInt16,s.prototype.writeUInt24=function(t){var e=t>>16&255,n=t>>8&255,o=255&t;this.writeUInt8(e),this.writeUInt8(n),this.writeUInt8(o)},s.prototype.writeInt24=s.prototype.writeUInt24,s.prototype.writeUInt32=function(t){var e=t>>24&255,n=t>>16&255,o=t>>8&255,r=255&t;this.writeUInt8(e),this.writeUInt8(n),this.writeUInt8(o),this.writeUInt8(r)},s.prototype.writeInt32=s.prototype.writeUInt32,s.prototype.writeBytes=function(t){this.buffer=this.buffer.concat(Array.prototype.slice.call(t,0))},s.prototype.writeString=function(t){var e,n=t.length,o=[];for(e=0;e<n;e++)o.push(t.codePointAt(e));this.writeBytes(o)},s.prototype.writeVarInt=function(t){if(t<0)throw"Cannot write negative variable-length integer";if(t<=127)this.writeUInt8(t);else{var e=t,n=[];n.push(127&e),e>>=7;while(e){var o=127&e|128;n.push(o),e>>=7}this.writeBytes(n.reverse())}},s.prototype.writeChunk=function(t,e){this.writeString(t),this.writeUInt32(e.length),this.writeBytes(e)},t.exports=n},"5e59":function(t,e){function n(t){var e=new i(t),n=e.readChunk();if("MThd"!=n.id)throw"Bad MIDI file.  Expected 'MHdr', got: '"+n.id+"'";for(var s=o(n.data),a=[],c=0;!e.eof()&&c<s.numTracks;c++){var u=e.readChunk();if("MTrk"!=u.id)throw"Bad MIDI file.  Expected 'MTrk', got: '"+u.id+"'";var l=r(u.data);a.push(l)}return{header:s,tracks:a}}function o(t){var e=new i(t),n=e.readUInt16(),o=e.readUInt16(),r={format:n,numTracks:o},s=e.readUInt16();return 32768&s?(r.framesPerSecond=256-(s>>8),r.ticksPerFrame=255&s):r.ticksPerBeat=s,r}function r(t){var e,n=new i(t),o=[];while(!n.eof()){var r=s();o.push(r)}return o;function s(){var t={};t.deltaTime=n.readVarInt();var o=n.readUInt8();if(240===(240&o)){if(255!==o){if(240==o){t.type="sysEx";i=n.readVarInt();return t.data=n.readBytes(i),t}if(247==o){t.type="endSysEx";i=n.readVarInt();return t.data=n.readBytes(i),t}throw"Unrecognised MIDI event type byte: "+o}t.meta=!0;var r=n.readUInt8(),i=n.readVarInt();switch(r){case 0:if(t.type="sequenceNumber",2!==i)throw"Expected length for sequenceNumber event is 2, got "+i;return t.number=n.readUInt16(),t;case 1:return t.type="text",t.text=n.readString(i),t;case 2:return t.type="copyrightNotice",t.text=n.readString(i),t;case 3:return t.type="trackName",t.text=n.readString(i),t;case 4:return t.type="instrumentName",t.text=n.readString(i),t;case 5:return t.type="lyrics",t.text=n.readString(i),t;case 6:return t.type="marker",t.text=n.readString(i),t;case 7:return t.type="cuePoint",t.text=n.readString(i),t;case 32:if(t.type="channelPrefix",1!=i)throw"Expected length for channelPrefix event is 1, got "+i;return t.channel=n.readUInt8(),t;case 33:if(t.type="portPrefix",1!=i)throw"Expected length for portPrefix event is 1, got "+i;return t.port=n.readUInt8(),t;case 47:if(t.type="endOfTrack",0!=i)throw"Expected length for endOfTrack event is 0, got "+i;return t;case 81:if(t.type="setTempo",3!=i)throw"Expected length for setTempo event is 3, got "+i;return t.microsecondsPerBeat=n.readUInt24(),t;case 84:if(t.type="smpteOffset",5!=i)throw"Expected length for smpteOffset event is 5, got "+i;var s=n.readUInt8(),a={0:24,32:25,64:29,96:30};return t.frameRate=a[96&s],t.hour=31&s,t.min=n.readUInt8(),t.sec=n.readUInt8(),t.frame=n.readUInt8(),t.subFrame=n.readUInt8(),t;case 88:if(t.type="timeSignature",4!=i)throw"Expected length for timeSignature event is 4, got "+i;return t.numerator=n.readUInt8(),t.denominator=1<<n.readUInt8(),t.metronome=n.readUInt8(),t.thirtyseconds=n.readUInt8(),t;case 89:if(t.type="keySignature",2!=i)throw"Expected length for keySignature event is 2, got "+i;return t.key=n.readInt8(),t.scale=n.readUInt8(),t;case 127:return t.type="sequencerSpecific",t.data=n.readBytes(i),t;default:return t.type="unknownMeta",t.data=n.readBytes(i),t.metatypeByte=r,t}}else{var c;if(0===(128&o)){if(null===e)throw"Running status byte encountered before status byte";c=o,o=e,t.running=!0}else c=n.readUInt8(),e=o;var u=o>>4;switch(t.channel=15&o,u){case 8:return t.type="noteOff",t.noteNumber=c,t.velocity=n.readUInt8(),t;case 9:var l=n.readUInt8();return t.type=0===l?"noteOff":"noteOn",t.noteNumber=c,t.velocity=l,0===l&&(t.byte9=!0),t;case 10:return t.type="noteAftertouch",t.noteNumber=c,t.amount=n.readUInt8(),t;case 11:return t.type="controller",t.controllerType=c,t.value=n.readUInt8(),t;case 12:return t.type="programChange",t.programNumber=c,t;case 13:return t.type="channelAftertouch",t.amount=c,t;case 14:return t.type="pitchBend",t.value=c+(n.readUInt8()<<7)-8192,t;default:throw"Unrecognised MIDI event type: "+u}}}}function i(t){this.buffer=t,this.bufferLen=this.buffer.length,this.pos=0}i.prototype.eof=function(){return this.pos>=this.bufferLen},i.prototype.readUInt8=function(){var t=this.buffer[this.pos];return this.pos+=1,t},i.prototype.readInt8=function(){var t=this.readUInt8();return 128&t?t-256:t},i.prototype.readUInt16=function(){var t=this.readUInt8(),e=this.readUInt8();return(t<<8)+e},i.prototype.readInt16=function(){var t=this.readUInt16();return 32768&t?t-65536:t},i.prototype.readUInt24=function(){var t=this.readUInt8(),e=this.readUInt8(),n=this.readUInt8();return(t<<16)+(e<<8)+n},i.prototype.readInt24=function(){var t=this.readUInt24();return 8388608&t?t-16777216:t},i.prototype.readUInt32=function(){var t=this.readUInt8(),e=this.readUInt8(),n=this.readUInt8(),o=this.readUInt8();return(t<<24)+(e<<16)+(n<<8)+o},i.prototype.readBytes=function(t){var e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e},i.prototype.readString=function(t){var e=this.readBytes(t);return String.fromCharCode.apply(null,e)},i.prototype.readVarInt=function(){var t=0;while(!this.eof()){var e=this.readUInt8();if(!(128&e))return t+e;t+=127&e,t<<=7}return t},i.prototype.readChunk=function(){var t=this.readString(4),e=this.readUInt32(),n=this.readBytes(e);return{id:t,length:e,data:n}},t.exports=n},"624e":function(t,e,n){"use strict";var o=Array.prototype,r=o.reverse;function i(t){return null==t?t:r.call(t)}e["a"]=i},6613:function(t,e,n){n("fb6a"),n("d3b7"),n("b0c0"),n("a630"),n("3ca3");var o=n("5a43");function r(t,e){if(t){if("string"===typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}t.exports=r,t.exports["default"]=t.exports,t.exports.__esModule=!0},"665f":function(t,e,n){"use strict";n("8cb2")},7352:function(t,e,n){},7430:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("27d3"),r=new WeakMap;e.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var i=function(){function t(t){var n=this;this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",r.set(this,480),t&&(r.set(this,t.header.ticksPerBeat),t.tracks.forEach((function(t){return t.forEach((function(t){t.meta&&("timeSignature"===t.type?n.timeSignatures.push({ticks:t.absoluteTime,timeSignature:[t.numerator,t.denominator]}):"setTempo"===t.type?n.tempos.push({bpm:6e7/t.microsecondsPerBeat,ticks:t.absoluteTime}):"keySignature"===t.type&&n.keySignatures.push({key:e.keySignatureKeys[t.key+7],scale:0===t.scale?"major":"minor",ticks:t.absoluteTime}))}))})),t.tracks[0].forEach((function(t){t.meta&&("trackName"===t.type?n.name=t.text:"text"!==t.type&&"cuePoint"!==t.type&&"marker"!==t.type&&"lyrics"!==t.type||n.meta.push({text:t.text,ticks:t.absoluteTime,type:t.type}))})),this.update())}return t.prototype.update=function(){var t=this,e=0,n=0;this.tempos.sort((function(t,e){return t.ticks-e.ticks})),this.tempos.forEach((function(o,r){var i=r>0?t.tempos[r-1].bpm:t.tempos[0].bpm,s=o.ticks/t.ppq-n,a=60/i*s;o.time=a+e,e=o.time,n+=s})),this.timeSignatures.sort((function(t,e){return t.ticks-e.ticks})),this.timeSignatures.forEach((function(e,n){var o=n>0?t.timeSignatures[n-1]:t.timeSignatures[0],r=(e.ticks-o.ticks)/t.ppq,i=r/o.timeSignature[0]/(o.timeSignature[1]/4);o.measures=o.measures||0,e.measures=i+o.measures}))},t.prototype.ticksToSeconds=function(t){var e=o.search(this.tempos,t);if(-1!==e){var n=this.tempos[e],r=n.time,i=(t-n.ticks)/this.ppq;return r+60/n.bpm*i}var s=t/this.ppq;return.5*s},t.prototype.ticksToMeasures=function(t){var e=o.search(this.timeSignatures,t);if(-1!==e){var n=this.timeSignatures[e],r=(t-n.ticks)/this.ppq;return n.measures+r/(n.timeSignature[0]/n.timeSignature[1])/4}return t/this.ppq/4},Object.defineProperty(t.prototype,"ppq",{get:function(){return r.get(this)},enumerable:!0,configurable:!0}),t.prototype.secondsToTicks=function(t){var e=o.search(this.tempos,t,"time");if(-1!==e){var n=this.tempos[e],r=n.time,i=t-r,s=i/(60/n.bpm);return Math.round(n.ticks+s*this.ppq)}var a=t/.5;return Math.round(a*this.ppq)},t.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map((function(t){return{bpm:t.bpm,ticks:t.ticks}})),timeSignatures:this.timeSignatures}},t.prototype.fromJSON=function(t){this.name=t.name,this.tempos=t.tempos.map((function(t){return Object.assign({},t)})),this.timeSignatures=t.timeSignatures.map((function(t){return Object.assign({},t)})),this.keySignatures=t.keySignatures.map((function(t){return Object.assign({},t)})),this.meta=t.meta.map((function(t){return Object.assign({},t)})),r.set(this,t.ppq),this.update()},t.prototype.setTempo=function(t){this.tempos=[{bpm:t,ticks:0}],this.update()},t}();e.Header=i},"788a":function(t,e,n){},"8cb2":function(t,e,n){},"970b":function(t,e){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t.exports=n,t.exports["default"]=t.exports,t.exports.__esModule=!0},"9b42":function(t,e,n){function o(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(o=n.next()).done);s=!0)if(i.push(o.value),e&&i.length===e)break}catch(c){a=!0,r=c}finally{try{s||null==n["return"]||n["return"]()}finally{if(a)throw r}}return i}}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),t.exports=o,t.exports["default"]=t.exports,t.exports.__esModule=!0},"9d88":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-input",{ref:"copytext",staticClass:"copytext-input",attrs:{value:t.text,size:t.size},on:{focus:function(e){return t.$refs.copytext.select()}}},[n("el-button",{attrs:{slot:"append"},on:{click:t.doCopy},slot:"append"},[n("WfIcon",{attrs:{type:"copy"}}),t._v(t._s(t.$t("app.copy"))+" ")],1)],1)},r=[],i=n("d4ec"),s=n("bee2"),a=n("262e"),c=n("2caf"),u=n("53ca"),l=(n("e439"),n("60a3")),h=n("596b"),p=n.n(h),f=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"===typeof Reflect?"undefined":Object(u["a"])(Reflect))&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},d=function(t){Object(a["a"])(n,t);var e=Object(c["a"])(n);function n(){return Object(i["a"])(this,n),e.apply(this,arguments)}return Object(s["a"])(n,[{key:"doCopy",value:function(){p()(this.text),this.$refs.copytext.select(),this.$message({showClose:!0,message:this.message||this.$t("app.copySuccess"),type:"success"})}}]),n}(l["e"]);f([Object(l["d"])()],d.prototype,"text",void 0),f([Object(l["d"])()],d.prototype,"size",void 0),f([Object(l["d"])()],d.prototype,"message",void 0),d=f([l["a"]],d);var y=d,m=y,v=(n("aab2"),n("2877")),_=Object(v["a"])(m,o,r,!1,null,null,null);e["a"]=_.exports},a55a:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("df14");function r(){return new Proxy({},{get:function(t,e){return t[e]?t[e]:o.controlChangeIds.hasOwnProperty(e)?t[o.controlChangeIds[e]]:void 0},set:function(t,e,n){return o.controlChangeIds.hasOwnProperty(e)?t[o.controlChangeIds[e]]=n:t[e]=n,!0}})}e.createControlChanges=r},aab2:function(t,e,n){"use strict";n("48bc")},b79c:function(t,e,n){"use strict";n("7352")},bd40:function(t,e,n){"use strict";function o(t){var e=Math.floor(t/12)-1;return r(t)+e.toString()}function r(t){var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],n=t%12;return e[n]}function i(t){var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return e.indexOf(t)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){var t=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,e={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(n){var o=t.exec(n),r=o[1],i=o[2],s=e[r.toLowerCase()];return s+12*(parseInt(i,10)+1)}}(),a=new WeakMap,c=function(){function t(t,e,n){a.set(this,n),this.midi=t.midi,this.velocity=t.velocity,this.noteOffVelocity=e.velocity,this.ticks=t.ticks,this.durationTicks=e.ticks-t.ticks}return Object.defineProperty(t.prototype,"name",{get:function(){return o(this.midi)},set:function(t){this.midi=s(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(t){var e=t-this.octave;this.midi+=12*e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return r(this.midi)},set:function(t){this.midi=12*(this.octave+1)+i(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var t=a.get(this);return t.ticksToSeconds(this.ticks+this.durationTicks)-t.ticksToSeconds(this.ticks)},set:function(t){var e=a.get(this),n=e.secondsToTicks(this.time+t);this.durationTicks=n-this.ticks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){var t=a.get(this);return t.ticksToSeconds(this.ticks)},set:function(t){var e=a.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bars",{get:function(){var t=a.get(this);return t.ticksToMeasures(this.ticks)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},t}();e.Note=c},c135:function(t,e){function n(t){if(Array.isArray(t))return t}t.exports=n,t.exports["default"]=t.exports,t.exports.__esModule=!0},c240:function(t,e){function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}t.exports=n,t.exports["default"]=t.exports,t.exports.__esModule=!0},d6b5:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("4e51"),r=new WeakMap,i=function(){function t(t,e){if(this.number=0,r.set(this,e),this.number=0,t){var n=t.find((function(t){return"programChange"===t.type}));n&&(this.number=n.programNumber)}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.percussion?o.DrumKitByPatchID[this.number]:o.instrumentByPatchID[this.number]},set:function(t){var e=o.instrumentByPatchID.indexOf(t);-1!==e&&(this.number=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return this.percussion?"drums":o.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"percussion",{get:function(){var t=r.get(this);return 9===t.channel},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{family:this.family,name:this.name,number:this.number}},t.prototype.fromJSON=function(t){this.number=t.number},t}();e.Instrument=i},df14:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},e.controlChangeIds=Object.keys(e.controlChangeNames).reduce((function(t,n){return t[e.controlChangeNames[n]]=n,t}),{});var o=new WeakMap,r=new WeakMap,i=function(){function t(t,e){o.set(this,e),r.set(this,t.controllerType),this.ticks=t.absoluteTime,this.value=t.value}return Object.defineProperty(t.prototype,"number",{get:function(){return r.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return e.controlChangeNames[this.number]?e.controlChangeNames[this.number]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){var t=o.get(this);return t.ticksToSeconds(this.ticks)},set:function(t){var e=o.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},t}();e.ControlChange=i},e26e:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("27d3"),r=n("df14"),i=n("a55a"),s=n("072e"),a=n("d6b5"),c=n("bd40"),u=new WeakMap,l=function(){function t(t,e){var n=this;if(this.name="",this.notes=[],this.controlChanges=i.createControlChanges(),this.pitchBends=[],u.set(this,e),t){var o=t.find((function(t){return"trackName"===t.type}));this.name=o?o.text:""}if(this.instrument=new a.Instrument(t,this),this.channel=0,t){var r=t.filter((function(t){return"noteOn"===t.type})),s=t.filter((function(t){return"noteOff"===t.type})),c=function(){var t=r.shift();l.channel=t.channel;var e=s.findIndex((function(e){return e.noteNumber===t.noteNumber&&e.absoluteTime>=t.absoluteTime}));if(-1!==e){var n=s.splice(e,1)[0];l.addNote({durationTicks:n.absoluteTime-t.absoluteTime,midi:t.noteNumber,noteOffVelocity:n.velocity/127,ticks:t.absoluteTime,velocity:t.velocity/127})}},l=this;while(r.length)c();var h=t.filter((function(t){return"controller"===t.type}));h.forEach((function(t){n.addCC({number:t.controllerType,ticks:t.absoluteTime,value:t.value/127})}));var p=t.filter((function(t){return"pitchBend"===t.type}));p.forEach((function(t){n.addPitchBend({ticks:t.absoluteTime,value:t.value/Math.pow(2,13)})}));var f=t.find((function(t){return"endOfTrack"===t.type}));this.endOfTrackTicks=void 0!==f?f.absoluteTime:void 0}}return t.prototype.addNote=function(t){var e=u.get(this),n=new c.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},e);return Object.assign(n,t),o.insert(this.notes,n,"ticks"),this},t.prototype.addCC=function(t){var e=u.get(this),n=new r.ControlChange({controllerType:t.number},e);return delete t.number,Object.assign(n,t),Array.isArray(this.controlChanges[n.number])||(this.controlChanges[n.number]=[]),o.insert(this.controlChanges[n.number],n,"ticks"),this},t.prototype.addPitchBend=function(t){var e=u.get(this),n=new s.PitchBend({},e);return Object.assign(n,t),o.insert(this.pitchBends,n,"ticks"),this},Object.defineProperty(t.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var t=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,e=0;e<this.notes.length-1;e++){var n=this.notes[e].time+this.notes[e].duration;t<n&&(t=n)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var t=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,e=0;e<this.notes.length-1;e++){var n=this.notes[e].ticks+this.notes[e].durationTicks;t<n&&(t=n)}return t},enumerable:!0,configurable:!0}),t.prototype.fromJSON=function(t){var e=this;for(var n in this.name=t.name,this.channel=t.channel,this.instrument=new a.Instrument(void 0,this),this.instrument.fromJSON(t.instrument),void 0!==t.endOfTrackTicks&&(this.endOfTrackTicks=t.endOfTrackTicks),t.controlChanges)t.controlChanges[n]&&t.controlChanges[n].forEach((function(t){e.addCC({number:t.number,ticks:t.ticks,value:t.value})}));t.notes.forEach((function(t){e.addNote({durationTicks:t.durationTicks,midi:t.midi,ticks:t.ticks,velocity:t.velocity})}))},t.prototype.toJSON=function(){for(var t={},e=0;e<127;e++)this.controlChanges.hasOwnProperty(e)&&(t[e]=this.controlChanges[e].map((function(t){return t.toJSON()})));var n={channel:this.channel,controlChanges:t,pitchBends:this.pitchBends.map((function(t){return t.toJSON()})),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map((function(t){return t.toJSON()}))};return void 0!==this.endOfTrackTicks&&(n.endOfTrackTicks=this.endOfTrackTicks),n},t}();e.Track=l},ef75:function(t,e,n){"use strict";var o=this&&this.__awaiter||function(t,e,n,o){function r(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,i){function s(t){try{c(o.next(t))}catch(e){i(e)}}function a(t){try{c(o["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):r(t.value).then(s,a)}c((o=o.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,o&&(r=2&i[0]?o["return"]:i[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var i=n("02d5"),s=n("3ee2"),a=n("7430"),c=n("e26e"),u=function(){function t(t){var e=this,n=null;t&&(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),n=i.parseMidi(t),n.tracks.forEach((function(t){var e=0;t.forEach((function(t){e+=t.deltaTime,t.absoluteTime=e}))})),n.tracks=p(n.tracks)),this.header=new a.Header(n),this.tracks=[],t&&(this.tracks=n.tracks.map((function(t){return new c.Track(t,e.header)})),1===n.header.format&&0===this.tracks[0].duration&&this.tracks.shift())}return t.fromUrl=function(e){return o(this,void 0,void 0,(function(){var n,o;return r(this,(function(r){switch(r.label){case 0:return[4,fetch(e)];case 1:return n=r.sent(),n.ok?[4,n.arrayBuffer()]:[3,3];case 2:return o=r.sent(),[2,new t(o)];case 3:throw new Error("could not load "+e)}}))}))},Object.defineProperty(t.prototype,"name",{get:function(){return this.header.name},set:function(t){this.header.name=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var t=this.tracks.map((function(t){return t.duration}));return Math.max.apply(Math,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationTicks",{get:function(){var t=this.tracks.map((function(t){return t.durationTicks}));return Math.max.apply(Math,t)},enumerable:!0,configurable:!0}),t.prototype.addTrack=function(){var t=new c.Track(void 0,this.header);return this.tracks.push(t),t},t.prototype.toArray=function(){return s.encode(this)},t.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map((function(t){return t.toJSON()}))}},t.prototype.fromJSON=function(t){var e=this;this.header=new a.Header,this.header.fromJSON(t.header),this.tracks=t.tracks.map((function(t){var n=new c.Track(void 0,e.header);return n.fromJSON(t),n}))},t.prototype.clone=function(){var e=new t;return e.fromJSON(this.toJSON()),e},t}();e.Midi=u;var l=n("e26e");e.Track=l.Track;var h=n("7430");function p(t){for(var e=[],n=0;n<t.length;n++)for(var o=e.length,r=new Map,i=Array(16).fill(0),s=0,a=t[n];s<a.length;s++){var c=a[s],u=o,l=c.channel;if(void 0!==l){"programChange"===c.type&&(i[l]=c.programNumber);var h=i[l],p=h+" "+l;r.has(p)?u=r.get(p):(u=o+r.size,r.set(p,u))}e[u]||e.push([]),e[u].push(c)}return e}e.Header=h.Header}}]);